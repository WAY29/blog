# 分组密码体制

## DES
### 加密
![](https://gitee.com/guuest/images/raw/master/img/20210617130248.png)
1. 初始置换
给定明文，通过一个固定的初始置换IP来重排输入明文块P中的比特，得到比特串P0=IP(P)=L0R0，这里L0和R0分别是P0的前32比特和后32比特
2. 轮结构变换
![](https://gitee.com/guuest/images/raw/master/img/20210617130336.png)
F函数流程
   - E盒扩展
![](https://gitee.com/guuest/images/raw/master/img/20210617130933.png)
   - 与轮密钥异或
E盒扩展后的48bit与轮密钥48bit进行异或运算
   - S盒代替压缩
将得到的48bit进行分组，每组6个bit，第一个bit和最后一个bit组成的十进制为行号，第2~5个bit组成的十进制为列号，从对应的S盒中拿到对应的数
![](https://gitee.com/guuest/images/raw/master/img/20210617131216.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617131244.png)
   - P盒置换运算
![](https://gitee.com/guuest/images/raw/master/img/20210617131434.png)
3. 密钥编排算法
![](https://gitee.com/guuest/images/raw/master/img/20210617131725.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617131812.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617132044.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617132108.png)

4.  逆初始置换
![](https://gitee.com/guuest/images/raw/master/img/20210617130727.png)

### 解密
![](https://gitee.com/guuest/images/raw/master/img/20210617132145.png)

### 2DES
![](https://gitee.com/guuest/images/raw/master/img/20210617132338.png)

## AES
AES有三个版本：AES-128、AES-192、AES-256，相应的迭代轮数为10轮、12轮、14轮。
AES算法的分组长度固定为128 bits，因此AES明文列数等于固定值Nb=4
AES算法的密钥长度的列数为128bits、192bits、256bits三种不同长度，因此不同密钥长度Nk可以取值分别为4、6、8
![](https://gitee.com/guuest/images/raw/master/img/20210617160331.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617160424.png)
1. 字节代替
![](https://gitee.com/guuest/images/raw/master/img/20210617160556.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617160710.png)

2. 行移位
![](https://gitee.com/guuest/images/raw/master/img/20210617160807.png)
3. 列混合
![](https://gitee.com/guuest/images/raw/master/img/20210617160900.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617162053.png)

4. 轮密钥加
![](https://gitee.com/guuest/images/raw/master/img/20210617160651.png)
5. 密钥扩展
![](https://gitee.com/guuest/images/raw/master/img/20210617162712.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617163950.png)
## 分组密码的运行模式
### ECB 电子码本
![](https://gitee.com/guuest/images/raw/master/img/20210617164451.png)

### CBC 密码分组链接
![](https://gitee.com/guuest/images/raw/master/img/20210617164856.png)
#### 错误传播
明文有一组有错，解密时只影响一组结果
传送过程中某组密文出错，则该组恢复的明文和下一组恢复数据出错，其他不影响
传送过程中比特缺失，则影响整个解密
### CTR 计数器模式
![](https://gitee.com/guuest/images/raw/master/img/20210617170821.png)

### OFB 输出反馈
![](https://gitee.com/guuest/images/raw/master/img/20210617170547.png)

### CFB 密码反馈
![](https://gitee.com/guuest/images/raw/master/img/20210617165849.png)
#### 错误传播
明文有一组有错，解密时只影响一组结果
密文里的一位作物会引起明文的一个单独错误，错误影响直到该错误从移位寄存器中被移出
