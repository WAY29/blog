# Hash函数
## 概述
HASH函数又称为哈希函数、Hash函数、杂凑函数和散列函数，在现代密码学中扮演着重要角色。
Hash函数是一公开函数，通常记为H或h，本章节中使用H表示Hash函数。Hash函数可以将任意长的消息m映射为较短的、固定长度的一个值，记为𝐻(𝑚)，经常称函数值𝑯(𝒎)为散列值、哈希值、杂凑值、杂凑码或消息摘要、数字指纹，本章节中，函数值𝐻(𝑚)的值称为哈希值。
从密码算法角度看，Hash函数也可以看作是一种单向密码体制，即它从一个明文到密文是不可逆映射，只有加密过程，不能解密。
哈希值是消息中所有比特的函数，因此提供了一种错误检测能力，即改变消息中任何一个比特或几个比特都会使哈希值发生改变。在密码学和数据安全技术中，Hash函数是实现有效、安全可靠数字签名和认证的重要工具，是安全认证协议中的重要模块。
## 哈希函数要求
对于H有下面六个要求：
1. 能够接受任意长度的消息作为输入；
2. 能够生成较短的固定长度的输出；
3. 对任何消息输入都能够容易和快速地计算出哈希值；
4. 应该具有单向性，也就是说，给定𝐻(𝑚)，恢复消息m在计算上是不可行的；
5. 应该能够抵抗弱碰撞，即给定消息m和𝐻(𝑚)，找到另外一个消息𝑚≠𝑚^′，使𝐻(𝑚)=𝐻(𝑚^′)是不可能；
6. 应该能够抵抗强冲突，即可以两个有意义的消息m和𝑚^′，使得𝐻(𝑚)=𝐻(𝑚^′)几乎是不可能的。

## 哈希函数特性
单向性（抗原像）：对干任意给定的消息，计算其哈希值容易. 但是，对于给定的哈希值h，要找到M使得H(M)＝h在计算上是不可行的.
 弱抗碰撞（抗二次原像）：对于给定的消息M1，要发现另一个消息M2，满足H( M1 )＝H(M2)在计算上是不可行的.
强抗碰撞：找任意一对不同的消息M1，M2 ，使H(M1)＝H(M2 )在计算上是不可行的.
随机性

## SHA系列
SHA-1，SHA-256，SHA-384，SHA-512
SHA-1，SHA-256的分组大小是512
SHA-384，SHA-512的分组大小是1024
SHA-1输出的摘要是160bit
SHA-256输出的摘要是256 bit
SHA-384输出的摘要是384 bit
SHA-512输出的摘要是512 bit

### SHA-1
NIST在1993年发布了一个哈希算法称为安全HASH算法，1995年修改，修改后的版本是SHA-1，这个版本是当前使用最广泛的哈希算法。
SHA-1接受输入消息的最大长度为264-1 bits，生成160 bits的消息摘要。
SHA-1算法操作首先对输入消息划分为512-bit块，若最后一个数据块不满足长度要求，按照一定规则进行填充为512-bit块。
然后每个512-bit块重复使用分块处理函数，最终输出160 bits哈希值。
![](https://gitee.com/guuest/images/raw/master/img/20210617201045.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617201608.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617201946.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617202139.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617202249.png)

## 消息认证码
![](https://gitee.com/guuest/images/raw/master/img/20210617202441.png)
![](https://gitee.com/guuest/images/raw/master/img/20210617202636.png)
### 基于分组密码的MAC
![](https://gitee.com/guuest/images/raw/master/img/20210617202756.png)
### 基于Hash的MAC
![](https://gitee.com/guuest/images/raw/master/img/20210617202944.png)
### MAC的特点
- 接收方可以相信消息未被修改
- 接收方可以相信消息来自真正的发送方
- 如果消息中含有序列号，那么接收方可以相信消息顺序是正确的
- MAC函数与加密的区别之一是，MAC算法不要求可逆性
- MAC不能提供数字签名

